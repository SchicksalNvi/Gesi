var fn=Object.defineProperty;var hn=(t,s,n)=>s in t?fn(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var _t=(t,s,n)=>hn(t,typeof s!="symbol"?s+"":s,n);import{i as lt,o as pn,s as mn,j as e,L as It,M as gn,R as xn,a as yn,S as O,B as vs,b as rt,D as jn,A as Ss,c as be,d as wn,e as ot,f as bn,g as Nt,h as ze,k as vn,C as U,F as T,I as M,l as ke,m as k,n as E,p as De,q as te,r as le,t as re,u as xe,v as ue,T as z,w as ne,x as Sn,y as Re,z as H,E as ge,G as _s,H as ct,J as Kt,K as Ee,N as zt,O as K,P as de,Q as Ne,U as Ae,V as _n,W as Ut,X as Cn,Y as Cs,Z as dt,_ as Y,$ as kn,a0 as ks,a1 as Ie,a2 as Jt,a3 as Ue,a4 as Es,a5 as at,a6 as Rs,a7 as me,a8 as Be,a9 as En,aa as Ye,ab as Rn,ac as As,ad as Ps,ae as Yt,af as An,ag as Gt,ah as Ge,ai as Pn,aj as In}from"./antd-vendor-D4gWe2tP.js";import{c as Tn,g as Is,r as x,R as Dt,u as fe,f as $n,O as Ln,h as Ts,i as On,j as J,N as et,B as Fn}from"./react-vendor-CGZ-ZtCm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var Tt={},Xt=Tn;Tt.createRoot=Xt.createRoot,Tt.hydrateRoot=Xt.hydrateRoot;var ut={},ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.default=void 0;var Nn={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};ft.default=Nn;var ht={},Me={},pt={},mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.commonLocale=void 0;mt.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var zn=lt.default;Object.defineProperty(pt,"__esModule",{value:!0});pt.default=void 0;var Zt=zn(pn),Un=mt,Dn=(0,Zt.default)((0,Zt.default)({},Un.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",week:"周",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});pt.default=Dn;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.default=void 0;const Bn={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};Ve.default=Bn;var $s=lt.default;Object.defineProperty(Me,"__esModule",{value:!0});Me.default=void 0;var Mn=$s(pt),Vn=$s(Ve);const Ls={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},Mn.default),timePickerLocale:Object.assign({},Vn.default)};Ls.lang.ok="确定";Me.default=Ls;var qn=lt.default;Object.defineProperty(ht,"__esModule",{value:!0});ht.default=void 0;var Hn=qn(Me);ht.default=Hn.default;var gt=lt.default;Object.defineProperty(ut,"__esModule",{value:!0});ut.default=void 0;var Wn=gt(ft),Kn=gt(ht),Jn=gt(Me),Yn=gt(Ve);const Z="${label}不是一个有效的${type}",Gn={locale:"zh-cn",Pagination:Wn.default,DatePicker:Jn.default,TimePicker:Yn.default,Calendar:Kn.default,global:{placeholder:"请选择",close:"关闭"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckAll:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:Z,method:Z,array:Z,object:Z,number:Z,date:Z,boolean:Z,integer:Z,float:Z,regexp:Z,email:Z,url:Z,hex:Z},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};ut.default=Gn;var Xn=ut;const Zn=Is(Xn),Qn={},Qt=t=>{let s;const n=new Set,r=(u,y)=>{const _=typeof u=="function"?u(s):u;if(!Object.is(_,s)){const b=s;s=y??(typeof _!="object"||_===null)?_:Object.assign({},s,_),n.forEach(l=>l(s,b))}},o=()=>s,d={setState:r,getState:o,getInitialState:()=>f,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Qn?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=s=t(r,o,d);return d},er=t=>t?Qt(t):Qt;var Os={exports:{}},Fs={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xt=x,tr=mn;function sr(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var nr=typeof Object.is=="function"?Object.is:sr,rr=tr.useSyncExternalStore,or=xt.useRef,ar=xt.useEffect,ir=xt.useMemo,lr=xt.useDebugValue;Fs.useSyncExternalStoreWithSelector=function(t,s,n,r,o){var a=or(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=ir(function(){function d(b){if(!f){if(f=!0,u=b,b=r(b),o!==void 0&&i.hasValue){var l=i.value;if(o(l,b))return y=l}return y=b}if(l=y,nr(u,b))return l;var m=r(b);return o!==void 0&&o(l,m)?(u=b,l):(u=b,y=m)}var f=!1,u,y,_=n===void 0?null:n;return[function(){return d(s())},_===null?void 0:function(){return d(_())}]},[s,n,r,o]);var c=rr(t,a[0],a[1]);return ar(function(){i.hasValue=!0,i.value=c},[c]),lr(c),c};Os.exports=Fs;var cr=Os.exports;const dr=Is(cr),Ns={},{useDebugValue:ur}=Dt,{useSyncExternalStoreWithSelector:fr}=dr;let es=!1;const hr=t=>t;function pr(t,s=hr,n){(Ns?"production":void 0)!=="production"&&n&&!es&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),es=!0);const r=fr(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,n);return ur(r),r}const ts=t=>{(Ns?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?er(t):t,n=(r,o)=>pr(s,r,o);return Object.assign(n,s),n},mr=t=>t?ts(t):ts,ye=mr((t,s)=>({user:JSON.parse(localStorage.getItem("user")||"null"),token:localStorage.getItem("token"),isAuthenticated:!!(localStorage.getItem("token")&&localStorage.getItem("user")),setUser:n=>{n?localStorage.setItem("user",JSON.stringify(n)):localStorage.removeItem("user"),t({user:n,isAuthenticated:!!n&&!!s().token})},setToken:n=>{n?localStorage.setItem("token",n):localStorage.removeItem("token"),t({token:n,isAuthenticated:!!n&&!!s().user})},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userPreferences"),t({user:null,token:null,isAuthenticated:!1,userPreferences:null})},userPreferences:JSON.parse(localStorage.getItem("userPreferences")||"null"),setUserPreferences:n=>{n?localStorage.setItem("userPreferences",JSON.stringify(n)):localStorage.removeItem("userPreferences"),t({userPreferences:n})},nodes:[],selectedNode:null,setNodes:n=>t({nodes:n}),setSelectedNode:n=>t({selectedNode:n}),systemStats:null,setSystemStats:n=>t({systemStats:n}),sidebarCollapsed:!1,toggleSidebar:()=>t(n=>({sidebarCollapsed:!n.sidebarCollapsed}))}));function zs(t,s){return function(){return t.apply(s,arguments)}}const{toString:gr}=Object.prototype,{getPrototypeOf:Bt}=Object,{iterator:yt,toStringTag:Us}=Symbol,jt=(t=>s=>{const n=gr.call(s);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),oe=t=>(t=t.toLowerCase(),s=>jt(s)===t),wt=t=>s=>typeof s===t,{isArray:Te}=Array,Pe=wt("undefined");function qe(t){return t!==null&&!Pe(t)&&t.constructor!==null&&!Pe(t.constructor)&&G(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Ds=oe("ArrayBuffer");function xr(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&Ds(t.buffer),s}const yr=wt("string"),G=wt("function"),Bs=wt("number"),He=t=>t!==null&&typeof t=="object",jr=t=>t===!0||t===!1,tt=t=>{if(jt(t)!=="object")return!1;const s=Bt(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Us in t)&&!(yt in t)},wr=t=>{if(!He(t)||qe(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},br=oe("Date"),vr=oe("File"),Sr=oe("Blob"),_r=oe("FileList"),Cr=t=>He(t)&&G(t.pipe),kr=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||G(t.append)&&((s=jt(t))==="formdata"||s==="object"&&G(t.toString)&&t.toString()==="[object FormData]"))},Er=oe("URLSearchParams"),[Rr,Ar,Pr,Ir]=["ReadableStream","Request","Response","Headers"].map(oe),Tr=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function We(t,s,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,o;if(typeof t!="object"&&(t=[t]),Te(t))for(r=0,o=t.length;r<o;r++)s.call(null,t[r],r,t);else{if(qe(t))return;const a=n?Object.getOwnPropertyNames(t):Object.keys(t),i=a.length;let c;for(r=0;r<i;r++)c=a[r],s.call(null,t[c],c,t)}}function Ms(t,s){if(qe(t))return null;s=s.toLowerCase();const n=Object.keys(t);let r=n.length,o;for(;r-- >0;)if(o=n[r],s===o.toLowerCase())return o;return null}const je=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Vs=t=>!Pe(t)&&t!==je;function $t(){const{caseless:t,skipUndefined:s}=Vs(this)&&this||{},n={},r=(o,a)=>{const i=t&&Ms(n,a)||a;tt(n[i])&&tt(o)?n[i]=$t(n[i],o):tt(o)?n[i]=$t({},o):Te(o)?n[i]=o.slice():(!s||!Pe(o))&&(n[i]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&We(arguments[o],r);return n}const $r=(t,s,n,{allOwnKeys:r}={})=>(We(s,(o,a)=>{n&&G(o)?t[a]=zs(o,n):t[a]=o},{allOwnKeys:r}),t),Lr=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Or=(t,s,n,r)=>{t.prototype=Object.create(s.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),n&&Object.assign(t.prototype,n)},Fr=(t,s,n,r)=>{let o,a,i;const c={};if(s=s||{},t==null)return s;do{for(o=Object.getOwnPropertyNames(t),a=o.length;a-- >0;)i=o[a],(!r||r(i,t,s))&&!c[i]&&(s[i]=t[i],c[i]=!0);t=n!==!1&&Bt(t)}while(t&&(!n||n(t,s))&&t!==Object.prototype);return s},Nr=(t,s,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=s.length;const r=t.indexOf(s,n);return r!==-1&&r===n},zr=t=>{if(!t)return null;if(Te(t))return t;let s=t.length;if(!Bs(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=t[s];return n},Ur=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Bt(Uint8Array)),Dr=(t,s)=>{const r=(t&&t[yt]).call(t);let o;for(;(o=r.next())&&!o.done;){const a=o.value;s.call(t,a[0],a[1])}},Br=(t,s)=>{let n;const r=[];for(;(n=t.exec(s))!==null;)r.push(n);return r},Mr=oe("HTMLFormElement"),Vr=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),ss=(({hasOwnProperty:t})=>(s,n)=>t.call(s,n))(Object.prototype),qr=oe("RegExp"),qs=(t,s)=>{const n=Object.getOwnPropertyDescriptors(t),r={};We(n,(o,a)=>{let i;(i=s(o,a,t))!==!1&&(r[a]=i||o)}),Object.defineProperties(t,r)},Hr=t=>{qs(t,(s,n)=>{if(G(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(G(r)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Wr=(t,s)=>{const n={},r=o=>{o.forEach(a=>{n[a]=!0})};return Te(t)?r(t):r(String(t).split(s)),n},Kr=()=>{},Jr=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function Yr(t){return!!(t&&G(t.append)&&t[Us]==="FormData"&&t[yt])}const Gr=t=>{const s=new Array(10),n=(r,o)=>{if(He(r)){if(s.indexOf(r)>=0)return;if(qe(r))return r;if(!("toJSON"in r)){s[o]=r;const a=Te(r)?[]:{};return We(r,(i,c)=>{const d=n(i,o+1);!Pe(d)&&(a[c]=d)}),s[o]=void 0,a}}return r};return n(t,0)},Xr=oe("AsyncFunction"),Zr=t=>t&&(He(t)||G(t))&&G(t.then)&&G(t.catch),Hs=((t,s)=>t?setImmediate:s?((n,r)=>(je.addEventListener("message",({source:o,data:a})=>{o===je&&a===n&&r.length&&r.shift()()},!1),o=>{r.push(o),je.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",G(je.postMessage)),Qr=typeof queueMicrotask<"u"?queueMicrotask.bind(je):typeof process<"u"&&process.nextTick||Hs,eo=t=>t!=null&&G(t[yt]),g={isArray:Te,isArrayBuffer:Ds,isBuffer:qe,isFormData:kr,isArrayBufferView:xr,isString:yr,isNumber:Bs,isBoolean:jr,isObject:He,isPlainObject:tt,isEmptyObject:wr,isReadableStream:Rr,isRequest:Ar,isResponse:Pr,isHeaders:Ir,isUndefined:Pe,isDate:br,isFile:vr,isBlob:Sr,isRegExp:qr,isFunction:G,isStream:Cr,isURLSearchParams:Er,isTypedArray:Ur,isFileList:_r,forEach:We,merge:$t,extend:$r,trim:Tr,stripBOM:Lr,inherits:Or,toFlatObject:Fr,kindOf:jt,kindOfTest:oe,endsWith:Nr,toArray:zr,forEachEntry:Dr,matchAll:Br,isHTMLForm:Mr,hasOwnProperty:ss,hasOwnProp:ss,reduceDescriptors:qs,freezeMethods:Hr,toObjectSet:Wr,toCamelCase:Vr,noop:Kr,toFiniteNumber:Jr,findKey:Ms,global:je,isContextDefined:Vs,isSpecCompliantForm:Yr,toJSONObject:Gr,isAsyncFn:Xr,isThenable:Zr,setImmediate:Hs,asap:Qr,isIterable:eo};function $(t,s,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}g.inherits($,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g.toJSONObject(this.config),code:this.code,status:this.status}}});const Ws=$.prototype,Ks={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ks[t]={value:t}});Object.defineProperties($,Ks);Object.defineProperty(Ws,"isAxiosError",{value:!0});$.from=(t,s,n,r,o,a)=>{const i=Object.create(Ws);g.toFlatObject(t,i,function(u){return u!==Error.prototype},f=>f!=="isAxiosError");const c=t&&t.message?t.message:"Error",d=s==null&&t?t.code:s;return $.call(i,c,d,n,r,o),t&&i.cause==null&&Object.defineProperty(i,"cause",{value:t,configurable:!0}),i.name=t&&t.name||"Error",a&&Object.assign(i,a),i};const to=null;function Lt(t){return g.isPlainObject(t)||g.isArray(t)}function Js(t){return g.endsWith(t,"[]")?t.slice(0,-2):t}function ns(t,s,n){return t?t.concat(s).map(function(o,a){return o=Js(o),!n&&a?"["+o+"]":o}).join(n?".":""):s}function so(t){return g.isArray(t)&&!t.some(Lt)}const no=g.toFlatObject(g,{},null,function(s){return/^is[A-Z]/.test(s)});function bt(t,s,n){if(!g.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,n=g.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,p){return!g.isUndefined(p[m])});const r=n.metaTokens,o=n.visitor||u,a=n.dots,i=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&g.isSpecCompliantForm(s);if(!g.isFunction(o))throw new TypeError("visitor must be a function");function f(l){if(l===null)return"";if(g.isDate(l))return l.toISOString();if(g.isBoolean(l))return l.toString();if(!d&&g.isBlob(l))throw new $("Blob is not supported. Use a Buffer instead.");return g.isArrayBuffer(l)||g.isTypedArray(l)?d&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function u(l,m,p){let h=l;if(l&&!p&&typeof l=="object"){if(g.endsWith(m,"{}"))m=r?m:m.slice(0,-2),l=JSON.stringify(l);else if(g.isArray(l)&&so(l)||(g.isFileList(l)||g.endsWith(m,"[]"))&&(h=g.toArray(l)))return m=Js(m),h.forEach(function(S,P){!(g.isUndefined(S)||S===null)&&s.append(i===!0?ns([m],P,a):i===null?m:m+"[]",f(S))}),!1}return Lt(l)?!0:(s.append(ns(p,m,a),f(l)),!1)}const y=[],_=Object.assign(no,{defaultVisitor:u,convertValue:f,isVisitable:Lt});function b(l,m){if(!g.isUndefined(l)){if(y.indexOf(l)!==-1)throw Error("Circular reference detected in "+m.join("."));y.push(l),g.forEach(l,function(h,v){(!(g.isUndefined(h)||h===null)&&o.call(s,h,g.isString(v)?v.trim():v,m,_))===!0&&b(h,m?m.concat(v):[v])}),y.pop()}}if(!g.isObject(t))throw new TypeError("data must be an object");return b(t),s}function rs(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return s[r]})}function Mt(t,s){this._pairs=[],t&&bt(t,this,s)}const Ys=Mt.prototype;Ys.append=function(s,n){this._pairs.push([s,n])};Ys.toString=function(s){const n=s?function(r){return s.call(this,r,rs)}:rs;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function ro(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Gs(t,s,n){if(!s)return t;const r=n&&n.encode||ro;g.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(s,n):a=g.isURLSearchParams(s)?s.toString():new Mt(s,n).toString(r),a){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class os{constructor(){this.handlers=[]}use(s,n,r){return this.handlers.push({fulfilled:s,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){g.forEach(this.handlers,function(r){r!==null&&s(r)})}}const Xs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},oo=typeof URLSearchParams<"u"?URLSearchParams:Mt,ao=typeof FormData<"u"?FormData:null,io=typeof Blob<"u"?Blob:null,lo={isBrowser:!0,classes:{URLSearchParams:oo,FormData:ao,Blob:io},protocols:["http","https","file","blob","url","data"]},Vt=typeof window<"u"&&typeof document<"u",Ot=typeof navigator=="object"&&navigator||void 0,co=Vt&&(!Ot||["ReactNative","NativeScript","NS"].indexOf(Ot.product)<0),uo=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fo=Vt&&window.location.href||"http://localhost",ho=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vt,hasStandardBrowserEnv:co,hasStandardBrowserWebWorkerEnv:uo,navigator:Ot,origin:fo},Symbol.toStringTag,{value:"Module"})),W={...ho,...lo};function po(t,s){return bt(t,new W.classes.URLSearchParams,{visitor:function(n,r,o,a){return W.isNode&&g.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...s})}function mo(t){return g.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function go(t){const s={},n=Object.keys(t);let r;const o=n.length;let a;for(r=0;r<o;r++)a=n[r],s[a]=t[a];return s}function Zs(t){function s(n,r,o,a){let i=n[a++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),d=a>=n.length;return i=!i&&g.isArray(o)?o.length:i,d?(g.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r,!c):((!o[i]||!g.isObject(o[i]))&&(o[i]=[]),s(n,r,o[i],a)&&g.isArray(o[i])&&(o[i]=go(o[i])),!c)}if(g.isFormData(t)&&g.isFunction(t.entries)){const n={};return g.forEachEntry(t,(r,o)=>{s(mo(r),o,n,0)}),n}return null}function xo(t,s,n){if(g.isString(t))try{return(s||JSON.parse)(t),g.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Ke={transitional:Xs,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,a=g.isObject(s);if(a&&g.isHTMLForm(s)&&(s=new FormData(s)),g.isFormData(s))return o?JSON.stringify(Zs(s)):s;if(g.isArrayBuffer(s)||g.isBuffer(s)||g.isStream(s)||g.isFile(s)||g.isBlob(s)||g.isReadableStream(s))return s;if(g.isArrayBufferView(s))return s.buffer;if(g.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return po(s,this.formSerializer).toString();if((c=g.isFileList(s))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return bt(c?{"files[]":s}:s,d&&new d,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),xo(s)):s}],transformResponse:[function(s){const n=this.transitional||Ke.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(g.isResponse(s)||g.isReadableStream(s))return s;if(s&&g.isString(s)&&(r&&!this.responseType||o)){const i=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(s,this.parseReviver)}catch(c){if(i)throw c.name==="SyntaxError"?$.from(c,$.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:W.classes.FormData,Blob:W.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g.forEach(["delete","get","head","post","put","patch"],t=>{Ke.headers[t]={}});const yo=g.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jo=t=>{const s={};let n,r,o;return t&&t.split(`
`).forEach(function(i){o=i.indexOf(":"),n=i.substring(0,o).trim().toLowerCase(),r=i.substring(o+1).trim(),!(!n||s[n]&&yo[n])&&(n==="set-cookie"?s[n]?s[n].push(r):s[n]=[r]:s[n]=s[n]?s[n]+", "+r:r)}),s},as=Symbol("internals");function Le(t){return t&&String(t).trim().toLowerCase()}function st(t){return t===!1||t==null?t:g.isArray(t)?t.map(st):String(t)}function wo(t){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)s[r[1]]=r[2];return s}const bo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ct(t,s,n,r,o){if(g.isFunction(r))return r.call(this,s,n);if(o&&(s=n),!!g.isString(s)){if(g.isString(r))return s.indexOf(r)!==-1;if(g.isRegExp(r))return r.test(s)}}function vo(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,r)=>n.toUpperCase()+r)}function So(t,s){const n=g.toCamelCase(" "+s);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(o,a,i){return this[r].call(this,s,o,a,i)},configurable:!0})})}let X=class{constructor(s){s&&this.set(s)}set(s,n,r){const o=this;function a(c,d,f){const u=Le(d);if(!u)throw new Error("header name must be a non-empty string");const y=g.findKey(o,u);(!y||o[y]===void 0||f===!0||f===void 0&&o[y]!==!1)&&(o[y||d]=st(c))}const i=(c,d)=>g.forEach(c,(f,u)=>a(f,u,d));if(g.isPlainObject(s)||s instanceof this.constructor)i(s,n);else if(g.isString(s)&&(s=s.trim())&&!bo(s))i(jo(s),n);else if(g.isObject(s)&&g.isIterable(s)){let c={},d,f;for(const u of s){if(!g.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[f=u[0]]=(d=c[f])?g.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}i(c,n)}else s!=null&&a(n,s,r);return this}get(s,n){if(s=Le(s),s){const r=g.findKey(this,s);if(r){const o=this[r];if(!n)return o;if(n===!0)return wo(o);if(g.isFunction(n))return n.call(this,o,r);if(g.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Le(s),s){const r=g.findKey(this,s);return!!(r&&this[r]!==void 0&&(!n||Ct(this,this[r],r,n)))}return!1}delete(s,n){const r=this;let o=!1;function a(i){if(i=Le(i),i){const c=g.findKey(r,i);c&&(!n||Ct(r,r[c],c,n))&&(delete r[c],o=!0)}}return g.isArray(s)?s.forEach(a):a(s),o}clear(s){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const a=n[r];(!s||Ct(this,this[a],a,s,!0))&&(delete this[a],o=!0)}return o}normalize(s){const n=this,r={};return g.forEach(this,(o,a)=>{const i=g.findKey(r,a);if(i){n[i]=st(o),delete n[a];return}const c=s?vo(a):String(a).trim();c!==a&&delete n[a],n[c]=st(o),r[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return g.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=s&&g.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const r=new this(s);return n.forEach(o=>r.set(o)),r}static accessor(s){const r=(this[as]=this[as]={accessors:{}}).accessors,o=this.prototype;function a(i){const c=Le(i);r[c]||(So(o,i),r[c]=!0)}return g.isArray(s)?s.forEach(a):a(s),this}};X.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);g.reduceDescriptors(X.prototype,({value:t},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(r){this[n]=r}}});g.freezeMethods(X);function kt(t,s){const n=this||Ke,r=s||n,o=X.from(r.headers);let a=r.data;return g.forEach(t,function(c){a=c.call(n,a,o.normalize(),s?s.status:void 0)}),o.normalize(),a}function Qs(t){return!!(t&&t.__CANCEL__)}function $e(t,s,n){$.call(this,t??"canceled",$.ERR_CANCELED,s,n),this.name="CanceledError"}g.inherits($e,$,{__CANCEL__:!0});function en(t,s,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):s(new $("Request failed with status code "+n.status,[$.ERR_BAD_REQUEST,$.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function _o(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Co(t,s){t=t||10;const n=new Array(t),r=new Array(t);let o=0,a=0,i;return s=s!==void 0?s:1e3,function(d){const f=Date.now(),u=r[a];i||(i=f),n[o]=d,r[o]=f;let y=a,_=0;for(;y!==o;)_+=n[y++],y=y%t;if(o=(o+1)%t,o===a&&(a=(a+1)%t),f-i<s)return;const b=u&&f-u;return b?Math.round(_*1e3/b):void 0}}function ko(t,s){let n=0,r=1e3/s,o,a;const i=(f,u=Date.now())=>{n=u,o=null,a&&(clearTimeout(a),a=null),t(...f)};return[(...f)=>{const u=Date.now(),y=u-n;y>=r?i(f,u):(o=f,a||(a=setTimeout(()=>{a=null,i(o)},r-y)))},()=>o&&i(o)]}const it=(t,s,n=3)=>{let r=0;const o=Co(50,250);return ko(a=>{const i=a.loaded,c=a.lengthComputable?a.total:void 0,d=i-r,f=o(d),u=i<=c;r=i;const y={loaded:i,total:c,progress:c?i/c:void 0,bytes:d,rate:f||void 0,estimated:f&&c&&u?(c-i)/f:void 0,event:a,lengthComputable:c!=null,[s?"download":"upload"]:!0};t(y)},n)},is=(t,s)=>{const n=t!=null;return[r=>s[0]({lengthComputable:n,total:t,loaded:r}),s[1]]},ls=t=>(...s)=>g.asap(()=>t(...s)),Eo=W.hasStandardBrowserEnv?((t,s)=>n=>(n=new URL(n,W.origin),t.protocol===n.protocol&&t.host===n.host&&(s||t.port===n.port)))(new URL(W.origin),W.navigator&&/(msie|trident)/i.test(W.navigator.userAgent)):()=>!0,Ro=W.hasStandardBrowserEnv?{write(t,s,n,r,o,a,i){if(typeof document>"u")return;const c=[`${t}=${encodeURIComponent(s)}`];g.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),g.isString(r)&&c.push(`path=${r}`),g.isString(o)&&c.push(`domain=${o}`),a===!0&&c.push("secure"),g.isString(i)&&c.push(`SameSite=${i}`),document.cookie=c.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Ao(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Po(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function tn(t,s,n){let r=!Ao(s);return t&&(r||n==!1)?Po(t,s):s}const cs=t=>t instanceof X?{...t}:t;function ve(t,s){s=s||{};const n={};function r(f,u,y,_){return g.isPlainObject(f)&&g.isPlainObject(u)?g.merge.call({caseless:_},f,u):g.isPlainObject(u)?g.merge({},u):g.isArray(u)?u.slice():u}function o(f,u,y,_){if(g.isUndefined(u)){if(!g.isUndefined(f))return r(void 0,f,y,_)}else return r(f,u,y,_)}function a(f,u){if(!g.isUndefined(u))return r(void 0,u)}function i(f,u){if(g.isUndefined(u)){if(!g.isUndefined(f))return r(void 0,f)}else return r(void 0,u)}function c(f,u,y){if(y in s)return r(f,u);if(y in t)return r(void 0,f)}const d={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(f,u,y)=>o(cs(f),cs(u),y,!0)};return g.forEach(Object.keys({...t,...s}),function(u){const y=d[u]||o,_=y(t[u],s[u],u);g.isUndefined(_)&&y!==c||(n[u]=_)}),n}const sn=t=>{const s=ve({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:c}=s;if(s.headers=i=X.from(i),s.url=Gs(tn(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),g.isFormData(n)){if(W.hasStandardBrowserEnv||W.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(g.isFunction(n.getHeaders)){const d=n.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([u,y])=>{f.includes(u.toLowerCase())&&i.set(u,y)})}}if(W.hasStandardBrowserEnv&&(r&&g.isFunction(r)&&(r=r(s)),r||r!==!1&&Eo(s.url))){const d=o&&a&&Ro.read(a);d&&i.set(o,d)}return s},Io=typeof XMLHttpRequest<"u",To=Io&&function(t){return new Promise(function(n,r){const o=sn(t);let a=o.data;const i=X.from(o.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:f}=o,u,y,_,b,l;function m(){b&&b(),l&&l(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let p=new XMLHttpRequest;p.open(o.method.toUpperCase(),o.url,!0),p.timeout=o.timeout;function h(){if(!p)return;const S=X.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),R={data:!c||c==="text"||c==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:S,config:t,request:p};en(function(j){n(j),m()},function(j){r(j),m()},R),p=null}"onloadend"in p?p.onloadend=h:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(h)},p.onabort=function(){p&&(r(new $("Request aborted",$.ECONNABORTED,t,p)),p=null)},p.onerror=function(P){const R=P&&P.message?P.message:"Network Error",w=new $(R,$.ERR_NETWORK,t,p);w.event=P||null,r(w),p=null},p.ontimeout=function(){let P=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const R=o.transitional||Xs;o.timeoutErrorMessage&&(P=o.timeoutErrorMessage),r(new $(P,R.clarifyTimeoutError?$.ETIMEDOUT:$.ECONNABORTED,t,p)),p=null},a===void 0&&i.setContentType(null),"setRequestHeader"in p&&g.forEach(i.toJSON(),function(P,R){p.setRequestHeader(R,P)}),g.isUndefined(o.withCredentials)||(p.withCredentials=!!o.withCredentials),c&&c!=="json"&&(p.responseType=o.responseType),f&&([_,l]=it(f,!0),p.addEventListener("progress",_)),d&&p.upload&&([y,b]=it(d),p.upload.addEventListener("progress",y),p.upload.addEventListener("loadend",b)),(o.cancelToken||o.signal)&&(u=S=>{p&&(r(!S||S.type?new $e(null,t,p):S),p.abort(),p=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const v=_o(o.url);if(v&&W.protocols.indexOf(v)===-1){r(new $("Unsupported protocol "+v+":",$.ERR_BAD_REQUEST,t));return}p.send(a||null)})},$o=(t,s)=>{const{length:n}=t=t?t.filter(Boolean):[];if(s||n){let r=new AbortController,o;const a=function(f){if(!o){o=!0,c();const u=f instanceof Error?f:this.reason;r.abort(u instanceof $?u:new $e(u instanceof Error?u.message:u))}};let i=s&&setTimeout(()=>{i=null,a(new $(`timeout ${s} of ms exceeded`,$.ETIMEDOUT))},s);const c=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),t=null)};t.forEach(f=>f.addEventListener("abort",a));const{signal:d}=r;return d.unsubscribe=()=>g.asap(c),d}},Lo=function*(t,s){let n=t.byteLength;if(n<s){yield t;return}let r=0,o;for(;r<n;)o=r+s,yield t.slice(r,o),r=o},Oo=async function*(t,s){for await(const n of Fo(t))yield*Lo(n,s)},Fo=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:n,value:r}=await s.read();if(n)break;yield r}}finally{await s.cancel()}},ds=(t,s,n,r)=>{const o=Oo(t,s);let a=0,i,c=d=>{i||(i=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:f,value:u}=await o.next();if(f){c(),d.close();return}let y=u.byteLength;if(n){let _=a+=y;n(_)}d.enqueue(new Uint8Array(u))}catch(f){throw c(f),f}},cancel(d){return c(d),o.return()}},{highWaterMark:2})},us=64*1024,{isFunction:Xe}=g,No=(({Request:t,Response:s})=>({Request:t,Response:s}))(g.global),{ReadableStream:fs,TextEncoder:hs}=g.global,ps=(t,...s)=>{try{return!!t(...s)}catch{return!1}},zo=t=>{t=g.merge.call({skipUndefined:!0},No,t);const{fetch:s,Request:n,Response:r}=t,o=s?Xe(s):typeof fetch=="function",a=Xe(n),i=Xe(r);if(!o)return!1;const c=o&&Xe(fs),d=o&&(typeof hs=="function"?(l=>m=>l.encode(m))(new hs):async l=>new Uint8Array(await new n(l).arrayBuffer())),f=a&&c&&ps(()=>{let l=!1;const m=new n(W.origin,{body:new fs,method:"POST",get duplex(){return l=!0,"half"}}).headers.has("Content-Type");return l&&!m}),u=i&&c&&ps(()=>g.isReadableStream(new r("").body)),y={stream:u&&(l=>l.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(l=>{!y[l]&&(y[l]=(m,p)=>{let h=m&&m[l];if(h)return h.call(m);throw new $(`Response type '${l}' is not supported`,$.ERR_NOT_SUPPORT,p)})});const _=async l=>{if(l==null)return 0;if(g.isBlob(l))return l.size;if(g.isSpecCompliantForm(l))return(await new n(W.origin,{method:"POST",body:l}).arrayBuffer()).byteLength;if(g.isArrayBufferView(l)||g.isArrayBuffer(l))return l.byteLength;if(g.isURLSearchParams(l)&&(l=l+""),g.isString(l))return(await d(l)).byteLength},b=async(l,m)=>{const p=g.toFiniteNumber(l.getContentLength());return p??_(m)};return async l=>{let{url:m,method:p,data:h,signal:v,cancelToken:S,timeout:P,onDownloadProgress:R,onUploadProgress:w,responseType:j,headers:C,withCredentials:L="same-origin",fetchOptions:q}=sn(l),ae=s||fetch;j=j?(j+"").toLowerCase():"text";let Q=$o([v,S&&S.toAbortSignal()],P),ce=null;const ee=Q&&Q.unsubscribe&&(()=>{Q.unsubscribe()});let A;try{if(w&&f&&p!=="get"&&p!=="head"&&(A=await b(C,h))!==0){let V=new n(m,{method:"POST",body:h,duplex:"half"}),_e;if(g.isFormData(h)&&(_e=V.headers.get("content-type"))&&C.setContentType(_e),V.body){const[St,Je]=is(A,it(ls(w)));h=ds(V.body,us,St,Je)}}g.isString(L)||(L=L?"include":"omit");const I=a&&"credentials"in n.prototype,F={...q,signal:Q,method:p.toUpperCase(),headers:C.normalize().toJSON(),body:h,duplex:"half",credentials:I?L:void 0};ce=a&&new n(m,F);let D=await(a?ae(ce,q):ae(m,F));const he=u&&(j==="stream"||j==="response");if(u&&(R||he&&ee)){const V={};["status","statusText","headers"].forEach(Wt=>{V[Wt]=D[Wt]});const _e=g.toFiniteNumber(D.headers.get("content-length")),[St,Je]=R&&is(_e,it(ls(R),!0))||[];D=new r(ds(D.body,us,St,()=>{Je&&Je(),ee&&ee()}),V)}j=j||"text";let pe=await y[g.findKey(y,j)||"text"](D,l);return!he&&ee&&ee(),await new Promise((V,_e)=>{en(V,_e,{data:pe,headers:X.from(D.headers),status:D.status,statusText:D.statusText,config:l,request:ce})})}catch(I){throw ee&&ee(),I&&I.name==="TypeError"&&/Load failed|fetch/i.test(I.message)?Object.assign(new $("Network Error",$.ERR_NETWORK,l,ce),{cause:I.cause||I}):$.from(I,I&&I.code,l,ce)}}},Uo=new Map,nn=t=>{let s=t&&t.env||{};const{fetch:n,Request:r,Response:o}=s,a=[r,o,n];let i=a.length,c=i,d,f,u=Uo;for(;c--;)d=a[c],f=u.get(d),f===void 0&&u.set(d,f=c?new Map:zo(s)),u=f;return f};nn();const qt={http:to,xhr:To,fetch:{get:nn}};g.forEach(qt,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const ms=t=>`- ${t}`,Do=t=>g.isFunction(t)||t===null||t===!1;function Bo(t,s){t=g.isArray(t)?t:[t];const{length:n}=t;let r,o;const a={};for(let i=0;i<n;i++){r=t[i];let c;if(o=r,!Do(r)&&(o=qt[(c=String(r)).toLowerCase()],o===void 0))throw new $(`Unknown adapter '${c}'`);if(o&&(g.isFunction(o)||(o=o.get(s))))break;a[c||"#"+i]=o}if(!o){const i=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let c=n?i.length>1?`since :
`+i.map(ms).join(`
`):" "+ms(i[0]):"as no adapter specified";throw new $("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return o}const rn={getAdapter:Bo,adapters:qt};function Et(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new $e(null,t)}function gs(t){return Et(t),t.headers=X.from(t.headers),t.data=kt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),rn.getAdapter(t.adapter||Ke.adapter,t)(t).then(function(r){return Et(t),r.data=kt.call(t,t.transformResponse,r),r.headers=X.from(r.headers),r},function(r){return Qs(r)||(Et(t),r&&r.response&&(r.response.data=kt.call(t,t.transformResponse,r.response),r.response.headers=X.from(r.response.headers))),Promise.reject(r)})}const on="1.13.2",vt={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{vt[t]=function(r){return typeof r===t||"a"+(s<1?"n ":" ")+t}});const xs={};vt.transitional=function(s,n,r){function o(a,i){return"[Axios v"+on+"] Transitional option '"+a+"'"+i+(r?". "+r:"")}return(a,i,c)=>{if(s===!1)throw new $(o(i," has been removed"+(n?" in "+n:"")),$.ERR_DEPRECATED);return n&&!xs[i]&&(xs[i]=!0,console.warn(o(i," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(a,i,c):!0}};vt.spelling=function(s){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${s}`),!0)};function Mo(t,s,n){if(typeof t!="object")throw new $("options must be an object",$.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let o=r.length;for(;o-- >0;){const a=r[o],i=s[a];if(i){const c=t[a],d=c===void 0||i(c,a,t);if(d!==!0)throw new $("option "+a+" must be "+d,$.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new $("Unknown option "+a,$.ERR_BAD_OPTION)}}const nt={assertOptions:Mo,validators:vt},ie=nt.validators;let we=class{constructor(s){this.defaults=s||{},this.interceptors={request:new os,response:new os}}async request(s,n){try{return await this._request(s,n)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=ve(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:a}=n;r!==void 0&&nt.assertOptions(r,{silentJSONParsing:ie.transitional(ie.boolean),forcedJSONParsing:ie.transitional(ie.boolean),clarifyTimeoutError:ie.transitional(ie.boolean)},!1),o!=null&&(g.isFunction(o)?n.paramsSerializer={serialize:o}:nt.assertOptions(o,{encode:ie.function,serialize:ie.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),nt.assertOptions(n,{baseUrl:ie.spelling("baseURL"),withXsrfToken:ie.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=a&&g.merge(a.common,a[n.method]);a&&g.forEach(["delete","get","head","post","put","patch","common"],l=>{delete a[l]}),n.headers=X.concat(i,a);const c=[];let d=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(d=d&&m.synchronous,c.unshift(m.fulfilled,m.rejected))});const f=[];this.interceptors.response.forEach(function(m){f.push(m.fulfilled,m.rejected)});let u,y=0,_;if(!d){const l=[gs.bind(this),void 0];for(l.unshift(...c),l.push(...f),_=l.length,u=Promise.resolve(n);y<_;)u=u.then(l[y++],l[y++]);return u}_=c.length;let b=n;for(;y<_;){const l=c[y++],m=c[y++];try{b=l(b)}catch(p){m.call(this,p);break}}try{u=gs.call(this,b)}catch(l){return Promise.reject(l)}for(y=0,_=f.length;y<_;)u=u.then(f[y++],f[y++]);return u}getUri(s){s=ve(this.defaults,s);const n=tn(s.baseURL,s.url,s.allowAbsoluteUrls);return Gs(n,s.params,s.paramsSerializer)}};g.forEach(["delete","get","head","options"],function(s){we.prototype[s]=function(n,r){return this.request(ve(r||{},{method:s,url:n,data:(r||{}).data}))}});g.forEach(["post","put","patch"],function(s){function n(r){return function(a,i,c){return this.request(ve(c||{},{method:s,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}we.prototype[s]=n(),we.prototype[s+"Form"]=n(!0)});let Vo=class an{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(o=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](o);r._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(c=>{r.subscribe(c),a=c}).then(o);return i.cancel=function(){r.unsubscribe(a)},i},s(function(a,i,c){r.reason||(r.reason=new $e(a,i,c),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=r=>{s.abort(r)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new an(function(o){s=o}),cancel:s}}};function qo(t){return function(n){return t.apply(null,n)}}function Ho(t){return g.isObject(t)&&t.isAxiosError===!0}const Ft={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ft).forEach(([t,s])=>{Ft[s]=t});function ln(t){const s=new we(t),n=zs(we.prototype.request,s);return g.extend(n,we.prototype,s,{allOwnKeys:!0}),g.extend(n,s,null,{allOwnKeys:!0}),n.create=function(o){return ln(ve(t,o))},n}const B=ln(Ke);B.Axios=we;B.CanceledError=$e;B.CancelToken=Vo;B.isCancel=Qs;B.VERSION=on;B.toFormData=bt;B.AxiosError=$;B.Cancel=B.CanceledError;B.all=function(s){return Promise.all(s)};B.spread=qo;B.isAxiosError=Ho;B.mergeConfig=ve;B.AxiosHeaders=X;B.formToJSON=t=>Zs(g.isHTMLForm(t)?new FormData(t):t);B.getAdapter=rn.getAdapter;B.HttpStatusCode=Ft;B.default=B;const{Axios:Ma,AxiosError:Va,CanceledError:qa,isCancel:Ha,CancelToken:Wa,VERSION:Ka,all:Ja,Cancel:Ya,isAxiosError:Ga,spread:Xa,toFormData:Za,AxiosHeaders:Qa,HttpStatusCode:ei,formToJSON:ti,getAdapter:si,mergeConfig:ni}=B;class Wo{constructor(s="/api"){_t(this,"client");this.client=B.create({baseURL:s,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(n=>{const r=localStorage.getItem("token");return r&&(n.headers.Authorization=`Bearer ${r}`),n},n=>Promise.reject(n)),this.client.interceptors.response.use(n=>n,n=>{var r;return((r=n.response)==null?void 0:r.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userPreferences"),window.dispatchEvent(new CustomEvent("auth:logout"))),Promise.reject(n)})}async get(s,n){return(await this.client.get(s,n)).data}async post(s,n,r){return(await this.client.post(s,n,r)).data}async put(s,n,r){return(await this.client.put(s,n,r)).data}async delete(s,n){return(await this.client.delete(s,n)).data}async patch(s,n,r){return(await this.client.patch(s,n,r)).data}}const N=new Wo,Ht={login:t=>N.post("/auth/login",t),logout:()=>N.post("/auth/logout"),getCurrentUser:()=>N.get("/auth/user"),updateProfile:t=>N.put("/profile",t)},cn=({size:t=36,collapsed:s=!1,textColor:n,centered:r=!1})=>s?e.jsxs("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient-collapsed",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#667eea"}),e.jsx("stop",{offset:"100%",stopColor:"#764ba2"})]})}),e.jsx("path",{d:"M50 20 C32 20 20 32 20 50 C20 68 32 80 50 80 C63 80 73 72 77 61 L62 61 C59 65 55 68 50 68 C39 68 32 61 32 50 C32 39 39 32 50 32 C55 32 59 34 62 37 L72 27 C66 22 58 20 50 20 Z M62 50 L80 50 L80 61 L62 61 Z",fill:"url(#gradient-collapsed)"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,width:r?"auto":"100%",justifyContent:r?"center":"flex-start",paddingLeft:r?0:4},children:[e.jsxs("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient-full",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#667eea"}),e.jsx("stop",{offset:"100%",stopColor:"#764ba2"})]})}),e.jsx("path",{d:"M50 20 C32 20 20 32 20 50 C20 68 32 80 50 80 C63 80 73 72 77 61 L62 61 C59 65 55 68 50 68 C39 68 32 61 32 50 C32 39 39 32 50 32 C55 32 59 34 62 37 L72 27 C66 22 58 20 50 20 Z M62 50 L80 50 L80 61 L62 61 Z",fill:"url(#gradient-full)"})]}),e.jsx("span",{style:{fontSize:22,fontWeight:600,color:n||"#667eea",letterSpacing:"0.5px",lineHeight:1},children:"Gesi"})]}),{Header:Ko,Sider:Jo,Content:Yo}=It;function Go(){const t=fe(),s=$n(),{user:n,logout:r}=ye(),[o,a]=x.useState(!1),i=[{key:"/dashboard",icon:e.jsx(wn,{}),label:"Dashboard",onClick:()=>t("/dashboard")},{key:"/environments",icon:e.jsx(ot,{}),label:"Environments",onClick:()=>t("/environments")},{key:"/nodes",icon:e.jsx(bn,{}),label:"Nodes",onClick:()=>t("/nodes")},{key:"/processes",icon:e.jsx(ot,{}),label:"Processes",onClick:()=>t("/processes")},{key:"/alerts",icon:e.jsx(rt,{}),label:"Alerts",children:[{key:"/alerts",label:"Alert List",onClick:()=>t("/alerts")},{key:"/alerts/rules",label:"Alert Rules",onClick:()=>t("/alerts/rules")}]},{key:"/logs",icon:e.jsx(Nt,{}),label:"Logs",onClick:()=>t("/logs")},{key:"/users",icon:e.jsx(be,{}),label:"Users",onClick:()=>t("/users")},{key:"/settings",icon:e.jsx(ze,{}),label:"Settings",onClick:()=>t("/settings")}],c=[{key:"settings",icon:e.jsx(ze,{}),label:"Settings",onClick:()=>t("/settings")},{type:"divider"},{key:"logout",icon:e.jsx(vn,{}),label:"Logout",onClick:()=>{r(),t("/login")}}],d=s.pathname;return e.jsxs(It,{style:{minHeight:"100vh"},children:[e.jsxs(Jo,{trigger:null,collapsible:!0,collapsed:o,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[e.jsx("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"0 20px"},onClick:()=>t("/dashboard"),children:e.jsx(cn,{size:36,collapsed:o,textColor:"#fff"})}),e.jsx(gn,{theme:"dark",mode:"inline",selectedKeys:[d],items:i})]}),e.jsxs(It,{style:{marginLeft:o?80:200,transition:"all 0.2s"},children:[e.jsxs(Ko,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 4px rgba(0,21,41,.08)"},children:[e.jsx("div",{children:o?e.jsx(xn,{style:{fontSize:18,cursor:"pointer"},onClick:()=>a(!1)}):e.jsx(yn,{style:{fontSize:18,cursor:"pointer"},onClick:()=>a(!0)})}),e.jsxs(O,{size:"large",children:[e.jsx(vs,{count:0,showZero:!1,children:e.jsx(rt,{style:{fontSize:18,cursor:"pointer"}})}),e.jsx(jn,{menu:{items:c},placement:"bottomRight",children:e.jsxs(O,{style:{cursor:"pointer"},children:[e.jsx(Ss,{icon:e.jsx(be,{})}),e.jsx("span",{children:(n==null?void 0:n.username)||"User"})]})})]})]}),e.jsx(Yo,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#f0f2f5"},children:e.jsx(Ln,{})})]})]})}function Xo(){const t=fe(),{setUser:s,setToken:n}=ye(),[r,o]=x.useState(!1),a=async i=>{var c,d;o(!0);try{const f=await Ht.login(i);if(f.status==="success"&&f.data){const{token:u,user:y}=f.data;n(u),s(y),E.success("Login successful!"),t("/dashboard")}else E.error(f.message||"Login failed")}catch(f){E.error(((d=(c=f.response)==null?void 0:c.data)==null?void 0:d.message)||"Login failed")}finally{o(!1)}};return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:e.jsx(U,{style:{width:400,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:e.jsxs(O,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(cn,{size:64,collapsed:!1,centered:!0}),e.jsx("p",{style:{color:"#666",marginTop:16},children:"Supervisor Management Platform"})]}),e.jsxs(T,{name:"login",onFinish:a,autoComplete:"off",size:"large",children:[e.jsx(T.Item,{name:"username",rules:[{required:!0,message:"Please input your username!"}],children:e.jsx(M,{prefix:e.jsx(be,{}),placeholder:"Username"})}),e.jsx(T.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(M.Password,{prefix:e.jsx(ke,{}),placeholder:"Password"})}),e.jsx(T.Item,{children:e.jsx(k,{type:"primary",htmlType:"submit",loading:r,block:!0,children:"Log in"})})]}),e.jsx("div",{style:{textAlign:"center",color:"#999",fontSize:12},children:"Default: admin / 123456"})]})})})}const se={getNodes:()=>N.get("/nodes"),getNode:t=>N.get(`/nodes/${t}`),getNodeProcesses:t=>N.get(`/nodes/${t}/processes`),startProcess:(t,s)=>N.post(`/nodes/${t}/processes/${s}/start`),stopProcess:(t,s)=>N.post(`/nodes/${t}/processes/${s}/stop`),restartProcess:(t,s)=>N.post(`/nodes/${t}/processes/${s}/restart`),startAllProcesses:t=>N.post(`/nodes/${t}/processes/start-all`),stopAllProcesses:t=>N.post(`/nodes/${t}/processes/stop-all`),restartAllProcesses:t=>N.post(`/nodes/${t}/processes/restart-all`),getProcessLogs:(t,s)=>N.get(`/nodes/${t}/processes/${s}/logs`),getProcessLogStream:(t,s,n,r)=>N.get(`/nodes/${t}/processes/${s}/logs/stream`,{params:{offset:n||0,max_lines:r||50}})},Se=(t={})=>{var v;const{onMessage:s,onConnect:n,onDisconnect:r,onError:o,reconnectInterval:a=3e3,maxReconnectAttempts:i=5}=t,c=x.useRef(null),d=x.useRef(0),f=x.useRef(),u=x.useRef(!0),y=x.useRef(s),_=x.useRef(n),b=x.useRef(r),l=x.useRef(o);x.useEffect(()=>{y.current=s,_.current=n,b.current=r,l.current=o},[s,n,r,o]);const m=x.useCallback(()=>{const S=localStorage.getItem("token");if(!S)return;const P=window.location.protocol==="https:"?"wss:":"ws:",R=window.location.host,w=`${P}//${R}/ws?token=${S}`;try{const j=new WebSocket(w);j.onopen=()=>{var C;d.current=0,(C=_.current)==null||C.call(_)},j.onmessage=C=>{var L;try{const q=C.data.split(`
`).filter(ae=>ae.trim());for(const ae of q)try{const Q=JSON.parse(ae);(L=y.current)==null||L.call(y,Q)}catch(Q){console.error("Error parsing WebSocket message:",Q)}}catch(q){console.error("Error processing WebSocket message:",q)}},j.onclose=()=>{var C;(C=b.current)==null||C.call(b),u.current&&d.current<i&&(d.current++,f.current=setTimeout(m,a))},j.onerror=()=>{var C;(C=l.current)==null||C.call(l,new Event("error"))},c.current=j}catch(j){console.error("Failed to create WebSocket connection:",j)}},[a,i]),p=x.useCallback(()=>{u.current=!1,f.current&&clearTimeout(f.current),c.current&&(c.current.close(),c.current=null)},[]),h=x.useCallback(S=>{c.current&&c.current.readyState===WebSocket.OPEN?c.current.send(JSON.stringify(S)):console.error("WebSocket is not connected")},[]);return x.useEffect(()=>(localStorage.getItem("token")&&(u.current=!0,m()),()=>{u.current=!1,f.current&&clearTimeout(f.current),c.current&&(c.current.close(),c.current=null)}),[]),{send:h,disconnect:p,reconnect:m,isConnected:((v=c.current)==null?void 0:v.readyState)===WebSocket.OPEN}};function Zo(){const t=fe(),{nodes:s,setNodes:n,systemStats:r,setSystemStats:o}=ye(),[a,i]=x.useState(!1),[c,d]=x.useState(0);x.useEffect(()=>{f(),u()},[]);const f=async()=>{var m;i(!0);try{const p=await se.getNodes();n(((m=p.data)==null?void 0:m.nodes)||[])}catch(p){console.error("Failed to load nodes:",p)}finally{i(!1)}},u=async()=>{try{const m=await fetch("/api/alerts/statistics?time_range=24h",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(m.ok){const p=await m.json();d(p.active_alerts||0)}}catch(m){console.error("Failed to load alert stats:",m)}};Se({onMessage:m=>{m.type==="nodes_update"?n(m.data):m.type==="system_stats"&&o(m.data)}});const y=s.length,_=s.filter(m=>m.is_connected).length,b=(r==null?void 0:r.running_processes)||0,l=[{title:"Node Name",dataIndex:"name",key:"name",render:m=>e.jsx("a",{onClick:()=>t(`/nodes/${m}`),children:m})},{title:"Environment",dataIndex:"environment",key:"environment",render:m=>e.jsx(z,{color:"blue",children:m})},{title:"Host",key:"host",render:(m,p)=>`${p.host}:${p.port}`},{title:"Status",dataIndex:"is_connected",key:"status",render:m=>m?e.jsx(z,{icon:e.jsx(re,{}),color:"success",children:"Online"}):e.jsx(z,{icon:e.jsx(ne,{}),color:"error",children:"Offline"})},{title:"Processes",dataIndex:"process_count",key:"process_count",render:m=>m||0},{title:"Action",key:"action",render:(m,p)=>e.jsx(k,{type:"link",size:"small",onClick:()=>t(`/nodes/${p.name}`),children:"View Details"})}];return e.jsxs("div",{children:[e.jsxs(De,{gutter:16,style:{marginBottom:24},children:[e.jsx(te,{xs:24,sm:12,lg:6,children:e.jsx(U,{children:e.jsx(le,{title:"Total Nodes",value:y,prefix:null,valueStyle:{color:"#1890ff"}})})}),e.jsx(te,{xs:24,sm:12,lg:6,children:e.jsx(U,{children:e.jsx(le,{title:"Online Nodes",value:_,prefix:e.jsx(re,{}),valueStyle:{color:"#3f8600"}})})}),e.jsx(te,{xs:24,sm:12,lg:6,children:e.jsx(U,{children:e.jsx(le,{title:"Running Processes",value:b,prefix:e.jsx(xe,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(te,{xs:24,sm:12,lg:6,children:e.jsx(U,{children:e.jsx(le,{title:"Active Alerts",value:c,prefix:e.jsx(rt,{}),valueStyle:{color:c>0?"#cf1322":"#999"}})})})]}),e.jsx(U,{title:"Nodes Overview",extra:e.jsx(k,{type:"primary",onClick:f,loading:a,children:"Refresh"}),children:e.jsx(ue,{columns:l,dataSource:s,rowKey:"name",loading:a,pagination:{pageSize:10}})})]})}function Qo(t,s){const[n,r]=x.useState(()=>{try{const a=window.localStorage.getItem(t);return a?JSON.parse(a):s}catch(a){return console.warn(`Error reading localStorage key "${t}":`,a),s}});return[n,a=>{try{const i=a instanceof Function?a(n):a;r(i),window.localStorage.setItem(t,JSON.stringify(i))}catch(i){console.warn(`Error setting localStorage key "${t}":`,i)}}]}function ea(t,s){const[n,r]=x.useState(t);return x.useEffect(()=>{const o=setTimeout(()=>{r(t)},s);return()=>{clearTimeout(o)}},[t,s]),n}function ta(t,s,n){const r=ea(s,300),o=x.useMemo(()=>t.filter(c=>{if(r){const d=r.toLowerCase();if(!(c.name.toLowerCase().includes(d)||c.host.toLowerCase().includes(d)||c.environment.toLowerCase().includes(d)||c.username&&c.username.toLowerCase().includes(d)))return!1}if(n.status){const d=c.is_connected;if(n.status==="online"&&!d||n.status==="offline"&&d)return!1}if(n.environment&&c.environment!==n.environment)return!1;if(n.processCountRange){const d=c.process_count||0,[f,u]=n.processCountRange;if(f!==void 0&&d<f||u!==void 0&&d>u)return!1}return!0}),[t,r,n]),a=x.useMemo(()=>{const c=new Set(t.map(d=>d.environment));return Array.from(c).sort()},[t]),i=x.useMemo(()=>{const c=t.length,d=o.length,f=o.filter(y=>y.is_connected).length,u=d-f;return{total:c,filtered:d,online:f,offline:u,isFiltered:d!==c}},[t.length,o]);return{filteredNodes:o,availableEnvironments:a,stats:i,debouncedSearch:r}}const sa={md:768};function na(){const[t,s]=x.useState(!1);return x.useEffect(()=>{const n=()=>{s(window.innerWidth<sa.md)};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),t}const ra=({value:t,onChange:s,disabled:n=!1,size:r="middle"})=>e.jsxs(k.Group,{size:r,role:"radiogroup","aria-label":"View mode selection",children:[e.jsx(k,{type:t==="card"?"primary":"default",icon:e.jsx(ot,{}),onClick:()=>s("card"),disabled:n,role:"radio","aria-checked":t==="card","aria-label":"Card view",children:"Cards"}),e.jsx(k,{type:t==="list"?"primary":"default",icon:e.jsx(Sn,{}),onClick:()=>s("list"),disabled:n,role:"radio","aria-checked":t==="list","aria-label":"List view",children:"List"})]}),oa=({value:t,onChange:s,placeholder:n="Search nodes...",debounceMs:r=300,allowClear:o=!0,size:a="middle",style:i})=>{const[c,d]=x.useState(t);x.useEffect(()=>{d(t)},[t]),x.useEffect(()=>{const y=setTimeout(()=>{c!==t&&s(c)},r);return()=>clearTimeout(y)},[c,s,t,r]);const f=y=>{d(y.target.value)},u=()=>{d(""),s("")};return e.jsx(M,{prefix:e.jsx(Re,{}),placeholder:n,value:c,onChange:f,allowClear:o,onClear:u,size:a,style:i,"aria-label":"Search nodes",role:"searchbox","aria-describedby":"search-help"})},aa=({filters:t,onFiltersChange:s,environments:n,totalNodes:r,filteredNodes:o,size:a="middle"})=>{var u,y;const i=(_,b)=>{const l={...t};b==null||b===""?delete l[_]:l[_]=b,s(l)},c=()=>{s({})},d=Object.keys(t).length>0,f=o!==r;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},role:"region","aria-label":"Node filters",children:[e.jsxs(O,{size:"middle",wrap:!0,children:[e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"status-filter-label",children:"Status:"}),e.jsxs(H,{placeholder:"All",value:t.status,onChange:_=>i("status",_),allowClear:!0,size:a,style:{minWidth:100},"aria-labelledby":"status-filter-label","aria-label":"Filter by node status",children:[e.jsx(H.Option,{value:"online",children:"Online"}),e.jsx(H.Option,{value:"offline",children:"Offline"})]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"environment-filter-label",children:"Environment:"}),e.jsx(H,{placeholder:"All",value:t.environment,onChange:_=>i("environment",_),allowClear:!0,size:a,style:{minWidth:120},"aria-labelledby":"environment-filter-label","aria-label":"Filter by environment",children:n.map(_=>e.jsx(H.Option,{value:_,children:_},_))})]}),e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"process-filter-label",children:"Processes:"}),e.jsxs(O.Compact,{children:[e.jsx(ge,{placeholder:"Min",value:(u=t.processCountRange)==null?void 0:u[0],onChange:_=>{const b=t.processCountRange||[void 0,void 0];i("processCountRange",[_,b[1]])},size:a,style:{width:80},min:0,"aria-label":"Minimum process count"}),e.jsx(ge,{placeholder:"Max",value:(y=t.processCountRange)==null?void 0:y[1],onChange:_=>{const b=t.processCountRange||[void 0,void 0];i("processCountRange",[b[0],_])},size:a,style:{width:80},min:0,"aria-label":"Maximum process count"})]})]}),d&&e.jsx(k,{type:"text",icon:e.jsx(_s,{}),onClick:c,size:a,"aria-label":"Clear all filters",children:"Clear All"})]}),f&&e.jsxs("div",{style:{marginLeft:"auto",fontSize:14,color:"#666"},"aria-live":"polite","aria-label":`Showing ${o} of ${r} nodes`,children:["Showing ",o," of ",r," nodes"]}),d&&e.jsx("div",{style:{width:"100%",marginTop:8},role:"region","aria-label":"Active filters",children:e.jsxs(O,{size:4,wrap:!0,children:[t.status&&e.jsxs(z,{closable:!0,onClose:()=>i("status",void 0),color:"blue","aria-label":`Remove status filter: ${t.status}`,children:["Status: ",t.status]}),t.environment&&e.jsxs(z,{closable:!0,onClose:()=>i("environment",void 0),color:"green","aria-label":`Remove environment filter: ${t.environment}`,children:["Environment: ",t.environment]}),t.processCountRange&&e.jsxs(z,{closable:!0,onClose:()=>i("processCountRange",void 0),color:"orange","aria-label":`Remove process count filter: ${t.processCountRange[0]||0}-${t.processCountRange[1]||"∞"}`,children:["Processes: ",t.processCountRange[0]||0,"-",t.processCountRange[1]||"∞"]})]})})]})},{Text:Rt}=ct,ia=48,ys=40,la=({nodes:t,loading:s=!1,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:a,searchQuery:i="",height:c=400})=>{const[d,f]=x.useState({}),u=x.useMemo(()=>{let h=t.map(v=>({...v,key:v.name,statusColor:v.is_connected?"#52c41a":"#ff4d4f",displayName:v.name}));return d.columnKey&&(h=h.sort((v,S)=>{const P=v[d.columnKey],R=S[d.columnKey];if(typeof P=="string"&&typeof R=="string"){const w=P.localeCompare(R);return d.order==="descend"?-w:w}if(typeof P=="number"&&typeof R=="number"){const w=P-R;return d.order==="descend"?-w:w}if(typeof P=="boolean"&&typeof R=="boolean"){const w=Number(P)-Number(R);return d.order==="descend"?-w:w}return 0})),h},[t,d]),y=(h,v)=>{if(!v)return h;const S=new RegExp(`(${v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return h.split(S).map((R,w)=>S.test(R)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:R},w):R)},_=x.useCallback((h,v)=>{r(v?[...n,h]:n.filter(S=>S!==h))},[n,r]),b=x.useCallback(h=>{r(h?u.map(v=>v.key):[])},[u,r]),l=x.useCallback(h=>{const v=d.columnKey===h&&d.order==="ascend"?"descend":"ascend";f({columnKey:h,order:v})},[d]),m=x.useCallback(({index:h,style:v})=>{const S=u[h],P=n.includes(S.key);return e.jsxs("div",{style:{...v,display:"flex",alignItems:"center",borderBottom:"1px solid #f0f0f0",backgroundColor:P?"#e6f7ff":"white",cursor:"pointer"},onClick:()=>o(S.name),children:[e.jsx("div",{style:{width:50,textAlign:"center",paddingLeft:16},children:e.jsx(Kt,{checked:P,onChange:R=>{R.stopPropagation(),_(S.key,R.target.checked)}})}),e.jsx("div",{style:{width:80,textAlign:"center"},children:e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:S.statusColor,margin:"0 auto"}})}),e.jsx("div",{style:{width:200,paddingLeft:8},children:e.jsx(k,{type:"link",onClick:R=>{R.stopPropagation(),o(S.name)},style:{padding:0,height:"auto",fontWeight:500},children:y(S.name,i)})}),e.jsx("div",{style:{width:120,paddingLeft:8},children:e.jsx(z,{color:"blue",children:y(S.environment||"default",i)})}),e.jsx("div",{style:{width:180,paddingLeft:8},children:e.jsx(Rt,{code:!0,style:{fontSize:12},children:y(`${S.host}:${S.port}`,i)})}),e.jsx("div",{style:{width:100,paddingLeft:8},children:S.username?e.jsx(Rt,{type:"secondary",style:{fontSize:12},children:y(S.username,i)}):e.jsx(Rt,{type:"secondary",style:{fontSize:12},children:"-"})}),e.jsx("div",{style:{width:100,textAlign:"center"},children:e.jsx(z,{color:S.process_count>0?"blue":"default",children:S.process_count||0})}),e.jsx("div",{style:{width:100,paddingLeft:8},children:e.jsx(z,{icon:S.is_connected?e.jsx(re,{}):e.jsx(ne,{}),color:S.is_connected?"success":"error",children:S.is_connected?"Online":"Offline"})}),e.jsx("div",{style:{width:120,textAlign:"center"},children:e.jsxs(O,{size:"small",children:[e.jsx(Ee,{title:"View Details",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(zt,{}),onClick:R=>{R.stopPropagation(),o(S.name)}})}),a&&e.jsx(Ee,{title:"Refresh Node",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(K,{}),onClick:R=>{R.stopPropagation(),a(S.name)}})}),e.jsx(Ee,{title:"Node Settings",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(ze,{}),onClick:R=>{R.stopPropagation(),console.log("Node settings for:",S.name)}})})]})})]})},[u,n,i,o,a,_]),p=()=>{const h=u.length>0&&n.length===u.length,v=n.length>0&&n.length<u.length;return e.jsxs("div",{style:{height:ys,display:"flex",alignItems:"center",borderBottom:"2px solid #f0f0f0",backgroundColor:"#fafafa",fontWeight:"bold"},children:[e.jsx("div",{style:{width:50,textAlign:"center",paddingLeft:16},children:e.jsx(Kt,{checked:h,indeterminate:v,onChange:S=>b(S.target.checked)})}),e.jsxs("div",{style:{width:80,textAlign:"center",cursor:"pointer"},onClick:()=>l("is_connected"),children:["Status ",d.columnKey==="is_connected"&&(d.order==="ascend"?"↑":"↓")]}),e.jsxs("div",{style:{width:200,paddingLeft:8,cursor:"pointer"},onClick:()=>l("name"),children:["Name ",d.columnKey==="name"&&(d.order==="ascend"?"↑":"↓")]}),e.jsxs("div",{style:{width:120,paddingLeft:8,cursor:"pointer"},onClick:()=>l("environment"),children:["Environment ",d.columnKey==="environment"&&(d.order==="ascend"?"↑":"↓")]}),e.jsx("div",{style:{width:180,paddingLeft:8},children:"Host:Port"}),e.jsx("div",{style:{width:100,paddingLeft:8},children:"User"}),e.jsxs("div",{style:{width:100,textAlign:"center",cursor:"pointer"},onClick:()=>l("process_count"),children:["Processes ",d.columnKey==="process_count"&&(d.order==="ascend"?"↑":"↓")]}),e.jsx("div",{style:{width:100,paddingLeft:8},children:"Status"}),e.jsx("div",{style:{width:120,textAlign:"center"},children:"Actions"})]})};return s?e.jsx("div",{style:{textAlign:"center",padding:50},children:"Loading..."}):e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:6},children:[e.jsx(p,{}),e.jsx(void 0,{height:c-ys,itemCount:u.length,itemSize:ia,width:"100%",children:m}),e.jsxs("div",{style:{padding:"8px 16px",borderTop:"1px solid #f0f0f0",backgroundColor:"#fafafa",fontSize:14,color:"#666"},children:["Total: ",u.length," nodes",n.length>0&&` | Selected: ${n.length}`]})]})},{Text:At}=ct,js=100,ca=({nodes:t,loading:s=!1,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:a,searchQuery:i=""})=>{const[c,d]=x.useState({}),[f,u]=x.useState(!0);if(t.length>=js&&f)try{return e.jsxs("div",{children:[t.length>=js&&e.jsx(de,{message:`Large dataset detected (${t.length} nodes). Using virtualized table for better performance.`,type:"info",showIcon:!0,style:{marginBottom:16},action:e.jsx(k,{size:"small",type:"text",onClick:()=>u(!1),children:"Use Standard Table"})}),e.jsx(la,{nodes:t,loading:s,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:a,searchQuery:i,height:600})]})}catch(h){console.warn("Virtual scrolling failed, falling back to standard table:",h),u(!1)}const _=x.useMemo(()=>t.map(h=>({...h,key:h.name,statusColor:h.is_connected?"#52c41a":"#ff4d4f",displayName:h.name})),[t]),b=(h,v)=>{if(!v)return h;const S=new RegExp(`(${v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return h.split(S).map((R,w)=>S.test(R)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:R},w):R)},l=[{title:"Status",dataIndex:"is_connected",key:"status",width:80,align:"center",sorter:(h,v)=>Number(h.is_connected)-Number(v.is_connected),sortOrder:c.columnKey==="status"?c.order:null,render:h=>e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:h?"#52c41a":"#ff4d4f",margin:"0 auto"}})},{title:"Name",dataIndex:"name",key:"name",width:200,sorter:(h,v)=>h.name.localeCompare(v.name),sortOrder:c.columnKey==="name"?c.order:null,render:h=>e.jsx(k,{type:"link",onClick:()=>o(h),style:{padding:0,height:"auto",fontWeight:500},children:b(h,i)})},{title:"Environment",dataIndex:"environment",key:"environment",width:120,responsive:["md"],sorter:(h,v)=>h.environment.localeCompare(v.environment),sortOrder:c.columnKey==="environment"?c.order:null,render:h=>e.jsx(z,{color:"blue",children:b(h||"default",i)})},{title:"Host:Port",key:"hostPort",width:180,responsive:["lg"],render:(h,v)=>e.jsx(At,{code:!0,style:{fontSize:12},children:b(`${v.host}:${v.port}`,i)})},{title:"User",dataIndex:"username",key:"username",width:100,responsive:["xl"],render:h=>h?e.jsx(At,{type:"secondary",style:{fontSize:12},children:b(h,i)}):e.jsx(At,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"Processes",dataIndex:"process_count",key:"process_count",width:100,align:"center",responsive:["md"],sorter:(h,v)=>(h.process_count||0)-(v.process_count||0),sortOrder:c.columnKey==="process_count"?c.order:null,render:h=>e.jsx(z,{color:h>0?"blue":"default",children:h||0})},{title:"Status",key:"connectionStatus",width:100,responsive:["sm"],render:(h,v)=>e.jsx(z,{icon:v.is_connected?e.jsx(re,{}):e.jsx(ne,{}),color:v.is_connected?"success":"error",children:v.is_connected?"Online":"Offline"})},{title:"Actions",key:"actions",width:120,align:"center",render:(h,v)=>e.jsxs(O,{size:"small",children:[e.jsx(Ee,{title:"View Details",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(zt,{}),onClick:S=>{S.stopPropagation(),o(v.name)}})}),a&&e.jsx(Ee,{title:"Refresh Node",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(K,{}),onClick:S=>{S.stopPropagation(),a(v.name)}})}),e.jsx(Ee,{title:"Node Settings",children:e.jsx(k,{type:"text",size:"small",icon:e.jsx(ze,{}),onClick:S=>{S.stopPropagation(),console.log("Node settings for:",v.name)}})})]})}],m={selectedRowKeys:n,onChange:h=>{r(h)},getCheckboxProps:h=>({name:h.name})},p=(h,v,S)=>{d(S)};return e.jsx(ue,{columns:l,dataSource:_,rowSelection:m,loading:s,onChange:p,pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(h,v)=>`${v[0]}-${v[1]} of ${h} nodes`,pageSizeOptions:["10","20","50","100"],defaultPageSize:20},scroll:{x:800},size:"middle",rowClassName:h=>n.includes(h.key)?"ant-table-row-selected":"",onRow:h=>({onClick:()=>o(h.name),style:{cursor:"pointer"}}),locale:{emptyText:i?`No nodes found matching "${i}"`:"No nodes available"}})},{Text:ws}=ct,da=({viewMode:t,onViewModeChange:s,searchQuery:n,onSearchChange:r,filters:o,onFiltersChange:a,environments:i,totalNodes:c,filteredNodes:d,selectedNodes:f,onBulkAction:u,onRefreshAll:y,loading:_=!1,isMobile:b=!1})=>{const l=f.length>0,m=d!==c,p=h=>{u({type:h,nodeIds:f})};return e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16,marginBottom:16},children:[e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:24},children:"Nodes"}),e.jsx(ws,{type:"secondary",style:{fontSize:14},children:m?e.jsxs(e.Fragment,{children:["Showing ",d," of ",c," nodes"]}):e.jsxs(e.Fragment,{children:[c," nodes total"]})})]}),!b&&e.jsxs(e.Fragment,{children:[e.jsx(Ne,{type:"vertical",style:{height:32}}),e.jsx(ra,{value:t,onChange:s,disabled:_})]})]})}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:y,loading:_,children:b?"":"Refresh All"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",gap:16,alignItems:b?"stretch":"flex-start",marginBottom:l?16:0},children:[e.jsx("div",{style:{flex:b?"none":"0 0 300px"},children:e.jsx(oa,{value:n,onChange:r,placeholder:"Search by name, host, environment...",size:b?"large":"middle"})}),e.jsx("div",{style:{flex:1,minWidth:0},children:e.jsx(aa,{filters:o,onFiltersChange:a,environments:i,totalNodes:c,filteredNodes:d,size:b?"large":"middle"})})]}),l&&e.jsx(de,{type:"info",showIcon:!0,style:{marginBottom:16},message:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[e.jsxs(ws,{strong:!0,children:[f.length," node",f.length>1?"s":""," selected"]}),e.jsxs(O,{size:"small",wrap:!0,children:[e.jsx(k,{size:"small",icon:e.jsx(xe,{}),onClick:()=>p("start_all"),children:"Start All Processes"}),e.jsx(k,{size:"small",icon:e.jsx(Ae,{}),onClick:()=>p("stop_all"),children:"Stop All Processes"}),e.jsx(k,{size:"small",icon:e.jsx(_n,{}),onClick:()=>p("restart_all"),children:"Restart All Processes"}),e.jsx(k,{size:"small",icon:e.jsx(K,{}),onClick:()=>p("refresh_all"),children:"Refresh Status"}),e.jsx(Ne,{type:"vertical"}),e.jsx(k,{size:"small",danger:!0,icon:e.jsx(Ut,{}),onClick:()=>p("delete_selected"),children:"Remove Selected"})]})]})})]})},ua=50,fa=20,ha=({nodes:t,onNodeClick:s,searchQuery:n="",pageSize:r=ua})=>{const[o,a]=x.useState(1),[i,c]=x.useState(r),d=t.length>fa,f=x.useMemo(()=>{if(!d)return t;const y=(o-1)*i;return t.slice(y,y+i)},[t,o,i,d]);Dt.useEffect(()=>{a(1)},[t.length]);const u=(y,_)=>{a(y),_&&_!==i&&c(_)};return e.jsxs("div",{children:[d&&e.jsx(de,{message:`Large dataset (${t.length} nodes). Showing ${i} nodes per page for better performance.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(De,{gutter:[16,16],children:f.map(y=>e.jsx(te,{xs:24,sm:12,lg:8,children:e.jsx(pa,{node:y,onView:()=>s(y.name),searchQuery:n})},y.name))}),d&&e.jsx("div",{style:{marginTop:24,textAlign:"center",padding:"16px 0",borderTop:"1px solid #f0f0f0"},children:e.jsx(Cn,{current:o,total:t.length,pageSize:i,showSizeChanger:!0,showQuickJumper:!0,showTotal:(y,_)=>`${_[0]}-${_[1]} of ${y} nodes`,pageSizeOptions:["20","50","100","200"],onChange:u,onShowSizeChange:u})})]})};function pa({node:t,onView:s,searchQuery:n=""}){const r=t.is_connected,o=a=>{if(!n)return a;const i=new RegExp(`(${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return a.split(i).map((d,f)=>i.test(d)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:d},f):d)};return e.jsx(U,{hoverable:!0,style:{height:"100%",cursor:"pointer"},onClick:s,children:e.jsxs(O,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:8,background:"#1890ff20",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(re,{style:{fontSize:24,color:"#1890ff"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:o(t.name)}),e.jsx(z,{color:"blue",style:{marginTop:4},children:o(t.environment||"default")})]})]}),e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:r?"#52c41a":"#ff4d4f"}})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#666",fontSize:14,marginBottom:4},children:o(`${t.host}:${t.port}`)}),t.username&&e.jsxs("div",{style:{color:"#666",fontSize:14},children:["User: ",o(t.username)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:16,borderTop:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{textAlign:"center",flex:1},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#1890ff"},children:t.process_count||0}),e.jsx("div",{style:{fontSize:12,color:"#999"},children:"Processes"})]}),e.jsx("div",{style:{textAlign:"center",flex:1,borderLeft:"1px solid #f0f0f0"},children:e.jsx(z,{icon:r?e.jsx(re,{}):e.jsx(ne,{}),color:r?"success":"error",children:r?"Online":"Offline"})})]}),e.jsx(k,{type:"primary",block:!0,icon:e.jsx(zt,{}),onClick:a=>{a.stopPropagation(),s()},children:"View Details"})]})})}class Pt extends x.Component{constructor(n){super(n);_t(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r),this.props.onError&&this.props.onError(n,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx(Cs,{status:"error",title:"Something went wrong",subTitle:"An unexpected error occurred while rendering this component.",extra:[e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:this.handleRetry,children:"Try Again"},"retry"),e.jsx(k,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")],children:!1}):this.props.children}}const{Text:Ze}=ct,{Search:ma}=M,{Option:Oe}=H,dn=({visible:t,onClose:s,nodeName:n,processName:r})=>{const[o,a]=x.useState([]),[i,c]=x.useState(!1),[d,f]=x.useState(!1),[u,y]=x.useState(0),[_,b]=x.useState(""),[l,m]=x.useState(""),[p,h]=x.useState(!0),v=x.useRef(null),S=x.useRef(!1),{send:P,isConnected:R}=Se({onMessage:I=>{if(I.type==="log_stream"&&I.data){const F=I.data;F.node_name===n&&F.process_name===r&&w(F.entries)}}}),w=x.useCallback(I=>{I.length>0&&(a(F=>{const D=new Set(F.map(V=>`${V.timestamp}|${V.message}`)),he=I.filter(V=>!D.has(`${V.timestamp}|${V.message}`));return he.length===0?F:[...F,...he].slice(-1e3)}),p&&v.current&&setTimeout(()=>{var F;(F=v.current)==null||F.scrollTo({top:v.current.scrollHeight,behavior:"smooth"})},100))},[p]),j=async()=>{c(!0);try{const F=(await se.getProcessLogStream(n,r,0,100)).data;a(F.entries||[]),y(F.last_offset||0)}catch(I){console.error("Failed to load logs:",I),E.error("Failed to load logs")}finally{c(!1)}},C=()=>{R&&!S.current&&(P({type:"subscribe_logs",data:{node_name:n,process_name:r}}),S.current=!0)},L=()=>{R&&S.current&&(P({type:"unsubscribe_logs",data:{node_name:n,process_name:r}}),S.current=!1)},q=I=>{f(I),I?C():L()},ae=()=>{a([]),y(0)},Q=()=>{const F=ee().map(V=>`[${V.timestamp}] [${V.level}] ${V.message}`).join(`
`),D=new Blob([F],{type:"text/plain"}),he=URL.createObjectURL(D),pe=document.createElement("a");pe.href=he,pe.download=`${n}-${r}-logs.txt`,document.body.appendChild(pe),pe.click(),document.body.removeChild(pe),URL.revokeObjectURL(he)},ce=I=>{switch(I.toUpperCase()){case"ERROR":return"red";case"WARN":case"WARNING":return"orange";case"INFO":return"blue";case"DEBUG":return"green";case"TRACE":return"purple";default:return"default"}},ee=()=>o.filter(I=>{const F=!_||I.message.toLowerCase().includes(_.toLowerCase()),D=!l||I.level.toLowerCase()===l.toLowerCase();return F&&D});x.useEffect(()=>{t?j():(L(),f(!1),a([]),y(0))},[t]),x.useEffect(()=>()=>{L()},[]);const A=ee();return e.jsxs(dt,{title:e.jsxs(O,{children:[e.jsxs("span",{children:["Logs: ",r," on ",n]}),e.jsx(z,{color:d?"green":"default",children:d?"Live":"Static"})]}),open:t,onCancel:s,width:1e3,footer:[e.jsx(k,{onClick:s,children:"Close"},"close")],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(O,{wrap:!0,children:[e.jsxs(O,{children:[e.jsx(Ze,{children:"Real-time:"}),e.jsx(Y,{checked:d,onChange:q,disabled:!R,checkedChildren:e.jsx(xe,{}),unCheckedChildren:e.jsx(kn,{})})]}),e.jsxs(O,{children:[e.jsx(Ze,{children:"Auto-scroll:"}),e.jsx(Y,{checked:p,onChange:h,size:"small"})]}),e.jsx(ma,{placeholder:"Search logs...",value:_,onChange:I=>b(I.target.value),style:{width:200},prefix:e.jsx(Re,{}),allowClear:!0}),e.jsxs(H,{placeholder:"Filter by level",value:l,onChange:m,style:{width:120},allowClear:!0,children:[e.jsx(Oe,{value:"error",children:"Error"}),e.jsx(Oe,{value:"warn",children:"Warning"}),e.jsx(Oe,{value:"info",children:"Info"}),e.jsx(Oe,{value:"debug",children:"Debug"}),e.jsx(Oe,{value:"trace",children:"Trace"})]}),e.jsx(k,{icon:e.jsx(_s,{}),onClick:ae,size:"small",children:"Clear"}),e.jsx(k,{icon:e.jsx(ks,{}),onClick:Q,size:"small",children:"Export"})]})}),e.jsx("div",{ref:v,style:{height:500,overflow:"auto",border:"1px solid #d9d9d9",borderRadius:4,padding:8,backgroundColor:"#fafafa"},children:i?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ie,{size:"large"})}):e.jsx(Jt,{dataSource:A,renderItem:(I,F)=>e.jsx(Jt.Item,{style:{padding:"4px 0",borderBottom:"none",fontFamily:"monospace",fontSize:"12px"},children:e.jsxs(O,{size:"small",children:[e.jsx(Ze,{type:"secondary",style:{minWidth:80},children:new Date(I.timestamp).toLocaleTimeString()}),e.jsx(z,{color:ce(I.level),style:{minWidth:60,textAlign:"center"},children:I.level.toUpperCase()}),e.jsx(Ze,{style:{wordBreak:"break-all"},children:I.message})]})},F),locale:{emptyText:"No log entries found"}})}),e.jsxs("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:["Showing ",A.length," of ",o.length," entries",d&&R&&e.jsx("span",{style:{marginLeft:16,color:"#52c41a"},children:"● Connected - receiving real-time updates"})]})]})};function ga(t,s=!1){const n=x.useRef(0),[r,o]=x.useState({renderTime:0,componentCount:0});return x.useEffect(()=>{s&&(n.current=performance.now())}),x.useEffect(()=>{var d;if(!s)return;const a=performance.now()-n.current,i=(d=performance.memory)==null?void 0:d.usedJSHeapSize,c={renderTime:a,memoryUsage:i,componentCount:r.componentCount+1};o(c)}),r}function xa(t,s=1e3){const[n,r]=x.useState(!1),[o,a]=x.useState([]);return x.useEffect(()=>{const i=t>=s;r(i);const c=[];t>=100&&c.push("Consider using virtualization for better performance"),t>=500&&c.push("Enable pagination to reduce initial load time"),t>=1e3&&c.push("Implement server-side filtering and pagination"),a(c)},[t,s]),{shouldOptimize:n,recommendations:o,itemCount:t}}function ya(){const t=fe(),{nodes:s,setNodes:n}=ye(),[r,o]=x.useState(!1),a=na();ga("NodeList",!1);const{shouldOptimize:i,recommendations:c}=xa(s.length),[d,f]=Qo("nodes-view-mode","card"),[u,y]=x.useState(""),[_,b]=x.useState({}),[l,m]=x.useState([]),p=a?"list":d,{filteredNodes:h,availableEnvironments:v,stats:S}=ta(s,u,_);x.useEffect(()=>{P()},[]);const P=async()=>{var w;o(!0);try{const j=await se.getNodes();n(((w=j.data)==null?void 0:w.nodes)||[])}catch(j){console.error("Failed to load nodes:",j),E.error("Failed to load nodes")}finally{o(!1)}};Se({onMessage:w=>{w.type==="nodes_update"&&n(w.data)}});const R=async w=>{try{switch(w.type){case"refresh_all":E.info(`Refreshing ${w.nodeIds.length} nodes...`);break;case"restart_all":E.info(`Restarting all processes on ${w.nodeIds.length} nodes...`);break;case"start_all":E.info(`Starting all processes on ${w.nodeIds.length} nodes...`);break;case"stop_all":E.info(`Stopping all processes on ${w.nodeIds.length} nodes...`);break;case"delete_selected":E.warning("Node deletion not implemented yet");break}m([])}catch(j){console.error("Bulk action failed:",j),E.error("Bulk action failed")}};return r&&s.length===0?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ie,{size:"large"})}):e.jsx(Pt,{children:e.jsxs("div",{children:[e.jsx(da,{viewMode:p,onViewModeChange:f,searchQuery:u,onSearchChange:y,filters:_,onFiltersChange:b,environments:v,totalNodes:S.total,filteredNodes:S.filtered,selectedNodes:l,onBulkAction:R,onRefreshAll:P,loading:r,isMobile:a}),i&&c.length>0&&!1,h.length===0?e.jsx(U,{children:e.jsx(Ue,{description:S.total===0?"No nodes configured":"No nodes match your search criteria",image:Ue.PRESENTED_IMAGE_SIMPLE,children:S.total===0?e.jsx("p",{style:{color:"#999"},children:"Add nodes in your config.toml file"}):e.jsx(k,{onClick:()=>{y(""),b({})},children:"Clear filters"})})}):p==="list"?e.jsx(Pt,{fallback:e.jsx("div",{style:{padding:20,textAlign:"center"},children:e.jsx("p",{children:"Failed to load list view. Please try refreshing the page."})}),children:e.jsx(ca,{nodes:h,loading:r,selectedNodes:l,onSelectionChange:m,onNodeClick:w=>t(`/nodes/${w}`),onRefreshNode:w=>{E.info(`Refreshing node: ${w}`)},searchQuery:u})}):e.jsx(Pt,{fallback:e.jsx("div",{style:{padding:20,textAlign:"center"},children:e.jsx("p",{children:"Failed to load card view. Please try refreshing the page."})}),children:e.jsx(ha,{nodes:h,onNodeClick:w=>t(`/nodes/${w}`),searchQuery:u})})]})})}const ja=()=>{const{nodeName:t}=Ts(),s=fe(),[n,r]=x.useState(null),[o,a]=x.useState([]),[i,c]=x.useState(!0),[d,f]=x.useState({}),[u,y]=x.useState(!1),[_,b]=x.useState(null);x.useEffect(()=>{t&&l()},[t]);const l=async()=>{var w;if(t){c(!0);try{const C=(w=(await se.getNodes()).nodes)==null?void 0:w.find(L=>L.name===t);if(C){if(r(C),C.is_connected){const L=await se.getNodeProcesses(t);a(L.processes||[])}}else E.error("Node not found"),s("/nodes")}catch(j){console.error("Failed to load node detail:",j),E.error("Failed to load node detail")}finally{c(!1)}}},m=async(w,j)=>{if(!t)return;const C=`${w}-${j}`;f(L=>({...L,[C]:!0}));try{switch(j){case"start":await se.startProcess(t,w),E.success(`Started ${w}`);break;case"stop":await se.stopProcess(t,w),E.success(`Stopped ${w}`);break;case"restart":await se.restartProcess(t,w),E.success(`Restarted ${w}`);break}await l()}catch(L){console.error(`Failed to ${j} process:`,L),E.error(`Failed to ${j} process`)}finally{f(L=>({...L,[C]:!1}))}},p=w=>{b(w),y(!0)},h=w=>{switch(w){case 20:return"success";case 0:return"default";case 10:return"processing";case 30:return"warning";case 100:return"error";default:return"default"}},v=[{title:"Name",dataIndex:"name",key:"name",render:w=>e.jsx("strong",{children:w})},{title:"Group",dataIndex:"group",key:"group"},{title:"State",dataIndex:"state_string",key:"state_string",render:(w,j)=>e.jsx(z,{color:h(j.state),children:w})},{title:"PID",dataIndex:"pid",key:"pid",render:w=>w||"-"},{title:"Uptime",dataIndex:"uptime_human",key:"uptime_human",render:w=>w||"-"},{title:"Actions",key:"actions",render:(w,j)=>e.jsxs(O,{children:[j.state!==20&&e.jsx(k,{type:"primary",size:"small",icon:e.jsx(xe,{}),onClick:()=>m(j.name,"start"),loading:d[`${j.name}-start`],children:"Start"}),j.state===20&&e.jsx(Be,{title:"Stop this process?",onConfirm:()=>m(j.name,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(k,{size:"small",icon:e.jsx(Ae,{}),loading:d[`${j.name}-stop`],danger:!0,children:"Stop"})}),e.jsx(k,{size:"small",icon:e.jsx(K,{}),onClick:()=>m(j.name,"restart"),loading:d[`${j.name}-restart`],children:"Restart"}),e.jsx(k,{size:"small",icon:e.jsx(Nt,{}),onClick:()=>p(j),children:"Logs"})]})}];if(i)return e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(Ie,{size:"large"})});if(!n)return e.jsx("div",{children:"Node not found"});const S=o.filter(w=>w.state===20).length,P=o.filter(w=>w.state===0).length,R=o.length;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(O,{children:[e.jsx(k,{icon:e.jsx(Es,{}),onClick:()=>s("/nodes"),children:"Back"}),e.jsxs("h1",{style:{margin:0},children:["Node: ",n.name]}),n.is_connected?e.jsx(z,{icon:e.jsx(re,{}),color:"success",children:"Connected"}):e.jsx(z,{icon:e.jsx(ne,{}),color:"error",children:"Disconnected"})]}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:l,loading:i,children:"Refresh"})]}),e.jsxs(De,{gutter:16,style:{marginBottom:24},children:[e.jsx(te,{xs:24,sm:8,children:e.jsx(U,{children:e.jsx(le,{title:"Total Processes",value:R,prefix:e.jsx(at,{})})})}),e.jsx(te,{xs:24,sm:8,children:e.jsx(U,{children:e.jsx(le,{title:"Running",value:S,prefix:e.jsx(xe,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(te,{xs:24,sm:8,children:e.jsx(U,{children:e.jsx(le,{title:"Stopped",value:P,prefix:e.jsx(Ae,{}),valueStyle:{color:"#ff4d4f"}})})})]}),e.jsx(Rs,{defaultActiveKey:"processes",items:[{key:"processes",label:"Processes",children:e.jsx(U,{children:e.jsx(ue,{columns:v,dataSource:o,rowKey:"name",pagination:{pageSize:10},scroll:{x:800}})})},{key:"info",label:"Node Information",children:e.jsx(U,{children:e.jsxs(me,{bordered:!0,column:2,children:[e.jsx(me.Item,{label:"Name",children:n.name}),e.jsx(me.Item,{label:"Host",children:n.host}),e.jsx(me.Item,{label:"Port",children:n.port}),e.jsx(me.Item,{label:"Environment",children:e.jsx(z,{color:n.environment==="production"?"red":"blue",children:n.environment||"development"})}),e.jsx(me.Item,{label:"Username",children:n.username}),e.jsx(me.Item,{label:"Status",children:e.jsx(z,{color:n.is_connected?"success":"error",children:n.is_connected?"Connected":"Disconnected"})}),e.jsx(me.Item,{label:"Last Ping",span:2,children:n.last_ping?new Date(n.last_ping).toLocaleString():"-"})]})})}]}),_&&e.jsx(dn,{visible:u,onClose:()=>{y(!1),b(null)},nodeName:t||"",processName:_.name})]})},Qe={getAggregated:()=>N.get("/processes/aggregated"),batchStart:t=>N.post(`/processes/${t}/start`),batchStop:t=>N.post(`/processes/${t}/stop`),batchRestart:t=>N.post(`/processes/${t}/restart`)},wa=({instances:t,processName:s,onRefresh:n})=>{const[r,o]=x.useState({}),[a,i]=x.useState(!1),[c,d]=x.useState(null),f=b=>{switch(b){case 20:return"success";case 0:return"default";case 10:return"processing";case 30:return"warning";case 100:return"error";default:return"default"}},u=async(b,l)=>{const m=`${b.node_name}-${s}-${l}`;o(p=>({...p,[m]:!0}));try{switch(l){case"start":await se.startProcess(b.node_name,s),E.success(`Started ${s} on ${b.node_name}`);break;case"stop":await se.stopProcess(b.node_name,s),E.success(`Stopped ${s} on ${b.node_name}`);break;case"restart":await se.restartProcess(b.node_name,s),E.success(`Restarted ${s} on ${b.node_name}`);break}n()}catch(p){console.error(`Failed to ${l} process:`,p),E.error(`Failed to ${l} process on ${b.node_name}`)}finally{o(p=>({...p,[m]:!1}))}},y=b=>{d(b),i(!0)},_=[{title:"Node",dataIndex:"node_name",key:"node_name",render:(b,l)=>e.jsxs("div",{children:[e.jsx("strong",{children:b}),e.jsx("br",{}),e.jsxs("small",{style:{color:"#888"},children:[l.node_host,":",l.node_port]})]})},{title:"State",dataIndex:"state_string",key:"state_string",render:(b,l)=>e.jsx(z,{color:f(l.state),children:b})},{title:"PID",dataIndex:"pid",key:"pid",render:b=>b||"-"},{title:"Uptime",dataIndex:"uptime_human",key:"uptime_human",render:b=>b||"-"},{title:"Group",dataIndex:"group",key:"group"},{title:"Actions",key:"actions",render:(b,l)=>e.jsxs(O,{children:[l.state!==20&&e.jsx(k,{type:"primary",size:"small",icon:e.jsx(xe,{}),onClick:()=>u(l,"start"),loading:r[`${l.node_name}-${s}-start`],children:"Start"}),l.state===20&&e.jsx(Be,{title:"Stop this process?",onConfirm:()=>u(l,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(k,{size:"small",icon:e.jsx(Ae,{}),loading:r[`${l.node_name}-${s}-stop`],danger:!0,children:"Stop"})}),e.jsx(k,{size:"small",icon:e.jsx(K,{}),onClick:()=>u(l,"restart"),loading:r[`${l.node_name}-${s}-restart`],children:"Restart"}),e.jsx(k,{size:"small",icon:e.jsx(Nt,{}),onClick:()=>y(l),children:"Logs"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(ue,{columns:_,dataSource:t,rowKey:b=>`${b.node_name}-${s}`,pagination:!1,size:"small"}),c&&e.jsx(dn,{visible:a,onClose:()=>{i(!1),d(null)},nodeName:c.node_name,processName:s})]})},{Search:ba}=M,va=()=>{const[t,s]=x.useState([]),[n,r]=x.useState([]),[o,a]=x.useState(!0),[i,c]=x.useState(""),[d,f]=x.useState({});x.useEffect(()=>{u()},[]),x.useEffect(()=>{y()},[i,t]),Se({onMessage:l=>{(l.type==="process_status_change"||l.type==="node_status_change"||l.type==="nodes_update")&&u()}});const u=async()=>{a(!0);try{const l=await Qe.getAggregated();s(l.processes||[])}catch(l){console.error("Failed to load processes:",l),E.error("Failed to load processes")}finally{a(!1)}},y=()=>{if(!i.trim()){r(t);return}const l=t.filter(m=>m.name.toLowerCase().includes(i.toLowerCase()));r(l)},_=l=>{c(l)},b=async(l,m)=>{const p=`${l}-${m}`;f(h=>({...h,[p]:!0}));try{let h;switch(m){case"start":h=await Qe.batchStart(l);break;case"stop":h=await Qe.batchStop(l);break;case"restart":h=await Qe.batchRestart(l);break}const v=h.result;v.failure_count===0?E.success(`Successfully ${m}ed ${v.success_count} instance(s) of ${l}`):dt.warning({title:`Batch ${m} completed with errors`,content:e.jsxs("div",{children:[e.jsxs("p",{children:["Success: ",v.success_count," / ",v.total_instances]}),e.jsxs("p",{children:["Failed: ",v.failure_count]}),v.results.filter(S=>!S.success).map((S,P)=>e.jsxs("div",{children:[e.jsxs("strong",{children:[S.node_name,":"]})," ",S.error]},P))]})}),await u()}catch(h){console.error(`Failed to ${m} process:`,h),E.error(`Failed to ${m} process`)}finally{f(h=>({...h,[p]:!1}))}};return o?e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(Ie,{size:"large"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Processes"}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:u,loading:o,children:"Refresh"})]}),e.jsx(U,{style:{marginBottom:16},children:e.jsx(ba,{placeholder:"Search processes by name...",allowClear:!0,enterButton:e.jsx(Re,{}),size:"large",onSearch:_,onChange:l=>_(l.target.value),value:i})}),n.length===0?e.jsx(U,{children:e.jsx(Ue,{description:i?`No processes found matching "${i}"`:"No processes available"})}):e.jsx(O,{direction:"vertical",size:"middle",style:{width:"100%"},children:n.map(l=>e.jsxs(U,{title:e.jsxs(O,{children:[e.jsx("strong",{children:l.name}),e.jsxs(z,{color:"blue",children:[l.total_instances," instances"]})]}),extra:e.jsxs(O,{children:[e.jsx(k,{type:"primary",size:"small",icon:e.jsx(xe,{}),onClick:()=>b(l.name,"start"),loading:d[`${l.name}-start`],disabled:l.running_instances===l.total_instances,children:"Start All"}),e.jsx(Be,{title:"Stop all instances?",description:`This will stop all ${l.total_instances} instance(s) of ${l.name}`,onConfirm:()=>b(l.name,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(k,{size:"small",icon:e.jsx(Ae,{}),loading:d[`${l.name}-stop`],disabled:l.running_instances===0,danger:!0,children:"Stop All"})}),e.jsx(k,{size:"small",icon:e.jsx(K,{}),onClick:()=>b(l.name,"restart"),loading:d[`${l.name}-restart`],children:"Restart All"})]}),children:[e.jsxs(De,{gutter:16,style:{marginBottom:16},children:[e.jsx(te,{xs:24,sm:8,children:e.jsx(le,{title:"Total Instances",value:l.total_instances,prefix:e.jsx(at,{})})}),e.jsx(te,{xs:24,sm:8,children:e.jsx(le,{title:"Running",value:l.running_instances,prefix:e.jsx(xe,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(te,{xs:24,sm:8,children:e.jsx(le,{title:"Stopped",value:l.stopped_instances,prefix:e.jsx(Ae,{}),valueStyle:{color:"#ff4d4f"}})})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("strong",{children:"Nodes:"})," ",l.instances.map((m,p)=>e.jsx(z,{color:"default",children:m.node_name},p))]}),e.jsx(En,{items:[{key:"1",label:"Instance Details",children:e.jsx(wa,{instances:l.instances,processName:l.name,onRefresh:u})}]})]},l.name))})]})},un={getEnvironments:()=>N.get("/environments"),getEnvironmentDetail:t=>N.get(`/environments/${t}`)};function Sa({environment:t,onClick:s}){const n=t.members.length,r=t.members.filter(a=>a.is_connected).length,o=n-r;return e.jsx(U,{hoverable:!0,style:{height:"100%",cursor:"pointer"},onClick:s,children:e.jsxs(O,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:8,background:"#52c41a20",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ot,{style:{fontSize:24,color:"#52c41a"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:t.name}),e.jsxs("p",{style:{margin:0,color:"#999",fontSize:14},children:[n," ",n===1?"node":"nodes"]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",paddingTop:16,borderTop:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#52c41a"},children:r}),e.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:[e.jsx(re,{style:{marginRight:4}}),"Online"]})]}),e.jsx("div",{style:{width:1,background:"#f0f0f0"}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#ff4d4f"},children:o}),e.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:[e.jsx(ne,{style:{marginRight:4}}),"Offline"]})]})]}),e.jsx("div",{style:{textAlign:"center"},children:r===n?e.jsx(z,{color:"success",style:{margin:0},children:"All nodes online"}):r===0?e.jsx(z,{color:"error",style:{margin:0},children:"All nodes offline"}):e.jsx(z,{color:"warning",style:{margin:0},children:"Partial connectivity"})})]})})}function _a(){const t=fe(),[s,n]=x.useState([]),[r,o]=x.useState(!1);x.useEffect(()=>{a()},[]);const a=async()=>{o(!0);try{const i=await un.getEnvironments();console.log("Environments API response:",i),n(i.environments||[])}catch(i){console.error("Failed to load environments:",i),E.error("Failed to load environments. Please try again.")}finally{o(!1)}};return Se({onMessage:i=>{(i.type==="nodes_update"||i.type==="node_status_change")&&a()}}),r&&s.length===0?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ie,{size:"large"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:24},children:"Environments"}),e.jsx("p",{style:{color:"#666",marginTop:8},children:"Manage nodes by environment"})]}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:a,loading:r,children:"Refresh"})]}),s.length===0?e.jsx(U,{children:e.jsx(Ue,{description:"No environments configured",image:Ue.PRESENTED_IMAGE_SIMPLE,children:e.jsx("p",{style:{color:"#999"},children:"Add nodes with environment labels in your config.toml file"})})}):e.jsx(De,{gutter:[16,16],children:s.map(i=>e.jsx(te,{xs:24,sm:12,lg:8,children:e.jsx(Sa,{environment:i,onClick:()=>t(`/environments/${i.name}`)})},i.name))})]})}function Ca(){const{environmentName:t}=Ts(),s=fe(),[n,r]=x.useState(null),[o,a]=x.useState(!1),[i,c]=x.useState(null),[d,f]=x.useState("all");x.useEffect(()=>{t&&u()},[t]);const u=async()=>{var l;if(t){a(!0),c(null);try{const m=await un.getEnvironmentDetail(t);console.log("Environment detail API response:",m),m.environment?r(m.environment):c("Environment not found")}catch(m){console.error("Failed to load environment detail:",m),((l=m.response)==null?void 0:l.status)===404?c("Environment not found"):E.error("Failed to load environment details. Please try again.")}finally{a(!1)}}};Se({onMessage:l=>{(l.type==="nodes_update"||l.type==="node_status_change")&&u()}});const y=x.useMemo(()=>{if(!n)return[];switch(d){case"online":return n.members.filter(l=>l.is_connected);case"offline":return n.members.filter(l=>!l.is_connected);default:return n.members}},[n,d]),_=l=>{f(l.target.value)},b=[{title:"Node Name",dataIndex:"name",key:"name",render:l=>e.jsx("a",{onClick:m=>{m.preventDefault(),s(`/nodes/${l}`)},style:{fontWeight:500},children:l})},{title:"Host",dataIndex:"host",key:"host"},{title:"Port",dataIndex:"port",key:"port"},{title:"Status",dataIndex:"is_connected",key:"status",render:l=>e.jsx(z,{icon:l?e.jsx(re,{}):e.jsx(ne,{}),color:l?"success":"error",children:l?"Online":"Offline"})},{title:"Processes",dataIndex:"processes",key:"processes",render:l=>l||0},{title:"Last Ping",dataIndex:"last_ping",key:"last_ping",render:l=>l?new Date(l).toLocaleString():"-"}];return o&&!n?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ie,{size:"large"})}):i?e.jsx(Cs,{status:"404",title:"Environment Not Found",subTitle:`The environment "${t}" does not exist.`,extra:e.jsx(k,{type:"primary",onClick:()=>s("/environments"),children:"Back to Environments"})}):n?e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs(O,{children:[e.jsx(k,{icon:e.jsx(Es,{}),onClick:()=>s("/environments"),children:"Back"}),e.jsxs("h2",{style:{margin:0,fontSize:24},children:["Environment: ",n.name]})]}),e.jsxs("p",{style:{color:"#666",marginTop:8,marginLeft:40},children:[n.members.length," ",n.members.length===1?"node":"nodes"," in this environment"]})]}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:u,loading:o,children:"Refresh"})]}),e.jsx(U,{children:n.members.length===0?e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("p",{style:{color:"#999",fontSize:16},children:"No nodes found in this environment"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs(Ye.Group,{value:d,onChange:_,children:[e.jsxs(Ye.Button,{value:"all",children:["All (",n.members.length,")"]}),e.jsxs(Ye.Button,{value:"online",children:[e.jsx(re,{style:{color:"#52c41a"}})," Online (",n.members.filter(l=>l.is_connected).length,")"]}),e.jsxs(Ye.Button,{value:"offline",children:[e.jsx(ne,{style:{color:"#ff4d4f"}})," Offline (",n.members.filter(l=>!l.is_connected).length,")"]})]})}),e.jsx(ue,{columns:b,dataSource:y,rowKey:"name",pagination:!1,loading:o})]})})]}):null}const Fe={getUsers:async(t=1,s=20)=>N.get(`/users?page=${t}&page_size=${s}`),getUser:async t=>N.get(`/users/${t}`),createUser:async t=>N.post("/users",t),updateUser:async(t,s)=>N.put(`/users/${t}`,s),deleteUser:async t=>N.delete(`/users/${t}`),toggleUserStatus:async(t,s)=>N.patch(`/users/${t}/toggle`,{is_active:s})},ka=()=>{const[t,s]=x.useState([]),[n,r]=x.useState(!0),[o,a]=x.useState(!1),[i,c]=x.useState(null),[d,f]=x.useState(0),[u,y]=x.useState(1),[_,b]=x.useState(20),[l]=T.useForm();x.useEffect(()=>{m()},[u,_]);const m=async()=>{r(!0);try{const w=await Fe.getUsers(u,_);w!=null&&w.data&&(s(w.data.users||[]),f(w.data.total||0))}catch(w){console.error("Failed to load users:",w),E.error("Failed to load users")}finally{r(!1)}},p=()=>{c(null),l.resetFields(),a(!0)},h=w=>{c(w),l.setFieldsValue({username:w.username,email:w.email,full_name:w.full_name,is_admin:w.is_admin,is_active:w.is_active}),a(!0)},v=async w=>{var j,C;try{await Fe.deleteUser(w),E.success("User deleted successfully"),m()}catch(L){E.error(((C=(j=L.response)==null?void 0:j.data)==null?void 0:C.message)||"Failed to delete user")}},S=async(w,j)=>{var C,L;try{await Fe.toggleUserStatus(w,j),E.success(`User ${j?"activated":"deactivated"} successfully`),m()}catch(q){E.error(((L=(C=q.response)==null?void 0:C.data)==null?void 0:L.message)||"Failed to update user status")}},P=async()=>{var w,j;try{const C=await l.validateFields();if(i){const L={email:C.email,full_name:C.full_name,is_admin:C.is_admin,is_active:C.is_active};await Fe.updateUser(i.id,L),E.success("User updated successfully")}else{const L={username:C.username,email:C.email,password:C.password,full_name:C.full_name,is_admin:C.is_admin||!1};await Fe.createUser(L),E.success("User created successfully")}a(!1),m()}catch(C){console.error("Operation failed:",C),E.error(((j=(w=C.response)==null?void 0:w.data)==null?void 0:j.message)||"Operation failed")}},R=[{title:"User",key:"user",render:(w,j)=>e.jsxs(O,{children:[e.jsx(Ss,{icon:e.jsx(be,{})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:j.username}),e.jsx("div",{style:{fontSize:"12px",color:"#999"},children:j.email})]})]})},{title:"Full Name",dataIndex:"full_name",key:"full_name",render:w=>w||"-"},{title:"Role",dataIndex:"is_admin",key:"role",render:w=>e.jsx(z,{color:w?"red":"blue",children:w?"Admin":"User"})},{title:"Status",dataIndex:"is_active",key:"status",render:(w,j)=>e.jsx(Y,{checked:w,onChange:C=>S(j.id,C),checkedChildren:"Active",unCheckedChildren:"Inactive"})},{title:"Last Login",dataIndex:"last_login",key:"last_login",render:w=>w?new Date(w).toLocaleString():"Never"},{title:"Created",dataIndex:"created_at",key:"created_at",render:w=>new Date(w).toLocaleDateString()},{title:"Actions",key:"actions",render:(w,j)=>e.jsxs(O,{children:[e.jsx(k,{type:"link",icon:e.jsx(Ps,{}),onClick:()=>h(j),children:"Edit"}),e.jsx(Be,{title:"Delete user",description:"Are you sure you want to delete this user?",onConfirm:()=>v(j.id),okText:"Yes",cancelText:"No",disabled:j.is_admin,children:e.jsx(k,{type:"link",danger:!0,icon:e.jsx(Ut,{}),disabled:j.is_admin,children:"Delete"})})]})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(U,{title:"User Management",extra:e.jsxs(O,{children:[e.jsx(k,{icon:e.jsx(K,{}),onClick:m,loading:n,children:"Refresh"}),e.jsx(k,{type:"primary",icon:e.jsx(Rn,{}),onClick:p,children:"Add User"})]}),children:e.jsx(ue,{columns:R,dataSource:t,rowKey:"id",loading:n,pagination:{current:u,pageSize:_,total:d,showSizeChanger:!0,showTotal:w=>`Total ${w} users`,onChange:(w,j)=>{y(w),b(j)}}})}),e.jsx(dt,{title:i?"Edit User":"Create User",open:o,onOk:P,onCancel:()=>a(!1),width:600,children:e.jsxs(T,{form:l,layout:"vertical",initialValues:{is_admin:!1,is_active:!0},children:[e.jsx(T.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter username"},{min:3,max:50,message:"Username must be 3-50 characters"}],children:e.jsx(M,{prefix:e.jsx(be,{}),placeholder:"Username",disabled:!!i})}),e.jsx(T.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter valid email"}],children:e.jsx(M,{prefix:e.jsx(As,{}),placeholder:"Email"})}),e.jsx(T.Item,{name:"full_name",label:"Full Name",children:e.jsx(M,{placeholder:"Full Name (optional)"})}),!i&&e.jsx(T.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(M.Password,{prefix:e.jsx(ke,{}),placeholder:"Password"})}),e.jsx(T.Item,{name:"is_admin",label:"Role",valuePropName:"checked",children:e.jsx(Y,{checkedChildren:"Admin",unCheckedChildren:"User"})}),i&&e.jsx(T.Item,{name:"is_active",label:"Status",valuePropName:"checked",children:e.jsx(Y,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})})]})},{Search:Ea}=M,Ra=()=>{const t=fe(),[s,n]=x.useState([]),[r,o]=x.useState(!0),[a,i]=x.useState(""),[c,d]=x.useState("all"),[f,u]=x.useState("active");Se(j=>{(j.type==="alert_created"||j.type==="alert_updated"||j.type==="alert_resolved")&&y()}),x.useEffect(()=>{y()},[c,f,a]);const y=async()=>{o(!0);try{const j=new URLSearchParams;c!=="all"&&j.append("severity",c),f!=="all"&&j.append("status",f),a&&j.append("search",a);const C=await fetch(`/api/alerts?${j.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!C.ok)throw new Error("Failed to fetch alerts");const L=await C.json();n(L.data||[])}catch(j){console.error("Failed to load alerts:",j),E.error("Failed to load alerts")}finally{o(!1)}},_=j=>{switch(j){case"critical":return"red";case"error":return"orange";case"warning":return"gold";case"info":return"blue";default:return"default"}},b=j=>{switch(j){case"critical":return e.jsx(ne,{});case"error":return e.jsx(ne,{});case"warning":return e.jsx(Yt,{});case"info":return e.jsx(at,{});default:return e.jsx(at,{})}},l=j=>{switch(j){case"active":return"error";case"acknowledged":return"warning";case"resolved":return"success";default:return"default"}},m=async j=>{try{if(!(await fetch(`/api/alerts/${j}/acknowledge`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to acknowledge alert");E.success("Alert acknowledged successfully"),y()}catch(C){console.error("Failed to acknowledge alert:",C),E.error("Failed to acknowledge alert")}},p=async j=>{try{if(!(await fetch(`/api/alerts/${j}/resolve`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to resolve alert");E.success("Alert resolved successfully"),y()}catch(C){console.error("Failed to resolve alert:",C),E.error("Failed to resolve alert")}},h=s.filter(j=>{const C=j.node_name.toLowerCase().includes(a.toLowerCase())||j.process_name&&j.process_name.toLowerCase().includes(a.toLowerCase())||j.message.toLowerCase().includes(a.toLowerCase()),L=c==="all"||j.severity===c,q=f==="all"||j.status===f;return C&&L&&q}),v=f==="resolved"||f==="all"?(()=>{const j=new Map;return h.forEach(C=>{const L=`${C.node_name}-${C.alert_type||"unknown"}`,q=j.get(L);(!q||new Date(C.created_at)>new Date(q.created_at))&&j.set(L,C)}),Array.from(j.values()).sort((C,L)=>new Date(L.created_at).getTime()-new Date(C.created_at).getTime())})():h,S=[{title:"Severity",dataIndex:"severity",key:"severity",width:120,render:j=>e.jsx(z,{icon:b(j),color:_(j),children:j.toUpperCase()})},{title:"Message",dataIndex:"message",key:"message",ellipsis:!0},{title:"Status",dataIndex:"status",key:"status",width:120,render:j=>e.jsx(z,{color:l(j),children:j.toUpperCase()})},{title:"Created",dataIndex:"start_time",key:"start_time",width:180,render:j=>new Date(j).toLocaleString()},{title:"Actions",key:"actions",width:200,render:(j,C)=>e.jsxs(O,{children:[C.status==="active"&&e.jsx(k,{size:"small",onClick:()=>m(C.id),children:"Acknowledge"}),C.status!=="resolved"&&e.jsx(k,{size:"small",type:"primary",onClick:()=>p(C.id),children:"Resolve"})]})}],P=s.filter(j=>j.status==="active").length,R=s.filter(j=>j.status==="acknowledged").length,w=s.filter(j=>j.status==="resolved").length;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(O,{children:[e.jsx("h1",{style:{margin:0},children:"Alerts"}),e.jsx(vs,{count:P,style:{backgroundColor:"#ff4d4f"}})]}),e.jsxs(O,{children:[e.jsx(k,{onClick:()=>t("/alerts/rules"),children:"Alert Rules"}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:y,loading:r,children:"Refresh"})]})]}),e.jsxs(O,{style:{marginBottom:16,width:"100%"},size:"large",children:[e.jsx(U,{size:"small",children:e.jsxs(O,{children:[e.jsx(ne,{style:{fontSize:24,color:"#ff4d4f"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Active"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:P})]})]})}),e.jsx(U,{size:"small",children:e.jsxs(O,{children:[e.jsx(Yt,{style:{fontSize:24,color:"#faad14"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Acknowledged"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:R})]})]})}),e.jsx(U,{size:"small",children:e.jsxs(O,{children:[e.jsx(re,{style:{fontSize:24,color:"#52c41a"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Resolved"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:w})]})]})})]}),e.jsx(U,{style:{marginBottom:16},children:e.jsxs(O,{wrap:!0,children:[e.jsx(Ea,{placeholder:"Search alerts...",allowClear:!0,style:{width:300},onChange:j=>i(j.target.value),prefix:e.jsx(Re,{})}),e.jsx(H,{style:{width:150},value:c,onChange:d,options:[{label:"All Severities",value:"all"},{label:"Critical",value:"critical"},{label:"Error",value:"error"},{label:"Warning",value:"warning"},{label:"Info",value:"info"}]}),e.jsx(H,{style:{width:180},value:f,onChange:u,options:[{label:"Active Only",value:"active"},{label:"Acknowledged",value:"acknowledged"},{label:"Resolved",value:"resolved"},{label:"All Status",value:"all"}]})]})}),e.jsx(U,{children:e.jsx(ue,{columns:S,dataSource:v,rowKey:"id",loading:r,pagination:{pageSize:20,showSizeChanger:!0,showQuickJumper:!0,showTotal:(j,C)=>`${C[0]}-${C[1]} of ${j} alerts`},scroll:{x:1200}})})]})},Aa=()=>{const t=fe(),[s,n]=x.useState([]),[r,o]=x.useState(!0),[a,i]=x.useState(!1),[c,d]=x.useState(null),[f]=T.useForm();x.useEffect(()=>{u()},[]);const u=async()=>{o(!0);try{const h=await fetch("/api/alerts/rules",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!h.ok)throw new Error("Failed to fetch alert rules");const v=await h.json();n(v.data||[])}catch(h){console.error("Failed to load rules:",h),E.error("Failed to load alert rules")}finally{o(!1)}},y=h=>{d(h),f.setFieldsValue(h),i(!0)},_=async h=>{try{if(!(await fetch(`/api/alerts/rules/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Failed to delete alert rule");E.success("Alert rule deleted"),u()}catch(v){console.error("Failed to delete alert rule:",v),E.error("Failed to delete alert rule")}},b=async(h,v)=>{try{if(!(await fetch(`/api/alerts/rules/${h}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:v})})).ok)throw new Error("Failed to update alert rule");E.success(`Alert rule ${v?"enabled":"disabled"}`),u()}catch(S){console.error("Failed to update alert rule:",S),E.error("Failed to update alert rule")}},l=async()=>{try{const h=await f.validateFields(),v=c?`/api/alerts/rules/${c.id}`:"/api/alerts/rules";if(!(await fetch(v,{method:c?"PUT":"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error(`Failed to ${c?"update":"create"} alert rule`);E.success(`Alert rule ${c?"updated":"created"}`),i(!1),u()}catch(h){console.error("Failed to submit:",h),E.error(`Failed to ${c?"update":"create"} alert rule`)}},m=h=>{switch(h){case"critical":return"red";case"high":return"orange";case"medium":return"gold";case"low":return"blue";default:return"default"}},p=[{title:"Name",dataIndex:"name",key:"name",render:h=>e.jsx("strong",{children:h})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Metric",dataIndex:"metric",key:"metric",render:h=>h.replace(/_/g," ").toUpperCase()},{title:"Condition",key:"condition",render:(h,v)=>`${v.condition} ${v.threshold}`},{title:"Duration",dataIndex:"duration",key:"duration",render:h=>`${h}s`},{title:"Severity",dataIndex:"severity",key:"severity",render:h=>e.jsx(z,{color:m(h),children:h.toUpperCase()})},{title:"Status",dataIndex:"enabled",key:"enabled",render:(h,v)=>{const S=v.id<=2;return e.jsx(Y,{checked:h,onChange:P=>b(v.id,P),disabled:S,title:S?"System rules are always enabled":"Toggle rule status"})}},{title:"Actions",key:"actions",render:(h,v)=>{const S=v.id<=2;return e.jsxs(O,{children:[e.jsx(k,{size:"small",icon:e.jsx(Ps,{}),onClick:()=>y(v),disabled:S,title:S?"System rules cannot be edited":"Edit rule",children:"Edit"}),e.jsx(Be,{title:"Delete this rule?",onConfirm:()=>_(v.id),okText:"Yes",cancelText:"No",disabled:S,children:e.jsx(k,{size:"small",icon:e.jsx(Ut,{}),danger:!0,disabled:S,title:S?"System rules cannot be deleted":"Delete rule",children:"Delete"})})]})}}];return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Alert Rules"}),e.jsxs(O,{children:[e.jsx(k,{onClick:()=>t("/alerts"),children:"Back to Alerts"}),e.jsx(k,{icon:e.jsx(K,{}),onClick:u,loading:r,children:"Refresh"})]})]}),e.jsx(U,{style:{marginBottom:16,backgroundColor:"#f0f5ff",borderColor:"#adc6ff"},children:e.jsxs(O,{direction:"vertical",size:"small",children:[e.jsx("div",{style:{fontWeight:"bold",color:"#1890ff"},children:"ℹ️ System Alert Rules"}),e.jsx("div",{style:{fontSize:"14px",color:"#595959"},children:"This system uses automatic alert rules for monitoring:"}),e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px",fontSize:"14px",color:"#595959"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Node Offline Alert"}),": Automatically triggered when a node becomes unreachable"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Process Stopped Alert"}),": Automatically triggered when a process stops unexpectedly"]})]}),e.jsx("div",{style:{fontSize:"13px",color:"#8c8c8c",fontStyle:"italic"},children:"System rules (ID 1-2) cannot be edited or deleted. Custom rules are not supported in this version."})]})}),e.jsx(U,{children:e.jsx(ue,{columns:p,dataSource:s,rowKey:"id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:h=>`Total ${h} rules`}})}),e.jsx(dt,{title:c?"Edit Alert Rule":"Create Alert Rule",open:a,onOk:l,onCancel:()=>i(!1),width:600,children:e.jsxs(T,{form:f,layout:"vertical",initialValues:{enabled:!0,severity:"high",condition:"==",threshold:0,duration:1},children:[e.jsx(T.Item,{name:"name",label:"Rule Name",rules:[{required:!0,message:"Please enter rule name"}],children:e.jsx(M,{placeholder:"e.g., Node Offline Alert"})}),e.jsx(T.Item,{name:"description",label:"Description",children:e.jsx(M.TextArea,{rows:2,placeholder:"Describe when this alert should trigger"})}),e.jsx(T.Item,{name:"metric",label:"Metric",rules:[{required:!0,message:"Please select metric"}],children:e.jsx(H,{options:[{label:"Node Status",value:"node_status"},{label:"Process Status",value:"process_status"},{label:"CPU Usage",value:"cpu"},{label:"Memory Usage",value:"memory"},{label:"Disk Usage",value:"disk"}]})}),e.jsx(T.Item,{name:"condition",label:"Condition",rules:[{required:!0,message:"Please select condition"}],children:e.jsx(H,{options:[{label:"Equal (==)",value:"=="},{label:"Not Equal (!=)",value:"!="},{label:"Greater Than (>)",value:">"},{label:"Greater or Equal (>=)",value:">="},{label:"Less Than (<)",value:"<"},{label:"Less or Equal (<=)",value:"<="}]})}),e.jsx(T.Item,{name:"threshold",label:"Threshold",rules:[{required:!0,message:"Please enter threshold"}],children:e.jsx(ge,{min:0,style:{width:"100%"}})}),e.jsx(T.Item,{name:"duration",label:"Duration (seconds)",rules:[{required:!0,message:"Please enter duration"}],children:e.jsx(ge,{min:1,style:{width:"100%"}})}),e.jsx(T.Item,{name:"severity",label:"Severity",rules:[{required:!0,message:"Please select severity"}],children:e.jsx(H,{options:[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"},{label:"Critical",value:"critical"}]})}),e.jsx(T.Item,{name:"enabled",label:"Enabled",valuePropName:"checked",children:e.jsx(Y,{})})]})})]})};class Pa{async getActivityLogs(s={}){const n=new URLSearchParams;s.level&&n.append("level",s.level),s.action&&n.append("action",s.action),s.resource&&n.append("resource",s.resource),s.username&&n.append("username",s.username),s.start_time&&n.append("start_time",s.start_time),s.end_time&&n.append("end_time",s.end_time),s.page&&n.append("page",s.page.toString()),s.page_size&&n.append("page_size",s.page_size.toString());const r=n.toString(),o=`/activity-logs${r?`?${r}`:""}`;return N.get(o)}async getRecentLogs(s=20){return(await N.get(`/activity-logs/recent?limit=${s}`)).logs}async getLogStatistics(s=7){return(await N.get(`/activity-logs/statistics?days=${s}`)).data}async exportLogs(s={}){const n=new URLSearchParams;s.level&&n.append("level",s.level),s.action&&n.append("action",s.action),s.resource&&n.append("resource",s.resource),s.username&&n.append("username",s.username),s.start_time&&n.append("start_time",s.start_time),s.end_time&&n.append("end_time",s.end_time);const r=n.toString(),o=`/activity-logs/export${r?`?${r}`:""}`,a=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!a.ok)throw new Error("Failed to export logs");return a.blob()}}const bs=new Pa,Ia=(t,s,n=[])=>{const[r,o]=x.useState(30),[a,i]=x.useState(!0),c=x.useRef(null),d=x.useRef(t);return x.useEffect(()=>{d.current=t},[t]),x.useEffect(()=>{(async()=>{var u,y,_;try{const b=await N.get("/api/system-settings/user-preferences");if(b.data){const l=b.data;i(l.auto_refresh!==!1),l.refresh_interval&&o(l.refresh_interval)}if(!((u=b.data)!=null&&u.refresh_interval)){const l=await N.get("/api/system-settings");(_=(y=l.data)==null?void 0:y.settings)!=null&&_.refresh_interval&&o(parseInt(l.data.settings.refresh_interval,10))}}catch(b){console.error("Failed to load refresh settings:",b)}})()},[]),x.useEffect(()=>(c.current&&(clearInterval(c.current),c.current=null),(s!==void 0?s:a)&&r>0&&(d.current(),c.current=setInterval(()=>{d.current()},r*1e3)),()=>{c.current&&(clearInterval(c.current),c.current=null)}),[r,a,s,...n]),{refreshInterval:r,autoRefreshEnabled:a,setRefreshInterval:o,setAutoRefreshEnabled:i}},{RangePicker:Ta}=An,$a=()=>{const[t,s]=x.useState([]),[n,r]=x.useState(!1),[o,a]=x.useState(null),[i,c]=x.useState(""),[d,f]=x.useState(""),[u,y]=x.useState(""),[_,b]=x.useState(""),[l,m]=x.useState(""),[p,h]=x.useState(null),[v,S]=x.useState(!0),[P,R]=x.useState({page:1,page_size:20,total:0,total_pages:0,has_next:!1,has_prev:!1});x.useEffect(()=>{j()},[]),Ia(()=>{P.page===1&&j()},v,[P.page]);const w=()=>{const A={page:P.page,page_size:P.page_size};return d&&(A.level=d),u&&(A.action=u),_&&(A.resource=_),l&&(A.username=l),p&&p[0]&&p[1]&&(A.start_time=p[0].toISOString(),A.end_time=p[1].toISOString()),A},j=async A=>{r(!0),a(null);try{const I=A?{...w(),...A}:w(),F=await bs.getActivityLogs(I);s(F.data.logs),R(F.data.pagination)}catch(I){console.error("Failed to load logs:",I);const F=I instanceof Error?I.message:"Failed to load activity logs";a(F),E.error(F)}finally{r(!1)}},C=()=>{R(A=>({...A,page:1})),j({page:1})},L=async()=>{try{E.loading({content:"Exporting logs...",key:"export"});const A=w(),I=await bs.exportLogs(A),F=URL.createObjectURL(I),D=document.createElement("a");D.href=F,D.download=`activity-logs-${Gt().format("YYYY-MM-DD-HHmmss")}.csv`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(F),E.success({content:"Logs exported successfully",key:"export"})}catch(A){console.error("Failed to export logs:",A),E.error({content:"Failed to export logs",key:"export"})}},q=A=>{switch(A.toUpperCase()){case"ERROR":return"red";case"WARNING":return"orange";case"INFO":return"blue";case"DEBUG":return"default";default:return"default"}},ae=A=>A.includes("create")?"green":A.includes("delete")?"red":A.includes("update")||A.includes("edit")?"orange":A.includes("start")?"blue":A.includes("stop")?"volcano":"default",Q=A=>{const I=A.current||1,F=A.pageSize||20;R(D=>({...D,page:I,page_size:F})),j({page:I,page_size:F})},ce=[{title:"Timestamp",dataIndex:"created_at",key:"created_at",width:180,render:A=>Gt(A).format("YYYY-MM-DD HH:mm:ss")},{title:"Level",dataIndex:"level",key:"level",width:100,render:A=>e.jsx(z,{color:q(A),children:A.toUpperCase()})},{title:"User",dataIndex:"username",key:"username",width:120,render:A=>A||"system"},{title:"Action",dataIndex:"action",key:"action",width:150,render:A=>e.jsx(z,{color:ae(A),children:A.replace(/_/g," ").toUpperCase()})},{title:"Resource",dataIndex:"resource",key:"resource",width:120},{title:"Target",dataIndex:"target",key:"target",width:150,ellipsis:!0},{title:"Message",dataIndex:"message",key:"message",ellipsis:!0},{title:"IP Address",dataIndex:"ip_address",key:"ip_address",width:140}],ee=i?t.filter(A=>{var I,F;return A.message.toLowerCase().includes(i.toLowerCase())||((I=A.username)==null?void 0:I.toLowerCase().includes(i.toLowerCase()))||A.action.toLowerCase().includes(i.toLowerCase())||((F=A.target)==null?void 0:F.toLowerCase().includes(i.toLowerCase()))}):t;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Activity Logs"}),e.jsxs(O,{children:[e.jsxs(k,{type:v?"default":"dashed",onClick:()=>S(!v),children:["Auto Refresh: ",v?"ON":"OFF"]}),e.jsx(k,{icon:e.jsx(ks,{}),onClick:L,disabled:n,children:"Export"}),e.jsx(k,{type:"primary",icon:e.jsx(K,{}),onClick:()=>j(),loading:n,children:"Refresh"})]})]}),o&&e.jsx(de,{message:"Error",description:o,type:"error",closable:!0,onClose:()=>a(null),style:{marginBottom:16}}),e.jsx(U,{style:{marginBottom:16},children:e.jsxs(O,{wrap:!0,style:{width:"100%"},children:[e.jsx(M,{placeholder:"Search logs...",prefix:e.jsx(Re,{}),style:{width:300},value:i,onChange:A=>c(A.target.value),allowClear:!0}),e.jsx(H,{style:{width:150},placeholder:"Level",value:d||void 0,onChange:f,allowClear:!0,options:[{label:"INFO",value:"INFO"},{label:"WARNING",value:"WARNING"},{label:"ERROR",value:"ERROR"},{label:"DEBUG",value:"DEBUG"}]}),e.jsx(H,{style:{width:150},placeholder:"Action",value:u||void 0,onChange:y,allowClear:!0,options:[{label:"Start Process",value:"start_process"},{label:"Stop Process",value:"stop_process"},{label:"Restart Process",value:"restart_process"},{label:"Login",value:"login"},{label:"Logout",value:"logout"}]}),e.jsx(H,{style:{width:150},placeholder:"Resource",value:_||void 0,onChange:b,allowClear:!0,options:[{label:"Process",value:"process"},{label:"Node",value:"node"},{label:"User",value:"user"},{label:"Auth",value:"auth"},{label:"System",value:"system"}]}),e.jsx(M,{placeholder:"Username",style:{width:150},value:l,onChange:A=>m(A.target.value),allowClear:!0}),e.jsx(Ta,{showTime:!0,format:"YYYY-MM-DD HH:mm",placeholder:["Start Time","End Time"],value:p,onChange:h}),e.jsx(k,{type:"primary",icon:e.jsx(Re,{}),onClick:C,loading:n,children:"Search"})]})}),e.jsx(U,{children:e.jsx(ue,{columns:ce,dataSource:ee,rowKey:"id",loading:n,pagination:{current:P.page,pageSize:P.page_size,total:P.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(A,I)=>`${I[0]}-${I[1]} of ${A} logs`,pageSizeOptions:["10","20","50","100"]},onChange:Q,scroll:{x:1200},size:"small"})})]})},Ce={changePassword:(t,s)=>N.put(`/users-legacy/${t}/password`,s),getUserPreferences:()=>N.get("/system-settings/user-preferences"),updateUserPreferences:t=>N.put("/system-settings/user-preferences",t),getSystemSettings:()=>N.get("/system-settings"),updateSystemSettings:t=>N.put("/system-settings/batch",{settings:t})},La=()=>{const{user:t,setUser:s,userPreferences:n,setUserPreferences:r}=ye(),[o,a]=x.useState(!1),[i]=T.useForm(),[c]=T.useForm(),[d]=T.useForm(),[f]=T.useForm();x.useEffect(()=>{if(t){const l={username:t.username,email:t.email,full_name:t.full_name||""};i.setFieldsValue(l)}},[t,i]),x.useEffect(()=>{if(n){const l=n.timezone||"UTC";i.setFieldsValue({timezone:l}),d.setFieldsValue({email_notifications:n.email_notifications??!0,process_alerts:n.process_alerts??!0,system_alerts:n.system_alerts??!0,node_status_changes:n.node_status_changes??!1,weekly_report:n.weekly_report??!1})}},[n,i,d]),x.useEffect(()=>{t&&(async()=>{try{const p=await Ce.getUserPreferences();r(p)}catch(m){console.error("Failed to load user preferences:",m),r({email_notifications:!0,process_alerts:!0,system_alerts:!0,node_status_changes:!1,weekly_report:!1,timezone:"UTC",theme:"light",language:"en"})}})()},[t,r]),x.useEffect(()=>{const l=async()=>{if(t!=null&&t.is_admin)try{const p=(await Ce.getSystemSettings()).settings||{};f.setFieldsValue({refresh_interval:parseInt(p.refresh_interval)||30,process_refresh_interval:parseInt(p.process_refresh_interval)||5,log_retention_days:parseInt(p.log_retention_days)||30,max_concurrent_connections:parseInt(p.max_concurrent_connections)||100,enable_websocket:p.enable_websocket==="true",enable_activity_logging:p.enable_activity_logging==="true"})}catch(m){console.error("Failed to load system settings:",m),f.setFieldsValue({refresh_interval:30,process_refresh_interval:5,log_retention_days:30,max_concurrent_connections:100,enable_websocket:!0,enable_activity_logging:!0})}};t!=null&&t.is_admin&&l()},[t,f]);const u=async()=>{var l,m,p;try{const h=await i.validateFields();a(!0);const v=await Ht.updateProfile({email:h.email,full_name:h.full_name});if((l=v.data)!=null&&l.data&&t){const S={...t,email:v.data.data.email,full_name:v.data.data.full_name,updated_at:v.data.data.updated_at};s(S)}if(h.timezone&&n&&h.timezone!==n.timezone)try{const S={...n,timezone:h.timezone};await Ce.updateUserPreferences(S),r(S)}catch(S){console.error("Failed to update timezone preference:",S)}E.success("Profile updated successfully")}catch(h){console.error("Failed to update profile:",h),E.error(((p=(m=h.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to update profile")}finally{a(!1)}},y=async()=>{var l,m;try{const p=await c.validateFields();if(a(!0),!(t!=null&&t.username)){E.error("User information not available");return}await Ce.changePassword(t.username,{old_password:p.current_password,new_password:p.new_password}),E.success("Password changed successfully"),c.resetFields()}catch(p){console.error("Failed to change password:",p),E.error(((m=(l=p.response)==null?void 0:l.data)==null?void 0:m.message)||"Failed to change password")}finally{a(!1)}},_=async()=>{var l,m;try{const p=await d.validateFields();a(!0);const h={email_notifications:p.email_notifications,process_alerts:p.process_alerts,system_alerts:p.system_alerts,node_status_changes:p.node_status_changes,weekly_report:p.weekly_report};await Ce.updateUserPreferences(h);const{setUserPreferences:v}=ye.getState();v(h),E.success("Notification settings updated")}catch(p){console.error("Failed to update notification settings:",p),E.error(((m=(l=p.response)==null?void 0:l.data)==null?void 0:m.message)||"Failed to update notification settings")}finally{a(!1)}},b=async()=>{var l,m;try{const p=await f.validateFields();a(!0);const h={refresh_interval:p.refresh_interval,process_refresh_interval:p.process_refresh_interval,log_retention_days:p.log_retention_days,max_concurrent_connections:p.max_concurrent_connections,enable_websocket:p.enable_websocket,enable_activity_logging:p.enable_activity_logging};await Ce.updateSystemSettings(h),E.success("System settings updated")}catch(p){console.error("Failed to update system settings:",p),E.error(((m=(l=p.response)==null?void 0:l.data)==null?void 0:m.message)||"Failed to update system settings")}finally{a(!1)}};return e.jsxs("div",{children:[e.jsx("h1",{style:{marginBottom:16},children:"Settings"}),e.jsx(U,{children:e.jsx(Rs,{items:[{key:"profile",label:e.jsxs("span",{children:[e.jsx(be,{}),"Profile"]}),children:e.jsxs("div",{style:{maxWidth:600},children:[e.jsx(de,{message:"Profile Information",description:"Update your personal information and preferences",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(T,{form:i,layout:"vertical",initialValues:{username:(t==null?void 0:t.username)||"",email:(t==null?void 0:t.email)||"",full_name:"",timezone:"UTC"},children:[e.jsx(T.Item,{name:"username",label:"Username",children:e.jsx(M,{prefix:e.jsx(be,{}),disabled:!0})}),e.jsx(T.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter valid email"}],children:e.jsx(M,{prefix:e.jsx(As,{}),placeholder:"Enter email"})}),e.jsx(T.Item,{name:"full_name",label:"Full Name",children:e.jsx(M,{placeholder:"Enter full name"})}),e.jsx(T.Item,{name:"timezone",label:"Timezone",children:e.jsx(H,{options:[{label:"UTC",value:"UTC"},{label:"America/New_York",value:"America/New_York"},{label:"America/Los_Angeles",value:"America/Los_Angeles"},{label:"Europe/London",value:"Europe/London"},{label:"Asia/Shanghai",value:"Asia/Shanghai"},{label:"Asia/Tokyo",value:"Asia/Tokyo"}]})}),e.jsx(T.Item,{children:e.jsx(k,{type:"primary",icon:e.jsx(Ge,{}),onClick:u,loading:o,children:"Save Changes"})})]})]})},{key:"security",label:e.jsxs("span",{children:[e.jsx(ke,{}),"Security"]}),children:e.jsxs("div",{style:{maxWidth:600},children:[e.jsx(de,{message:"Change Password",description:"Ensure your password is strong and secure",type:"warning",showIcon:!0,style:{marginBottom:24}}),e.jsxs(T,{form:c,layout:"vertical",children:[e.jsx(T.Item,{name:"current_password",label:"Current Password",rules:[{required:!0,message:"Please enter current password"}],children:e.jsx(M.Password,{prefix:e.jsx(ke,{}),placeholder:"Enter current password"})}),e.jsx(T.Item,{name:"new_password",label:"New Password",rules:[{required:!0,message:"Please enter new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(M.Password,{prefix:e.jsx(ke,{}),placeholder:"Enter new password"})}),e.jsx(T.Item,{name:"confirm_password",label:"Confirm Password",dependencies:["new_password"],rules:[{required:!0,message:"Please confirm password"},({getFieldValue:l})=>({validator(m,p){return!p||l("new_password")===p?Promise.resolve():Promise.reject(new Error("Passwords do not match"))}})],children:e.jsx(M.Password,{prefix:e.jsx(ke,{}),placeholder:"Confirm new password"})}),e.jsx(T.Item,{children:e.jsx(k,{type:"primary",icon:e.jsx(Ge,{}),onClick:y,loading:o,children:"Change Password"})})]})]})},{key:"notifications",label:e.jsxs("span",{children:[e.jsx(rt,{}),"Notifications"]}),children:e.jsxs("div",{style:{maxWidth:600},children:[e.jsx(de,{message:"Notification Preferences",description:"Configure how you want to receive notifications",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(T,{form:d,layout:"vertical",initialValues:{email_notifications:!0,process_alerts:!0,system_alerts:!0,weekly_report:!1},children:[e.jsx(T.Item,{name:"email_notifications",label:"Email Notifications",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(Ne,{}),e.jsx(T.Item,{name:"process_alerts",label:"Process Alerts",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(T.Item,{name:"system_alerts",label:"System Alerts",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(T.Item,{name:"node_status_changes",label:"Node Status Changes",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(Ne,{}),e.jsx(T.Item,{name:"weekly_report",label:"Weekly Summary Report",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(T.Item,{children:e.jsx(k,{type:"primary",icon:e.jsx(Ge,{}),onClick:_,loading:o,children:"Save Preferences"})})]})]})},{key:"system",label:e.jsxs("span",{children:[e.jsx(ze,{}),"System"]}),children:t!=null&&t.is_admin?e.jsxs("div",{style:{maxWidth:600},children:[e.jsx(de,{message:"System Configuration",description:"Configure global system settings (Admin only)",type:"warning",showIcon:!0,style:{marginBottom:24}}),e.jsxs(T,{form:f,layout:"vertical",initialValues:{refresh_interval:30,process_refresh_interval:5,log_retention_days:30,max_concurrent_connections:100,enable_websocket:!0,enable_activity_logging:!0},children:[e.jsx(T.Item,{name:"refresh_interval",label:"Node Refresh Interval (seconds)",help:"How often to refresh node and process status",rules:[{required:!0}],children:e.jsx(ge,{min:5,max:300,style:{width:"100%"}})}),e.jsx(T.Item,{name:"process_refresh_interval",label:"Process Page Refresh Interval (seconds)",help:"How often to push process updates via WebSocket",rules:[{required:!0}],children:e.jsx(ge,{min:1,max:300,style:{width:"100%"}})}),e.jsx(T.Item,{name:"log_retention_days",label:"Log Retention (days)",rules:[{required:!0}],children:e.jsx(ge,{min:1,max:365,style:{width:"100%"}})}),e.jsx(T.Item,{name:"max_concurrent_connections",label:"Max Concurrent Connections",rules:[{required:!0}],children:e.jsx(ge,{min:10,max:1e3,style:{width:"100%"}})}),e.jsx(Ne,{}),e.jsx(T.Item,{name:"enable_websocket",label:"Enable WebSocket",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(T.Item,{name:"enable_activity_logging",label:"Enable Activity Logging",valuePropName:"checked",children:e.jsx(Y,{})}),e.jsx(T.Item,{children:e.jsxs(O,{children:[e.jsx(k,{type:"primary",icon:e.jsx(Ge,{}),onClick:b,loading:o,children:"Save Settings"}),e.jsx(k,{icon:e.jsx(Pn,{}),onClick:()=>E.info("Database backup started"),children:"Backup Database"})]})})]})]}):e.jsx(de,{message:"Access Denied",description:"Only administrators can access system settings",type:"error",showIcon:!0})}]})})]})};function Oa({children:t}){const{isAuthenticated:s}=ye();return s?e.jsx(e.Fragment,{children:t}):e.jsx(et,{to:"/login",replace:!0})}function Fa(){const{isAuthenticated:t,setUser:s,logout:n}=ye();x.useEffect(()=>{const o=()=>{console.log("Auth logout event received"),n()};return window.addEventListener("auth:logout",o),()=>window.removeEventListener("auth:logout",o)},[n]),x.useEffect(()=>{const o=localStorage.getItem("token"),a=localStorage.getItem("user");console.log("App useEffect - token exists:",!!o,"user exists:",!!a),o&&a?(console.log("Validating stored credentials..."),r()):o||a?(console.log("Partial credentials found, cleaning up..."),n()):console.log("No stored credentials found")},[]);const r=async()=>{var o;try{console.log("Loading user info...");const a=await Ht.getCurrentUser();console.log("User info response:",a),a.status==="success"&&((o=a.data)!=null&&o.user)?(console.log("Setting user:",a.data.user),s(a.data.user)):(console.log("Invalid response, logging out"),n())}catch(a){console.error("Failed to load user info:",a),n()}};return e.jsxs(On,{children:[e.jsx(J,{path:"/login",element:e.jsx(Xo,{})}),e.jsxs(J,{path:"/",element:e.jsx(Oa,{children:e.jsx(Go,{})}),children:[e.jsx(J,{index:!0,element:e.jsx(et,{to:"/dashboard",replace:!0})}),e.jsx(J,{path:"dashboard",element:e.jsx(Zo,{})}),e.jsx(J,{path:"nodes",element:e.jsx(ya,{})}),e.jsx(J,{path:"nodes/:nodeName",element:e.jsx(ja,{})}),e.jsx(J,{path:"processes",element:e.jsx(va,{})}),e.jsx(J,{path:"environments",element:e.jsx(_a,{})}),e.jsx(J,{path:"environments/:environmentName",element:e.jsx(Ca,{})}),e.jsx(J,{path:"users",element:e.jsx(ka,{})}),e.jsx(J,{path:"alerts",element:e.jsx(Ra,{})}),e.jsx(J,{path:"alerts/rules",element:e.jsx(Aa,{})}),e.jsx(J,{path:"logs",element:e.jsx($a,{})}),e.jsx(J,{path:"settings",element:e.jsx(La,{})})]}),e.jsx(J,{path:"*",element:t?e.jsx(et,{to:"/dashboard",replace:!0}):e.jsx(et,{to:"/login",replace:!0})})]})}Tt.createRoot(document.getElementById("root")).render(e.jsx(Dt.StrictMode,{children:e.jsx(Fn,{children:e.jsx(In,{locale:Zn,children:e.jsx(Fa,{})})})}));
