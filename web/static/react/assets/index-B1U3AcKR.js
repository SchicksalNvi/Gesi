var Sn=Object.defineProperty;var _n=(t,s,n)=>s in t?Sn(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Rt=(t,s,n)=>_n(t,typeof s!="symbol"?s+"":s,n);import{i as ft,o as Cn,s as kn,j as e,L as Ft,R as Ts,M as Rn,a as En,b as In,S as N,D as An,A as $s,c as Re,d as Pn,e as ct,f as Tn,g as Os,h as Ht,k as qt,l as $n,C as V,F as L,I as G,m as He,B as A,n as E,p as Ke,q as he,r as ye,t as ie,u as _e,v as pe,T as M,w as ue,x as On,y as Ae,z as se,E as me,G as Ls,H as ht,J as Qt,K as ve,N as mt,O as ee,P as Pe,Q as ze,U as Te,V as Ln,W as Je,X as zn,Y as zs,Z as Ne,_ as oe,$ as Fn,a0 as Fs,a1 as Ce,a2 as $e,a3 as Ns,a4 as dt,a5 as Wt,a6 as be,a7 as De,a8 as Nn,a9 as tt,aa as Dn,ab as es,ac as Un,ad as rt,ae as Ds,af as ts,ag as Bn,ah as Mn,ai as ss,aj as Vn,ak as ns,al as Hn,am as rs,an as qn}from"./antd-vendor-Cgutrggu.js";import{c as Wn,g as Us,r as m,R as Kt,u as je,f as Kn,O as Jn,h as Bs,i as Yn,j as te,N as ot,B as Gn}from"./react-vendor-CGZ-ZtCm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var Nt={},os=Wn;Nt.createRoot=os.createRoot,Nt.hydrateRoot=os.hydrateRoot;var pt={},gt={};Object.defineProperty(gt,"__esModule",{value:!0});gt.default=void 0;var Xn={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};gt.default=Xn;var xt={},Ye={},yt={},jt={};Object.defineProperty(jt,"__esModule",{value:!0});jt.commonLocale=void 0;jt.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var Zn=ft.default;Object.defineProperty(yt,"__esModule",{value:!0});yt.default=void 0;var as=Zn(Cn),Qn=jt,er=(0,as.default)((0,as.default)({},Qn.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",week:"周",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});yt.default=er;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.default=void 0;const tr={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};Ge.default=tr;var Ms=ft.default;Object.defineProperty(Ye,"__esModule",{value:!0});Ye.default=void 0;var sr=Ms(yt),nr=Ms(Ge);const Vs={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},sr.default),timePickerLocale:Object.assign({},nr.default)};Vs.lang.ok="确定";Ye.default=Vs;var rr=ft.default;Object.defineProperty(xt,"__esModule",{value:!0});xt.default=void 0;var or=rr(Ye);xt.default=or.default;var bt=ft.default;Object.defineProperty(pt,"__esModule",{value:!0});pt.default=void 0;var ar=bt(gt),ir=bt(xt),lr=bt(Ye),cr=bt(Ge);const de="${label}不是一个有效的${type}",dr={locale:"zh-cn",Pagination:ar.default,DatePicker:lr.default,TimePicker:cr.default,Calendar:ir.default,global:{placeholder:"请选择",close:"关闭"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckAll:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:de,method:de,array:de,object:de,number:de,date:de,boolean:de,integer:de,float:de,regexp:de,email:de,url:de,hex:de},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};pt.default=dr;var ur=pt;const fr=Us(ur),hr={},is=t=>{let s;const n=new Set,r=(u,g)=>{const S=typeof u=="function"?u(s):u;if(!Object.is(S,s)){const b=s;s=g??(typeof S!="object"||S===null)?S:Object.assign({},s,S),n.forEach(c=>c(s,b))}},o=()=>s,d={setState:r,getState:o,getInitialState:()=>f,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(hr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=s=t(r,o,d);return d},mr=t=>t?is(t):is;var Hs={exports:{}},qs={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wt=m,pr=kn;function gr(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var xr=typeof Object.is=="function"?Object.is:gr,yr=pr.useSyncExternalStore,jr=wt.useRef,br=wt.useEffect,wr=wt.useMemo,vr=wt.useDebugValue;qs.useSyncExternalStoreWithSelector=function(t,s,n,r,o){var i=jr(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=wr(function(){function d(b){if(!f){if(f=!0,u=b,b=r(b),o!==void 0&&a.hasValue){var c=a.value;if(o(c,b))return g=c}return g=b}if(c=g,xr(u,b))return c;var p=r(b);return o!==void 0&&o(c,p)?(u=b,c):(u=b,g=p)}var f=!1,u,g,S=n===void 0?null:n;return[function(){return d(s())},S===null?void 0:function(){return d(S())}]},[s,n,r,o]);var l=yr(t,i[0],i[1]);return br(function(){a.hasValue=!0,a.value=l},[l]),vr(l),l};Hs.exports=qs;var Sr=Hs.exports;const _r=Us(Sr),Ws={},{useDebugValue:Cr}=Kt,{useSyncExternalStoreWithSelector:kr}=_r;let ls=!1;const Rr=t=>t;function Er(t,s=Rr,n){(Ws?"production":void 0)!=="production"&&n&&!ls&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ls=!0);const r=kr(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,n);return Cr(r),r}const cs=t=>{(Ws?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?mr(t):t,n=(r,o)=>Er(s,r,o);return Object.assign(n,s),n},Ir=t=>t?cs(t):cs,fe=Ir((t,s)=>({user:JSON.parse(localStorage.getItem("user")||"null"),token:localStorage.getItem("token"),isAuthenticated:!!(localStorage.getItem("token")&&localStorage.getItem("user")),setUser:n=>{n?localStorage.setItem("user",JSON.stringify(n)):localStorage.removeItem("user"),t({user:n,isAuthenticated:!!n&&!!s().token})},setToken:n=>{n?localStorage.setItem("token",n):localStorage.removeItem("token"),t({token:n,isAuthenticated:!!n&&!!s().user})},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userPreferences"),t({user:null,token:null,isAuthenticated:!1,userPreferences:null})},userPreferences:JSON.parse(localStorage.getItem("userPreferences")||"null"),setUserPreferences:n=>{n?localStorage.setItem("userPreferences",JSON.stringify(n)):localStorage.removeItem("userPreferences"),t({userPreferences:n})},websocketEnabled:localStorage.getItem("websocketEnabled")!=="false",setWebsocketEnabled:n=>{localStorage.setItem("websocketEnabled",String(n)),t({websocketEnabled:n})},nodes:[],selectedNode:null,setNodes:n=>t({nodes:n}),setSelectedNode:n=>t({selectedNode:n}),systemStats:null,setSystemStats:n=>t({systemStats:n}),sidebarCollapsed:!1,toggleSidebar:()=>t(n=>({sidebarCollapsed:!n.sidebarCollapsed}))}));function Ks(t,s){return function(){return t.apply(s,arguments)}}const{toString:Ar}=Object.prototype,{getPrototypeOf:Jt}=Object,{iterator:vt,toStringTag:Js}=Symbol,St=(t=>s=>{const n=Ar.call(s);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ge=t=>(t=t.toLowerCase(),s=>St(s)===t),_t=t=>s=>typeof s===t,{isArray:Ue}=Array,Fe=_t("undefined");function Xe(t){return t!==null&&!Fe(t)&&t.constructor!==null&&!Fe(t.constructor)&&le(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Ys=ge("ArrayBuffer");function Pr(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&Ys(t.buffer),s}const Tr=_t("string"),le=_t("function"),Gs=_t("number"),Ze=t=>t!==null&&typeof t=="object",$r=t=>t===!0||t===!1,at=t=>{if(St(t)!=="object")return!1;const s=Jt(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Js in t)&&!(vt in t)},Or=t=>{if(!Ze(t)||Xe(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Lr=ge("Date"),zr=ge("File"),Fr=ge("Blob"),Nr=ge("FileList"),Dr=t=>Ze(t)&&le(t.pipe),Ur=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||le(t.append)&&((s=St(t))==="formdata"||s==="object"&&le(t.toString)&&t.toString()==="[object FormData]"))},Br=ge("URLSearchParams"),[Mr,Vr,Hr,qr]=["ReadableStream","Request","Response","Headers"].map(ge),Wr=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Qe(t,s,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,o;if(typeof t!="object"&&(t=[t]),Ue(t))for(r=0,o=t.length;r<o;r++)s.call(null,t[r],r,t);else{if(Xe(t))return;const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let l;for(r=0;r<a;r++)l=i[r],s.call(null,t[l],l,t)}}function Xs(t,s){if(Xe(t))return null;s=s.toLowerCase();const n=Object.keys(t);let r=n.length,o;for(;r-- >0;)if(o=n[r],s===o.toLowerCase())return o;return null}const Ee=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Zs=t=>!Fe(t)&&t!==Ee;function Dt(){const{caseless:t,skipUndefined:s}=Zs(this)&&this||{},n={},r=(o,i)=>{const a=t&&Xs(n,i)||i;at(n[a])&&at(o)?n[a]=Dt(n[a],o):at(o)?n[a]=Dt({},o):Ue(o)?n[a]=o.slice():(!s||!Fe(o))&&(n[a]=o)};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&Qe(arguments[o],r);return n}const Kr=(t,s,n,{allOwnKeys:r}={})=>(Qe(s,(o,i)=>{n&&le(o)?t[i]=Ks(o,n):t[i]=o},{allOwnKeys:r}),t),Jr=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Yr=(t,s,n,r)=>{t.prototype=Object.create(s.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),n&&Object.assign(t.prototype,n)},Gr=(t,s,n,r)=>{let o,i,a;const l={};if(s=s||{},t==null)return s;do{for(o=Object.getOwnPropertyNames(t),i=o.length;i-- >0;)a=o[i],(!r||r(a,t,s))&&!l[a]&&(s[a]=t[a],l[a]=!0);t=n!==!1&&Jt(t)}while(t&&(!n||n(t,s))&&t!==Object.prototype);return s},Xr=(t,s,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=s.length;const r=t.indexOf(s,n);return r!==-1&&r===n},Zr=t=>{if(!t)return null;if(Ue(t))return t;let s=t.length;if(!Gs(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=t[s];return n},Qr=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Jt(Uint8Array)),eo=(t,s)=>{const r=(t&&t[vt]).call(t);let o;for(;(o=r.next())&&!o.done;){const i=o.value;s.call(t,i[0],i[1])}},to=(t,s)=>{let n;const r=[];for(;(n=t.exec(s))!==null;)r.push(n);return r},so=ge("HTMLFormElement"),no=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),ds=(({hasOwnProperty:t})=>(s,n)=>t.call(s,n))(Object.prototype),ro=ge("RegExp"),Qs=(t,s)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Qe(n,(o,i)=>{let a;(a=s(o,i,t))!==!1&&(r[i]=a||o)}),Object.defineProperties(t,r)},oo=t=>{Qs(t,(s,n)=>{if(le(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(le(r)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},ao=(t,s)=>{const n={},r=o=>{o.forEach(i=>{n[i]=!0})};return Ue(t)?r(t):r(String(t).split(s)),n},io=()=>{},lo=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function co(t){return!!(t&&le(t.append)&&t[Js]==="FormData"&&t[vt])}const uo=t=>{const s=new Array(10),n=(r,o)=>{if(Ze(r)){if(s.indexOf(r)>=0)return;if(Xe(r))return r;if(!("toJSON"in r)){s[o]=r;const i=Ue(r)?[]:{};return Qe(r,(a,l)=>{const d=n(a,o+1);!Fe(d)&&(i[l]=d)}),s[o]=void 0,i}}return r};return n(t,0)},fo=ge("AsyncFunction"),ho=t=>t&&(Ze(t)||le(t))&&le(t.then)&&le(t.catch),en=((t,s)=>t?setImmediate:s?((n,r)=>(Ee.addEventListener("message",({source:o,data:i})=>{o===Ee&&i===n&&r.length&&r.shift()()},!1),o=>{r.push(o),Ee.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",le(Ee.postMessage)),mo=typeof queueMicrotask<"u"?queueMicrotask.bind(Ee):typeof process<"u"&&process.nextTick||en,po=t=>t!=null&&le(t[vt]),x={isArray:Ue,isArrayBuffer:Ys,isBuffer:Xe,isFormData:Ur,isArrayBufferView:Pr,isString:Tr,isNumber:Gs,isBoolean:$r,isObject:Ze,isPlainObject:at,isEmptyObject:Or,isReadableStream:Mr,isRequest:Vr,isResponse:Hr,isHeaders:qr,isUndefined:Fe,isDate:Lr,isFile:zr,isBlob:Fr,isRegExp:ro,isFunction:le,isStream:Dr,isURLSearchParams:Br,isTypedArray:Qr,isFileList:Nr,forEach:Qe,merge:Dt,extend:Kr,trim:Wr,stripBOM:Jr,inherits:Yr,toFlatObject:Gr,kindOf:St,kindOfTest:ge,endsWith:Xr,toArray:Zr,forEachEntry:eo,matchAll:to,isHTMLForm:so,hasOwnProperty:ds,hasOwnProp:ds,reduceDescriptors:Qs,freezeMethods:oo,toObjectSet:ao,toCamelCase:no,noop:io,toFiniteNumber:lo,findKey:Xs,global:Ee,isContextDefined:Zs,isSpecCompliantForm:co,toJSONObject:uo,isAsyncFn:fo,isThenable:ho,setImmediate:en,asap:mo,isIterable:po};function U(t,s,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}x.inherits(U,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:x.toJSONObject(this.config),code:this.code,status:this.status}}});const tn=U.prototype,sn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{sn[t]={value:t}});Object.defineProperties(U,sn);Object.defineProperty(tn,"isAxiosError",{value:!0});U.from=(t,s,n,r,o,i)=>{const a=Object.create(tn);x.toFlatObject(t,a,function(u){return u!==Error.prototype},f=>f!=="isAxiosError");const l=t&&t.message?t.message:"Error",d=s==null&&t?t.code:s;return U.call(a,l,d,n,r,o),t&&a.cause==null&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",i&&Object.assign(a,i),a};const go=null;function Ut(t){return x.isPlainObject(t)||x.isArray(t)}function nn(t){return x.endsWith(t,"[]")?t.slice(0,-2):t}function us(t,s,n){return t?t.concat(s).map(function(o,i){return o=nn(o),!n&&i?"["+o+"]":o}).join(n?".":""):s}function xo(t){return x.isArray(t)&&!t.some(Ut)}const yo=x.toFlatObject(x,{},null,function(s){return/^is[A-Z]/.test(s)});function Ct(t,s,n){if(!x.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,n=x.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,y){return!x.isUndefined(y[p])});const r=n.metaTokens,o=n.visitor||u,i=n.dots,a=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&x.isSpecCompliantForm(s);if(!x.isFunction(o))throw new TypeError("visitor must be a function");function f(c){if(c===null)return"";if(x.isDate(c))return c.toISOString();if(x.isBoolean(c))return c.toString();if(!d&&x.isBlob(c))throw new U("Blob is not supported. Use a Buffer instead.");return x.isArrayBuffer(c)||x.isTypedArray(c)?d&&typeof Blob=="function"?new Blob([c]):Buffer.from(c):c}function u(c,p,y){let h=c;if(c&&!y&&typeof c=="object"){if(x.endsWith(p,"{}"))p=r?p:p.slice(0,-2),c=JSON.stringify(c);else if(x.isArray(c)&&xo(c)||(x.isFileList(c)||x.endsWith(p,"[]"))&&(h=x.toArray(c)))return p=nn(p),h.forEach(function(_,P){!(x.isUndefined(_)||_===null)&&s.append(a===!0?us([p],P,i):a===null?p:p+"[]",f(_))}),!1}return Ut(c)?!0:(s.append(us(y,p,i),f(c)),!1)}const g=[],S=Object.assign(yo,{defaultVisitor:u,convertValue:f,isVisitable:Ut});function b(c,p){if(!x.isUndefined(c)){if(g.indexOf(c)!==-1)throw Error("Circular reference detected in "+p.join("."));g.push(c),x.forEach(c,function(h,v){(!(x.isUndefined(h)||h===null)&&o.call(s,h,x.isString(v)?v.trim():v,p,S))===!0&&b(h,p?p.concat(v):[v])}),g.pop()}}if(!x.isObject(t))throw new TypeError("data must be an object");return b(t),s}function fs(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return s[r]})}function Yt(t,s){this._pairs=[],t&&Ct(t,this,s)}const rn=Yt.prototype;rn.append=function(s,n){this._pairs.push([s,n])};rn.toString=function(s){const n=s?function(r){return s.call(this,r,fs)}:fs;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function jo(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function on(t,s,n){if(!s)return t;const r=n&&n.encode||jo;x.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(o?i=o(s,n):i=x.isURLSearchParams(s)?s.toString():new Yt(s,n).toString(r),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class hs{constructor(){this.handlers=[]}use(s,n,r){return this.handlers.push({fulfilled:s,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){x.forEach(this.handlers,function(r){r!==null&&s(r)})}}const an={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bo=typeof URLSearchParams<"u"?URLSearchParams:Yt,wo=typeof FormData<"u"?FormData:null,vo=typeof Blob<"u"?Blob:null,So={isBrowser:!0,classes:{URLSearchParams:bo,FormData:wo,Blob:vo},protocols:["http","https","file","blob","url","data"]},Gt=typeof window<"u"&&typeof document<"u",Bt=typeof navigator=="object"&&navigator||void 0,_o=Gt&&(!Bt||["ReactNative","NativeScript","NS"].indexOf(Bt.product)<0),Co=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ko=Gt&&window.location.href||"http://localhost",Ro=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Gt,hasStandardBrowserEnv:_o,hasStandardBrowserWebWorkerEnv:Co,navigator:Bt,origin:ko},Symbol.toStringTag,{value:"Module"})),ne={...Ro,...So};function Eo(t,s){return Ct(t,new ne.classes.URLSearchParams,{visitor:function(n,r,o,i){return ne.isNode&&x.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function Io(t){return x.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function Ao(t){const s={},n=Object.keys(t);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],s[i]=t[i];return s}function ln(t){function s(n,r,o,i){let a=n[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),d=i>=n.length;return a=!a&&x.isArray(o)?o.length:a,d?(x.hasOwnProp(o,a)?o[a]=[o[a],r]:o[a]=r,!l):((!o[a]||!x.isObject(o[a]))&&(o[a]=[]),s(n,r,o[a],i)&&x.isArray(o[a])&&(o[a]=Ao(o[a])),!l)}if(x.isFormData(t)&&x.isFunction(t.entries)){const n={};return x.forEachEntry(t,(r,o)=>{s(Io(r),o,n,0)}),n}return null}function Po(t,s,n){if(x.isString(t))try{return(s||JSON.parse)(t),x.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const et={transitional:an,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,i=x.isObject(s);if(i&&x.isHTMLForm(s)&&(s=new FormData(s)),x.isFormData(s))return o?JSON.stringify(ln(s)):s;if(x.isArrayBuffer(s)||x.isBuffer(s)||x.isStream(s)||x.isFile(s)||x.isBlob(s)||x.isReadableStream(s))return s;if(x.isArrayBufferView(s))return s.buffer;if(x.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Eo(s,this.formSerializer).toString();if((l=x.isFileList(s))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Ct(l?{"files[]":s}:s,d&&new d,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),Po(s)):s}],transformResponse:[function(s){const n=this.transitional||et.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(x.isResponse(s)||x.isReadableStream(s))return s;if(s&&x.isString(s)&&(r&&!this.responseType||o)){const a=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(s,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?U.from(l,U.ERR_BAD_RESPONSE,this,null,this.response):l}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ne.classes.FormData,Blob:ne.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};x.forEach(["delete","get","head","post","put","patch"],t=>{et.headers[t]={}});const To=x.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$o=t=>{const s={};let n,r,o;return t&&t.split(`
`).forEach(function(a){o=a.indexOf(":"),n=a.substring(0,o).trim().toLowerCase(),r=a.substring(o+1).trim(),!(!n||s[n]&&To[n])&&(n==="set-cookie"?s[n]?s[n].push(r):s[n]=[r]:s[n]=s[n]?s[n]+", "+r:r)}),s},ms=Symbol("internals");function Me(t){return t&&String(t).trim().toLowerCase()}function it(t){return t===!1||t==null?t:x.isArray(t)?t.map(it):String(t)}function Oo(t){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)s[r[1]]=r[2];return s}const Lo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Et(t,s,n,r,o){if(x.isFunction(r))return r.call(this,s,n);if(o&&(s=n),!!x.isString(s)){if(x.isString(r))return s.indexOf(r)!==-1;if(x.isRegExp(r))return r.test(s)}}function zo(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,r)=>n.toUpperCase()+r)}function Fo(t,s){const n=x.toCamelCase(" "+s);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(o,i,a){return this[r].call(this,s,o,i,a)},configurable:!0})})}let ce=class{constructor(s){s&&this.set(s)}set(s,n,r){const o=this;function i(l,d,f){const u=Me(d);if(!u)throw new Error("header name must be a non-empty string");const g=x.findKey(o,u);(!g||o[g]===void 0||f===!0||f===void 0&&o[g]!==!1)&&(o[g||d]=it(l))}const a=(l,d)=>x.forEach(l,(f,u)=>i(f,u,d));if(x.isPlainObject(s)||s instanceof this.constructor)a(s,n);else if(x.isString(s)&&(s=s.trim())&&!Lo(s))a($o(s),n);else if(x.isObject(s)&&x.isIterable(s)){let l={},d,f;for(const u of s){if(!x.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[f=u[0]]=(d=l[f])?x.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}a(l,n)}else s!=null&&i(n,s,r);return this}get(s,n){if(s=Me(s),s){const r=x.findKey(this,s);if(r){const o=this[r];if(!n)return o;if(n===!0)return Oo(o);if(x.isFunction(n))return n.call(this,o,r);if(x.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Me(s),s){const r=x.findKey(this,s);return!!(r&&this[r]!==void 0&&(!n||Et(this,this[r],r,n)))}return!1}delete(s,n){const r=this;let o=!1;function i(a){if(a=Me(a),a){const l=x.findKey(r,a);l&&(!n||Et(r,r[l],l,n))&&(delete r[l],o=!0)}}return x.isArray(s)?s.forEach(i):i(s),o}clear(s){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const i=n[r];(!s||Et(this,this[i],i,s,!0))&&(delete this[i],o=!0)}return o}normalize(s){const n=this,r={};return x.forEach(this,(o,i)=>{const a=x.findKey(r,i);if(a){n[a]=it(o),delete n[i];return}const l=s?zo(i):String(i).trim();l!==i&&delete n[i],n[l]=it(o),r[l]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return x.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=s&&x.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const r=new this(s);return n.forEach(o=>r.set(o)),r}static accessor(s){const r=(this[ms]=this[ms]={accessors:{}}).accessors,o=this.prototype;function i(a){const l=Me(a);r[l]||(Fo(o,a),r[l]=!0)}return x.isArray(s)?s.forEach(i):i(s),this}};ce.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);x.reduceDescriptors(ce.prototype,({value:t},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(r){this[n]=r}}});x.freezeMethods(ce);function It(t,s){const n=this||et,r=s||n,o=ce.from(r.headers);let i=r.data;return x.forEach(t,function(l){i=l.call(n,i,o.normalize(),s?s.status:void 0)}),o.normalize(),i}function cn(t){return!!(t&&t.__CANCEL__)}function Be(t,s,n){U.call(this,t??"canceled",U.ERR_CANCELED,s,n),this.name="CanceledError"}x.inherits(Be,U,{__CANCEL__:!0});function dn(t,s,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):s(new U("Request failed with status code "+n.status,[U.ERR_BAD_REQUEST,U.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function No(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Do(t,s){t=t||10;const n=new Array(t),r=new Array(t);let o=0,i=0,a;return s=s!==void 0?s:1e3,function(d){const f=Date.now(),u=r[i];a||(a=f),n[o]=d,r[o]=f;let g=i,S=0;for(;g!==o;)S+=n[g++],g=g%t;if(o=(o+1)%t,o===i&&(i=(i+1)%t),f-a<s)return;const b=u&&f-u;return b?Math.round(S*1e3/b):void 0}}function Uo(t,s){let n=0,r=1e3/s,o,i;const a=(f,u=Date.now())=>{n=u,o=null,i&&(clearTimeout(i),i=null),t(...f)};return[(...f)=>{const u=Date.now(),g=u-n;g>=r?a(f,u):(o=f,i||(i=setTimeout(()=>{i=null,a(o)},r-g)))},()=>o&&a(o)]}const ut=(t,s,n=3)=>{let r=0;const o=Do(50,250);return Uo(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,d=a-r,f=o(d),u=a<=l;r=a;const g={loaded:a,total:l,progress:l?a/l:void 0,bytes:d,rate:f||void 0,estimated:f&&l&&u?(l-a)/f:void 0,event:i,lengthComputable:l!=null,[s?"download":"upload"]:!0};t(g)},n)},ps=(t,s)=>{const n=t!=null;return[r=>s[0]({lengthComputable:n,total:t,loaded:r}),s[1]]},gs=t=>(...s)=>x.asap(()=>t(...s)),Bo=ne.hasStandardBrowserEnv?((t,s)=>n=>(n=new URL(n,ne.origin),t.protocol===n.protocol&&t.host===n.host&&(s||t.port===n.port)))(new URL(ne.origin),ne.navigator&&/(msie|trident)/i.test(ne.navigator.userAgent)):()=>!0,Mo=ne.hasStandardBrowserEnv?{write(t,s,n,r,o,i,a){if(typeof document>"u")return;const l=[`${t}=${encodeURIComponent(s)}`];x.isNumber(n)&&l.push(`expires=${new Date(n).toUTCString()}`),x.isString(r)&&l.push(`path=${r}`),x.isString(o)&&l.push(`domain=${o}`),i===!0&&l.push("secure"),x.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Vo(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Ho(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function un(t,s,n){let r=!Vo(s);return t&&(r||n==!1)?Ho(t,s):s}const xs=t=>t instanceof ce?{...t}:t;function Oe(t,s){s=s||{};const n={};function r(f,u,g,S){return x.isPlainObject(f)&&x.isPlainObject(u)?x.merge.call({caseless:S},f,u):x.isPlainObject(u)?x.merge({},u):x.isArray(u)?u.slice():u}function o(f,u,g,S){if(x.isUndefined(u)){if(!x.isUndefined(f))return r(void 0,f,g,S)}else return r(f,u,g,S)}function i(f,u){if(!x.isUndefined(u))return r(void 0,u)}function a(f,u){if(x.isUndefined(u)){if(!x.isUndefined(f))return r(void 0,f)}else return r(void 0,u)}function l(f,u,g){if(g in s)return r(f,u);if(g in t)return r(void 0,f)}const d={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(f,u,g)=>o(xs(f),xs(u),g,!0)};return x.forEach(Object.keys({...t,...s}),function(u){const g=d[u]||o,S=g(t[u],s[u],u);x.isUndefined(S)&&g!==l||(n[u]=S)}),n}const fn=t=>{const s=Oe({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:i,headers:a,auth:l}=s;if(s.headers=a=ce.from(a),s.url=on(un(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),x.isFormData(n)){if(ne.hasStandardBrowserEnv||ne.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(x.isFunction(n.getHeaders)){const d=n.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([u,g])=>{f.includes(u.toLowerCase())&&a.set(u,g)})}}if(ne.hasStandardBrowserEnv&&(r&&x.isFunction(r)&&(r=r(s)),r||r!==!1&&Bo(s.url))){const d=o&&i&&Mo.read(i);d&&a.set(o,d)}return s},qo=typeof XMLHttpRequest<"u",Wo=qo&&function(t){return new Promise(function(n,r){const o=fn(t);let i=o.data;const a=ce.from(o.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:f}=o,u,g,S,b,c;function p(){b&&b(),c&&c(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(o.method.toUpperCase(),o.url,!0),y.timeout=o.timeout;function h(){if(!y)return;const _=ce.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:_,config:t,request:y};dn(function(w){n(w),p()},function(w){r(w),p()},T),y=null}"onloadend"in y?y.onloadend=h:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(h)},y.onabort=function(){y&&(r(new U("Request aborted",U.ECONNABORTED,t,y)),y=null)},y.onerror=function(P){const T=P&&P.message?P.message:"Network Error",k=new U(T,U.ERR_NETWORK,t,y);k.event=P||null,r(k),y=null},y.ontimeout=function(){let P=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||an;o.timeoutErrorMessage&&(P=o.timeoutErrorMessage),r(new U(P,T.clarifyTimeoutError?U.ETIMEDOUT:U.ECONNABORTED,t,y)),y=null},i===void 0&&a.setContentType(null),"setRequestHeader"in y&&x.forEach(a.toJSON(),function(P,T){y.setRequestHeader(T,P)}),x.isUndefined(o.withCredentials)||(y.withCredentials=!!o.withCredentials),l&&l!=="json"&&(y.responseType=o.responseType),f&&([S,c]=ut(f,!0),y.addEventListener("progress",S)),d&&y.upload&&([g,b]=ut(d),y.upload.addEventListener("progress",g),y.upload.addEventListener("loadend",b)),(o.cancelToken||o.signal)&&(u=_=>{y&&(r(!_||_.type?new Be(null,t,y):_),y.abort(),y=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const v=No(o.url);if(v&&ne.protocols.indexOf(v)===-1){r(new U("Unsupported protocol "+v+":",U.ERR_BAD_REQUEST,t));return}y.send(i||null)})},Ko=(t,s)=>{const{length:n}=t=t?t.filter(Boolean):[];if(s||n){let r=new AbortController,o;const i=function(f){if(!o){o=!0,l();const u=f instanceof Error?f:this.reason;r.abort(u instanceof U?u:new Be(u instanceof Error?u.message:u))}};let a=s&&setTimeout(()=>{a=null,i(new U(`timeout ${s} of ms exceeded`,U.ETIMEDOUT))},s);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),t=null)};t.forEach(f=>f.addEventListener("abort",i));const{signal:d}=r;return d.unsubscribe=()=>x.asap(l),d}},Jo=function*(t,s){let n=t.byteLength;if(n<s){yield t;return}let r=0,o;for(;r<n;)o=r+s,yield t.slice(r,o),r=o},Yo=async function*(t,s){for await(const n of Go(t))yield*Jo(n,s)},Go=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:n,value:r}=await s.read();if(n)break;yield r}}finally{await s.cancel()}},ys=(t,s,n,r)=>{const o=Yo(t,s);let i=0,a,l=d=>{a||(a=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:f,value:u}=await o.next();if(f){l(),d.close();return}let g=u.byteLength;if(n){let S=i+=g;n(S)}d.enqueue(new Uint8Array(u))}catch(f){throw l(f),f}},cancel(d){return l(d),o.return()}},{highWaterMark:2})},js=64*1024,{isFunction:st}=x,Xo=(({Request:t,Response:s})=>({Request:t,Response:s}))(x.global),{ReadableStream:bs,TextEncoder:ws}=x.global,vs=(t,...s)=>{try{return!!t(...s)}catch{return!1}},Zo=t=>{t=x.merge.call({skipUndefined:!0},Xo,t);const{fetch:s,Request:n,Response:r}=t,o=s?st(s):typeof fetch=="function",i=st(n),a=st(r);if(!o)return!1;const l=o&&st(bs),d=o&&(typeof ws=="function"?(c=>p=>c.encode(p))(new ws):async c=>new Uint8Array(await new n(c).arrayBuffer())),f=i&&l&&vs(()=>{let c=!1;const p=new n(ne.origin,{body:new bs,method:"POST",get duplex(){return c=!0,"half"}}).headers.has("Content-Type");return c&&!p}),u=a&&l&&vs(()=>x.isReadableStream(new r("").body)),g={stream:u&&(c=>c.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(c=>{!g[c]&&(g[c]=(p,y)=>{let h=p&&p[c];if(h)return h.call(p);throw new U(`Response type '${c}' is not supported`,U.ERR_NOT_SUPPORT,y)})});const S=async c=>{if(c==null)return 0;if(x.isBlob(c))return c.size;if(x.isSpecCompliantForm(c))return(await new n(ne.origin,{method:"POST",body:c}).arrayBuffer()).byteLength;if(x.isArrayBufferView(c)||x.isArrayBuffer(c))return c.byteLength;if(x.isURLSearchParams(c)&&(c=c+""),x.isString(c))return(await d(c)).byteLength},b=async(c,p)=>{const y=x.toFiniteNumber(c.getContentLength());return y??S(p)};return async c=>{let{url:p,method:y,data:h,signal:v,cancelToken:_,timeout:P,onDownloadProgress:T,onUploadProgress:k,responseType:w,headers:I,withCredentials:z="same-origin",fetchOptions:B}=fn(c),J=s||fetch;w=w?(w+"").toLowerCase():"text";let X=Ko([v,_&&_.toAbortSignal()],P),H=null;const q=X&&X.unsubscribe&&(()=>{X.unsubscribe()});let Y;try{if(k&&f&&y!=="get"&&y!=="head"&&(Y=await b(I,h))!==0){let C=new n(p,{method:"POST",body:h,duplex:"half"}),O;if(x.isFormData(h)&&(O=C.headers.get("content-type"))&&I.setContentType(O),C.body){const[K,re]=ps(Y,ut(gs(k)));h=ys(C.body,js,K,re)}}x.isString(z)||(z=z?"include":"omit");const F=i&&"credentials"in n.prototype,j={...B,signal:X,method:y.toUpperCase(),headers:I.normalize().toJSON(),body:h,duplex:"half",credentials:F?z:void 0};H=i&&new n(p,j);let R=await(i?J(H,B):J(p,j));const $=u&&(w==="stream"||w==="response");if(u&&(T||$&&q)){const C={};["status","statusText","headers"].forEach(Zt=>{C[Zt]=R[Zt]});const O=x.toFiniteNumber(R.headers.get("content-length")),[K,re]=T&&ps(O,ut(gs(T),!0))||[];R=new r(ys(R.body,js,K,()=>{re&&re(),q&&q()}),C)}w=w||"text";let W=await g[x.findKey(g,w)||"text"](R,c);return!$&&q&&q(),await new Promise((C,O)=>{dn(C,O,{data:W,headers:ce.from(R.headers),status:R.status,statusText:R.statusText,config:c,request:H})})}catch(F){throw q&&q(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new U("Network Error",U.ERR_NETWORK,c,H),{cause:F.cause||F}):U.from(F,F&&F.code,c,H)}}},Qo=new Map,hn=t=>{let s=t&&t.env||{};const{fetch:n,Request:r,Response:o}=s,i=[r,o,n];let a=i.length,l=a,d,f,u=Qo;for(;l--;)d=i[l],f=u.get(d),f===void 0&&u.set(d,f=l?new Map:Zo(s)),u=f;return f};hn();const Xt={http:go,xhr:Wo,fetch:{get:hn}};x.forEach(Xt,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const Ss=t=>`- ${t}`,ea=t=>x.isFunction(t)||t===null||t===!1;function ta(t,s){t=x.isArray(t)?t:[t];const{length:n}=t;let r,o;const i={};for(let a=0;a<n;a++){r=t[a];let l;if(o=r,!ea(r)&&(o=Xt[(l=String(r)).toLowerCase()],o===void 0))throw new U(`Unknown adapter '${l}'`);if(o&&(x.isFunction(o)||(o=o.get(s))))break;i[l||"#"+a]=o}if(!o){const a=Object.entries(i).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?a.length>1?`since :
`+a.map(Ss).join(`
`):" "+Ss(a[0]):"as no adapter specified";throw new U("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return o}const mn={getAdapter:ta,adapters:Xt};function At(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Be(null,t)}function _s(t){return At(t),t.headers=ce.from(t.headers),t.data=It.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),mn.getAdapter(t.adapter||et.adapter,t)(t).then(function(r){return At(t),r.data=It.call(t,t.transformResponse,r),r.headers=ce.from(r.headers),r},function(r){return cn(r)||(At(t),r&&r.response&&(r.response.data=It.call(t,t.transformResponse,r.response),r.response.headers=ce.from(r.response.headers))),Promise.reject(r)})}const pn="1.13.2",kt={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{kt[t]=function(r){return typeof r===t||"a"+(s<1?"n ":" ")+t}});const Cs={};kt.transitional=function(s,n,r){function o(i,a){return"[Axios v"+pn+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,l)=>{if(s===!1)throw new U(o(a," has been removed"+(n?" in "+n:"")),U.ERR_DEPRECATED);return n&&!Cs[a]&&(Cs[a]=!0,console.warn(o(a," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(i,a,l):!0}};kt.spelling=function(s){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${s}`),!0)};function sa(t,s,n){if(typeof t!="object")throw new U("options must be an object",U.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let o=r.length;for(;o-- >0;){const i=r[o],a=s[i];if(a){const l=t[i],d=l===void 0||a(l,i,t);if(d!==!0)throw new U("option "+i+" must be "+d,U.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new U("Unknown option "+i,U.ERR_BAD_OPTION)}}const lt={assertOptions:sa,validators:kt},xe=lt.validators;let Ie=class{constructor(s){this.defaults=s||{},this.interceptors={request:new hs,response:new hs}}async request(s,n){try{return await this._request(s,n)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=Oe(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:i}=n;r!==void 0&&lt.assertOptions(r,{silentJSONParsing:xe.transitional(xe.boolean),forcedJSONParsing:xe.transitional(xe.boolean),clarifyTimeoutError:xe.transitional(xe.boolean)},!1),o!=null&&(x.isFunction(o)?n.paramsSerializer={serialize:o}:lt.assertOptions(o,{encode:xe.function,serialize:xe.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),lt.assertOptions(n,{baseUrl:xe.spelling("baseURL"),withXsrfToken:xe.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&x.merge(i.common,i[n.method]);i&&x.forEach(["delete","get","head","post","put","patch","common"],c=>{delete i[c]}),n.headers=ce.concat(a,i);const l=[];let d=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(n)===!1||(d=d&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const f=[];this.interceptors.response.forEach(function(p){f.push(p.fulfilled,p.rejected)});let u,g=0,S;if(!d){const c=[_s.bind(this),void 0];for(c.unshift(...l),c.push(...f),S=c.length,u=Promise.resolve(n);g<S;)u=u.then(c[g++],c[g++]);return u}S=l.length;let b=n;for(;g<S;){const c=l[g++],p=l[g++];try{b=c(b)}catch(y){p.call(this,y);break}}try{u=_s.call(this,b)}catch(c){return Promise.reject(c)}for(g=0,S=f.length;g<S;)u=u.then(f[g++],f[g++]);return u}getUri(s){s=Oe(this.defaults,s);const n=un(s.baseURL,s.url,s.allowAbsoluteUrls);return on(n,s.params,s.paramsSerializer)}};x.forEach(["delete","get","head","options"],function(s){Ie.prototype[s]=function(n,r){return this.request(Oe(r||{},{method:s,url:n,data:(r||{}).data}))}});x.forEach(["post","put","patch"],function(s){function n(r){return function(i,a,l){return this.request(Oe(l||{},{method:s,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Ie.prototype[s]=n(),Ie.prototype[s+"Form"]=n(!0)});let na=class gn{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(o=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](o);r._listeners=null}),this.promise.then=o=>{let i;const a=new Promise(l=>{r.subscribe(l),i=l}).then(o);return a.cancel=function(){r.unsubscribe(i)},a},s(function(i,a,l){r.reason||(r.reason=new Be(i,a,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=r=>{s.abort(r)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new gn(function(o){s=o}),cancel:s}}};function ra(t){return function(n){return t.apply(null,n)}}function oa(t){return x.isObject(t)&&t.isAxiosError===!0}const Mt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Mt).forEach(([t,s])=>{Mt[s]=t});function xn(t){const s=new Ie(t),n=Ks(Ie.prototype.request,s);return x.extend(n,Ie.prototype,s,{allOwnKeys:!0}),x.extend(n,s,null,{allOwnKeys:!0}),n.create=function(o){return xn(Oe(t,o))},n}const Z=xn(et);Z.Axios=Ie;Z.CanceledError=Be;Z.CancelToken=na;Z.isCancel=cn;Z.VERSION=pn;Z.toFormData=Ct;Z.AxiosError=U;Z.Cancel=Z.CanceledError;Z.all=function(s){return Promise.all(s)};Z.spread=ra;Z.isAxiosError=oa;Z.mergeConfig=Oe;Z.AxiosHeaders=ce;Z.formToJSON=t=>ln(x.isHTMLForm(t)?new FormData(t):t);Z.getAdapter=mn.getAdapter;Z.HttpStatusCode=Mt;Z.default=Z;const{Axios:xi,AxiosError:yi,CanceledError:ji,isCancel:bi,CancelToken:wi,VERSION:vi,all:Si,Cancel:_i,isAxiosError:Ci,spread:ki,toFormData:Ri,AxiosHeaders:Ei,HttpStatusCode:Ii,formToJSON:Ai,getAdapter:Pi,mergeConfig:Ti}=Z;class aa{constructor(s="/api"){Rt(this,"client");this.client=Z.create({baseURL:s,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(n=>{const r=localStorage.getItem("token");return r&&(n.headers.Authorization=`Bearer ${r}`),n},n=>Promise.reject(n)),this.client.interceptors.response.use(n=>n,n=>{var r;return((r=n.response)==null?void 0:r.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userPreferences"),window.dispatchEvent(new CustomEvent("auth:logout"))),Promise.reject(n)})}async get(s,n){return(await this.client.get(s,n)).data}async post(s,n,r){return(await this.client.post(s,n,r)).data}async put(s,n,r){return(await this.client.put(s,n,r)).data}async delete(s,n){return(await this.client.delete(s,n)).data}async patch(s,n,r){return(await this.client.patch(s,n,r)).data}}const D=new aa,yn={login:t=>D.post("/auth/login",t),logout:()=>D.post("/auth/logout"),getCurrentUser:()=>D.get("/auth/user"),updateProfile:t=>D.put("/profile",t)},Vt={changePassword:(t,s)=>D.put(`/users-legacy/${t}/password`,s),getUserPreferences:()=>D.get("/system-settings/user-preferences"),updateUserPreferences:t=>D.put("/system-settings/user-preferences",t),getSystemSettings:()=>D.get("/system-settings"),updateSystemSettings:t=>D.put("/system-settings/batch",{settings:t})},jn=({size:t=36,collapsed:s=!1,textColor:n,centered:r=!1})=>s?e.jsxs("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient-collapsed",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#667eea"}),e.jsx("stop",{offset:"100%",stopColor:"#764ba2"})]})}),e.jsx("path",{d:"M50 20 C32 20 20 32 20 50 C20 68 32 80 50 80 C63 80 73 72 77 61 L62 61 C59 65 55 68 50 68 C39 68 32 61 32 50 C32 39 39 32 50 32 C55 32 59 34 62 37 L72 27 C66 22 58 20 50 20 Z M62 50 L80 50 L80 61 L62 61 Z",fill:"url(#gradient-collapsed)"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,width:r?"auto":"100%",justifyContent:r?"center":"flex-start",paddingLeft:r?0:4},children:[e.jsxs("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient-full",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#667eea"}),e.jsx("stop",{offset:"100%",stopColor:"#764ba2"})]})}),e.jsx("path",{d:"M50 20 C32 20 20 32 20 50 C20 68 32 80 50 80 C63 80 73 72 77 61 L62 61 C59 65 55 68 50 68 C39 68 32 61 32 50 C32 39 39 32 50 32 C55 32 59 34 62 37 L72 27 C66 22 58 20 50 20 Z M62 50 L80 50 L80 61 L62 61 Z",fill:"url(#gradient-full)"})]}),e.jsx("span",{style:{fontSize:22,fontWeight:600,color:n||"#667eea",letterSpacing:"0.5px",lineHeight:1},children:"Gesi"})]}),{Header:ia,Sider:la,Content:ca}=Ft;function da(){const t=je(),s=Kn(),{user:n,logout:r}=fe(),[o,i]=m.useState(!1),a=[{key:"/dashboard",icon:e.jsx(Pn,{}),label:"Dashboard",onClick:()=>t("/dashboard")},{key:"/environments",icon:e.jsx(ct,{}),label:"Environments",onClick:()=>t("/environments")},{key:"/nodes",icon:e.jsx(Tn,{}),label:"Nodes",onClick:()=>t("/nodes")},{key:"/discovery",icon:e.jsx(Os,{}),label:"Discovery",onClick:()=>t("/discovery")},{key:"/processes",icon:e.jsx(ct,{}),label:"Processes",onClick:()=>t("/processes")},{key:"alerts-menu",icon:e.jsx(Ht,{}),label:"Alerts",children:[{key:"/alerts",label:"Alert List",onClick:()=>t("/alerts")},{key:"/alerts/rules",label:"Alert Rules",onClick:()=>t("/alerts/rules")}]},{key:"/logs",icon:e.jsx(qt,{}),label:"Logs",onClick:()=>t("/logs")},{key:"/users",icon:e.jsx(Re,{}),label:"Users",onClick:()=>t("/users")}],l=n!=null&&n.is_admin?[{key:"/settings",icon:e.jsx(Ts,{}),label:"Settings",onClick:()=>t("/settings")}]:[],d=[...a,...l],f=[{key:"logout",icon:e.jsx($n,{}),label:"Logout",onClick:()=>{r(),t("/login")}}],u=s.pathname;return e.jsxs(Ft,{style:{minHeight:"100vh"},children:[e.jsxs(la,{trigger:null,collapsible:!0,collapsed:o,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[e.jsx("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"0 20px"},onClick:()=>t("/dashboard"),children:e.jsx(jn,{size:36,collapsed:o,textColor:"#fff"})}),e.jsx(Rn,{theme:"dark",mode:"inline",selectedKeys:[u],items:d})]}),e.jsxs(Ft,{style:{marginLeft:o?80:200,transition:"all 0.2s"},children:[e.jsxs(ia,{style:{padding:"0 24px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 1px 4px rgba(0,21,41,.08)"},children:[e.jsx("div",{children:o?e.jsx(En,{style:{fontSize:18,cursor:"pointer"},onClick:()=>i(!1)}):e.jsx(In,{style:{fontSize:18,cursor:"pointer"},onClick:()=>i(!0)})}),e.jsx(N,{size:"large",children:e.jsx(An,{menu:{items:f},placement:"bottomRight",children:e.jsxs(N,{style:{cursor:"pointer"},children:[e.jsx($s,{icon:e.jsx(Re,{})}),e.jsx("span",{children:(n==null?void 0:n.username)||"User"})]})})})]}),e.jsx(ca,{style:{margin:"24px 16px",padding:24,minHeight:280,background:"#f0f2f5"},children:e.jsx(Jn,{})})]})]})}function ua(){const t=je(),{setUser:s,setToken:n}=fe(),[r,o]=m.useState(!1),i=async a=>{var l,d;o(!0);try{const f=await yn.login(a);if(f.status==="success"&&f.data){const{token:u,user:g}=f.data;n(u),s(g),E.success("Login successful!"),t("/dashboard")}else E.error(f.message||"Login failed")}catch(f){E.error(((d=(l=f.response)==null?void 0:l.data)==null?void 0:d.message)||"Login failed")}finally{o(!1)}};return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:e.jsx(V,{style:{width:400,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:e.jsxs(N,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(jn,{size:64,collapsed:!1,centered:!0}),e.jsx("p",{style:{color:"#666",marginTop:16},children:"Supervisor Management Platform"})]}),e.jsxs(L,{name:"login",onFinish:i,autoComplete:"off",size:"large",children:[e.jsx(L.Item,{name:"username",rules:[{required:!0,message:"Please input your username!"}],children:e.jsx(G,{prefix:e.jsx(Re,{}),placeholder:"Username"})}),e.jsx(L.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(G.Password,{prefix:e.jsx(He,{}),placeholder:"Password"})}),e.jsx(L.Item,{children:e.jsx(A,{type:"primary",htmlType:"submit",loading:r,block:!0,children:"Log in"})})]}),e.jsx("div",{style:{textAlign:"center",color:"#999",fontSize:12},children:"Default: admin / 123456"})]})})})}const ae={getNodes:()=>D.get("/nodes"),getNode:t=>D.get(`/nodes/${t}`),getNodeProcesses:t=>D.get(`/nodes/${t}/processes`),startProcess:(t,s)=>D.post(`/nodes/${t}/processes/${s}/start`),stopProcess:(t,s)=>D.post(`/nodes/${t}/processes/${s}/stop`),restartProcess:(t,s)=>D.post(`/nodes/${t}/processes/${s}/restart`),startAllProcesses:t=>D.post(`/nodes/${t}/processes/start-all`),stopAllProcesses:t=>D.post(`/nodes/${t}/processes/stop-all`),restartAllProcesses:t=>D.post(`/nodes/${t}/processes/restart-all`),getProcessLogs:(t,s)=>D.get(`/nodes/${t}/processes/${s}/logs`),getProcessLogStream:(t,s,n,r)=>D.get(`/nodes/${t}/processes/${s}/logs/stream`,{params:{offset:n===void 0?-1:n,max_lines:r||50}})},ke=(t={})=>{var _;const{onMessage:s,onConnect:n,onDisconnect:r,onError:o,reconnectInterval:i=3e3,maxReconnectAttempts:a=5}=t,{websocketEnabled:l}=fe(),d=m.useRef(null),f=m.useRef(0),u=m.useRef(),g=m.useRef(!0),S=m.useRef(s),b=m.useRef(n),c=m.useRef(r),p=m.useRef(o);m.useEffect(()=>{S.current=s,b.current=n,c.current=r,p.current=o},[s,n,r,o]);const y=m.useCallback(()=>{if(!fe.getState().websocketEnabled)return;const P=localStorage.getItem("token");if(!P||d.current&&(d.current.readyState===WebSocket.CONNECTING||d.current.readyState===WebSocket.OPEN))return;const T=window.location.protocol==="https:"?"wss:":"ws:",k=window.location.host,w=`${T}//${k}/ws?token=${P}`;try{const I=new WebSocket(w);I.onopen=()=>{var z;f.current=0,(z=b.current)==null||z.call(b)},I.onmessage=z=>{var B;try{const J=z.data.split(`
`).filter(X=>X.trim());for(const X of J)try{const H=JSON.parse(X);(B=S.current)==null||B.call(S,H)}catch(H){console.error("Error parsing WebSocket message:",H)}}catch(J){console.error("Error processing WebSocket message:",J)}},I.onclose=()=>{var z;(z=c.current)==null||z.call(c),g.current&&f.current<a&&(f.current++,u.current&&clearTimeout(u.current),u.current=window.setTimeout(y,i))},I.onerror=()=>{var z;(z=p.current)==null||z.call(p,new Event("error"))},d.current=I}catch(I){console.error("Failed to create WebSocket connection:",I)}},[i,a]),h=m.useCallback(()=>{g.current=!1,u.current&&clearTimeout(u.current),d.current&&(d.current.close(),d.current=null)},[]),v=m.useCallback(P=>{d.current&&d.current.readyState===WebSocket.OPEN?d.current.send(JSON.stringify(P)):console.error("WebSocket is not connected")},[]);return m.useEffect(()=>{if(localStorage.getItem("token")&&l){g.current=!0;const T=window.setTimeout(()=>{y()},100);return()=>{clearTimeout(T),g.current=!1,u.current&&clearTimeout(u.current),d.current&&(d.current.close(),d.current=null)}}return()=>{g.current=!1,u.current&&clearTimeout(u.current),d.current&&(d.current.close(),d.current=null)}},[l]),{send:v,disconnect:h,reconnect:y,isConnected:((_=d.current)==null?void 0:_.readyState)===WebSocket.OPEN}};function fa(){const t=je(),{nodes:s,setNodes:n,systemStats:r,setSystemStats:o}=fe(),[i,a]=m.useState(!1),[l,d]=m.useState(0);m.useEffect(()=>{f(),u()},[]);const f=async()=>{a(!0);try{const p=await ae.getNodes();n(p.nodes||[])}catch(p){console.error("Failed to load nodes:",p)}finally{a(!1)}},u=async()=>{try{const p=await fetch("/api/alerts/statistics?time_range=24h",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(p.ok){const y=await p.json();d(y.active_alerts||0)}}catch(p){console.error("Failed to load alert stats:",p)}};ke({onMessage:p=>{p.type==="nodes_update"?n(p.data):p.type==="system_stats"&&o(p.data)}});const g=s.length,S=s.filter(p=>p.is_connected).length,b=(r==null?void 0:r.running_processes)||0,c=[{title:"Node Name",dataIndex:"name",key:"name",render:p=>e.jsx("a",{onClick:()=>t(`/nodes/${p}`),children:p})},{title:"Environment",dataIndex:"environment",key:"environment",render:p=>e.jsx(M,{color:"blue",children:p})},{title:"Host",key:"host",render:(p,y)=>`${y.host}:${y.port}`},{title:"Status",dataIndex:"is_connected",key:"status",render:p=>p?e.jsx(M,{icon:e.jsx(ie,{}),color:"success",children:"Online"}):e.jsx(M,{icon:e.jsx(ue,{}),color:"error",children:"Offline"})},{title:"Processes",dataIndex:"process_count",key:"process_count",render:p=>p||0},{title:"Action",key:"action",render:(p,y)=>e.jsx(A,{type:"link",size:"small",onClick:()=>t(`/nodes/${y.name}`),children:"View Details"})}];return e.jsxs("div",{children:[e.jsxs(Ke,{gutter:16,style:{marginBottom:24},children:[e.jsx(he,{xs:24,sm:12,lg:6,children:e.jsx(V,{children:e.jsx(ye,{title:"Total Nodes",value:g,prefix:null,valueStyle:{color:"#1890ff"}})})}),e.jsx(he,{xs:24,sm:12,lg:6,children:e.jsx(V,{children:e.jsx(ye,{title:"Online Nodes",value:S,prefix:e.jsx(ie,{}),valueStyle:{color:"#3f8600"}})})}),e.jsx(he,{xs:24,sm:12,lg:6,children:e.jsx(V,{children:e.jsx(ye,{title:"Running Processes",value:b,prefix:e.jsx(_e,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(he,{xs:24,sm:12,lg:6,children:e.jsx(V,{children:e.jsx(ye,{title:"Active Alerts",value:l,prefix:e.jsx(Ht,{}),valueStyle:{color:l>0?"#cf1322":"#999"}})})})]}),e.jsx(V,{title:"Nodes Overview",extra:e.jsx(A,{type:"primary",onClick:f,loading:i,children:"Refresh"}),children:e.jsx(pe,{columns:c,dataSource:s,rowKey:"name",loading:i,pagination:{pageSize:10}})})]})}function ha(t,s){const[n,r]=m.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):s}catch(i){return console.warn(`Error reading localStorage key "${t}":`,i),s}});return[n,i=>{try{const a=i instanceof Function?i(n):i;r(a),window.localStorage.setItem(t,JSON.stringify(a))}catch(a){console.warn(`Error setting localStorage key "${t}":`,a)}}]}function ma(t,s){const[n,r]=m.useState(t);return m.useEffect(()=>{const o=setTimeout(()=>{r(t)},s);return()=>{clearTimeout(o)}},[t,s]),n}function pa(t,s,n){const r=ma(s,300),o=m.useMemo(()=>t.filter(l=>{if(r){const d=r.toLowerCase();if(!(l.name.toLowerCase().includes(d)||l.host.toLowerCase().includes(d)||l.environment.toLowerCase().includes(d)||l.username&&l.username.toLowerCase().includes(d)))return!1}if(n.status){const d=l.is_connected;if(n.status==="online"&&!d||n.status==="offline"&&d)return!1}if(n.environment&&l.environment!==n.environment)return!1;if(n.processCountRange){const d=l.process_count||0,[f,u]=n.processCountRange;if(f!==void 0&&d<f||u!==void 0&&d>u)return!1}return!0}),[t,r,n]),i=m.useMemo(()=>{const l=new Set(t.map(d=>d.environment));return Array.from(l).sort()},[t]),a=m.useMemo(()=>{const l=t.length,d=o.length,f=o.filter(g=>g.is_connected).length,u=d-f;return{total:l,filtered:d,online:f,offline:u,isFiltered:d!==l}},[t.length,o]);return{filteredNodes:o,availableEnvironments:i,stats:a,debouncedSearch:r}}const ga={md:768};function xa(){const[t,s]=m.useState(!1);return m.useEffect(()=>{const n=()=>{s(window.innerWidth<ga.md)};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),t}const ya=({value:t,onChange:s,disabled:n=!1,size:r="middle"})=>e.jsxs(N.Compact,{size:r,role:"radiogroup","aria-label":"View mode selection",children:[e.jsx(A,{type:t==="card"?"primary":"default",icon:e.jsx(ct,{}),onClick:()=>s("card"),disabled:n,role:"radio","aria-checked":t==="card","aria-label":"Card view",children:"Cards"}),e.jsx(A,{type:t==="list"?"primary":"default",icon:e.jsx(On,{}),onClick:()=>s("list"),disabled:n,role:"radio","aria-checked":t==="list","aria-label":"List view",children:"List"})]}),ja=({value:t,onChange:s,placeholder:n="Search nodes...",debounceMs:r=300,allowClear:o=!0,size:i="middle",style:a})=>{const[l,d]=m.useState(t);m.useEffect(()=>{d(t)},[t]),m.useEffect(()=>{const g=setTimeout(()=>{l!==t&&s(l)},r);return()=>clearTimeout(g)},[l,s,t,r]);const f=g=>{d(g.target.value)},u=()=>{d(""),s("")};return e.jsx(G,{prefix:e.jsx(Ae,{}),placeholder:n,value:l,onChange:f,allowClear:o,onClear:u,size:i,style:a,"aria-label":"Search nodes",role:"searchbox","aria-describedby":"search-help"})},ba=({filters:t,onFiltersChange:s,environments:n,totalNodes:r,filteredNodes:o,size:i="middle"})=>{var u,g;const a=(S,b)=>{const c={...t};b==null||b===""?delete c[S]:c[S]=b,s(c)},l=()=>{s({})},d=Object.keys(t).length>0,f=o!==r;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},role:"region","aria-label":"Node filters",children:[e.jsxs(N,{size:"middle",wrap:!0,children:[e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"status-filter-label",children:"Status:"}),e.jsxs(se,{placeholder:"All",value:t.status,onChange:S=>a("status",S),allowClear:!0,size:i,style:{minWidth:100},"aria-labelledby":"status-filter-label","aria-label":"Filter by node status",children:[e.jsx(se.Option,{value:"online",children:"Online"}),e.jsx(se.Option,{value:"offline",children:"Offline"})]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"environment-filter-label",children:"Environment:"}),e.jsx(se,{placeholder:"All",value:t.environment,onChange:S=>a("environment",S),allowClear:!0,size:i,style:{minWidth:120},"aria-labelledby":"environment-filter-label","aria-label":"Filter by environment",children:n.map(S=>e.jsx(se.Option,{value:S,children:S},S))})]}),e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:14,color:"#666"},id:"process-filter-label",children:"Processes:"}),e.jsxs(N.Compact,{children:[e.jsx(me,{placeholder:"Min",value:(u=t.processCountRange)==null?void 0:u[0],onChange:S=>{const b=t.processCountRange||[void 0,void 0];a("processCountRange",[S,b[1]])},size:i,style:{width:80},min:0,"aria-label":"Minimum process count"}),e.jsx(me,{placeholder:"Max",value:(g=t.processCountRange)==null?void 0:g[1],onChange:S=>{const b=t.processCountRange||[void 0,void 0];a("processCountRange",[b[0],S])},size:i,style:{width:80},min:0,"aria-label":"Maximum process count"})]})]}),d&&e.jsx(A,{type:"text",icon:e.jsx(Ls,{}),onClick:l,size:i,"aria-label":"Clear all filters",children:"Clear All"})]}),f&&e.jsxs("div",{style:{marginLeft:"auto",fontSize:14,color:"#666"},"aria-live":"polite","aria-label":`Showing ${o} of ${r} nodes`,children:["Showing ",o," of ",r," nodes"]}),d&&e.jsx("div",{style:{width:"100%",marginTop:8},role:"region","aria-label":"Active filters",children:e.jsxs(N,{size:4,wrap:!0,children:[t.status&&e.jsxs(M,{closable:!0,onClose:()=>a("status",void 0),color:"blue","aria-label":`Remove status filter: ${t.status}`,children:["Status: ",t.status]}),t.environment&&e.jsxs(M,{closable:!0,onClose:()=>a("environment",void 0),color:"green","aria-label":`Remove environment filter: ${t.environment}`,children:["Environment: ",t.environment]}),t.processCountRange&&e.jsxs(M,{closable:!0,onClose:()=>a("processCountRange",void 0),color:"orange","aria-label":`Remove process count filter: ${t.processCountRange[0]||0}-${t.processCountRange[1]||"∞"}`,children:["Processes: ",t.processCountRange[0]||0,"-",t.processCountRange[1]||"∞"]})]})})]})},We=typeof window<"u"?m.useLayoutEffect:m.useEffect;function ks(t){if(t!==void 0)switch(typeof t){case"number":return t;case"string":{if(t.endsWith("px"))return parseFloat(t);break}}}function wa({box:t,defaultHeight:s,defaultWidth:n,disabled:r,element:o,mode:i,style:a}){const{styleHeight:l,styleWidth:d}=m.useMemo(()=>({styleHeight:ks(a==null?void 0:a.height),styleWidth:ks(a==null?void 0:a.width)}),[a==null?void 0:a.height,a==null?void 0:a.width]),[f,u]=m.useState({height:s,width:n}),g=r||l!==void 0||i==="only-width"||l!==void 0&&d!==void 0;return We(()=>{if(o===null||g)return;const S=new ResizeObserver(b=>{for(const c of b){const{contentRect:p,target:y}=c;o===y&&u(h=>h.height===p.height&&h.width===p.width?h:{height:p.height,width:p.width})}});return S.observe(o,{box:t}),()=>{S==null||S.unobserve(o)}},[t,g,o,l,d]),m.useMemo(()=>({height:l??f.height,width:d??f.width}),[f,l,d])}function va(t){const s=m.useRef(()=>{throw new Error("Cannot call during render.")});return We(()=>{s.current=t},[t]),m.useCallback(n=>{var r;return(r=s.current)==null?void 0:r.call(s,n)},[s])}function Pt({containerElement:t,direction:s,isRtl:n,scrollOffset:r}){return r}function Se(t,s="Assertion error"){if(!t)throw console.error(s),Error(s)}function qe(t,s){if(t===s)return!0;if(!!t!=!!s||(Se(t!==void 0),Se(s!==void 0),Object.keys(t).length!==Object.keys(s).length))return!1;for(const n in t)if(!Object.is(s[n],t[n]))return!1;return!0}function bn({cachedBounds:t,itemCount:s,itemSize:n}){if(s===0)return 0;if(typeof n=="number")return s*n;{const r=t.get(t.size===0?0:t.size-1);Se(r!==void 0,"Unexpected bounds cache miss");const o=(r.scrollOffset+r.size)/t.size;return s*o}}function Sa({align:t,cachedBounds:s,index:n,itemCount:r,itemSize:o,containerScrollOffset:i,containerSize:a}){if(n<0||n>=r)throw RangeError(`Invalid index specified: ${n}`,{cause:`Index ${n} is not within the range of 0 - ${r-1}`});const l=bn({cachedBounds:s,itemCount:r,itemSize:o}),d=s.get(n),f=Math.max(0,Math.min(l-a,d.scrollOffset)),u=Math.max(0,d.scrollOffset-a+d.size);switch(t==="smart"&&(i>=u&&i<=f?t="auto":t="center"),t){case"start":return f;case"end":return u;case"center":return d.scrollOffset<=a/2?0:d.scrollOffset+d.size/2>=l-a/2?l-a:d.scrollOffset+d.size/2-a/2;case"auto":default:return i>=u&&i<=f?i:i<u?u:f}}function Tt({cachedBounds:t,containerScrollOffset:s,containerSize:n,itemCount:r,overscanCount:o}){const i=r-1;let a=0,l=-1,d=0,f=-1,u=0;for(;u<i;){const g=t.get(u);if(g.scrollOffset+g.size>s)break;u++}for(a=u,d=Math.max(0,a-o);u<i;){const g=t.get(u);if(g.scrollOffset+g.size>=s+n)break;u++}return l=Math.min(i,u),f=Math.min(r-1,l+o),a<0&&(a=0,l=-1,d=0,f=-1),{startIndexVisible:a,stopIndexVisible:l,startIndexOverscan:d,stopIndexOverscan:f}}function _a({itemCount:t,itemProps:s,itemSize:n}){const r=new Map;return{get(o){for(Se(o<t,`Invalid index ${o}`);r.size-1<o;){const a=r.size;let l;switch(typeof n){case"function":{l=n(a,s);break}case"number":{l=n;break}}if(a===0)r.set(a,{size:l,scrollOffset:0});else{const d=r.get(a-1);Se(d!==void 0,`Unexpected bounds cache miss for index ${o}`),r.set(a,{scrollOffset:d.scrollOffset+d.size,size:l})}}const i=r.get(o);return Se(i!==void 0,`Unexpected bounds cache miss for index ${o}`),i},set(o,i){r.set(o,i)},get size(){return r.size}}}function Ca({itemCount:t,itemProps:s,itemSize:n}){return m.useMemo(()=>_a({itemCount:t,itemProps:s,itemSize:n}),[t,s,n])}function ka({containerSize:t,itemSize:s}){let n;switch(typeof s){case"string":{Se(s.endsWith("%"),`Invalid item size: "${s}"; string values must be percentages (e.g. "100%")`),Se(t!==void 0,"Container size must be defined if a percentage item size is specified"),n=t*parseInt(s)/100;break}default:{n=s;break}}return n}function Ra({containerElement:t,containerStyle:s,defaultContainerSize:n=0,direction:r,isRtl:o=!1,itemCount:i,itemProps:a,itemSize:l,onResize:d,overscanCount:f}){const{height:u=n,width:g=n}=wa({defaultHeight:n,defaultWidth:void 0,element:t,mode:"only-height",style:s}),S=m.useRef({height:0,width:0}),b=u,c=ka({containerSize:b,itemSize:l});m.useLayoutEffect(()=>{if(typeof d=="function"){const B=S.current;(B.height!==u||B.width!==g)&&(d({height:u,width:g},{...B}),B.height=u,B.width=g)}},[u,d,g]);const p=Ca({itemCount:i,itemProps:a,itemSize:c}),y=m.useCallback(B=>p.get(B),[p]),[h,v]=m.useState(()=>Tt({cachedBounds:p,containerScrollOffset:0,containerSize:b,itemCount:i,overscanCount:f})),{startIndexVisible:_,startIndexOverscan:P,stopIndexVisible:T,stopIndexOverscan:k}={startIndexVisible:Math.min(i-1,h.startIndexVisible),startIndexOverscan:Math.min(i-1,h.startIndexOverscan),stopIndexVisible:Math.min(i-1,h.stopIndexVisible),stopIndexOverscan:Math.min(i-1,h.stopIndexOverscan)},w=m.useCallback(()=>bn({cachedBounds:p,itemCount:i,itemSize:c}),[p,i,c]),I=m.useCallback(B=>{const J=Pt({containerElement:t,direction:r,isRtl:o,scrollOffset:B});return Tt({cachedBounds:p,containerScrollOffset:J,containerSize:b,itemCount:i,overscanCount:f})},[p,t,b,r,o,i,f]);We(()=>{const B=(t==null?void 0:t.scrollTop)??0;v(I(B))},[t,r,I]),We(()=>{if(!t)return;const B=()=>{v(J=>{const{scrollLeft:X,scrollTop:H}=t,q=Pt({containerElement:t,direction:r,isRtl:o,scrollOffset:H}),Y=Tt({cachedBounds:p,containerScrollOffset:q,containerSize:b,itemCount:i,overscanCount:f});return qe(Y,J)?J:Y})};return t.addEventListener("scroll",B),()=>{t.removeEventListener("scroll",B)}},[p,t,b,r,i,f]);const z=va(({align:B="auto",containerScrollOffset:J,index:X})=>{let H=Sa({align:B,cachedBounds:p,containerScrollOffset:J,containerSize:b,index:X,itemCount:i,itemSize:c});if(t){if(H=Pt({containerElement:t,direction:r,isRtl:o,scrollOffset:H}),typeof t.scrollTo!="function"){const q=I(H);qe(h,q)||v(q)}return H}});return{getCellBounds:y,getEstimatedSize:w,scrollToIndex:z,startIndexOverscan:P,startIndexVisible:_,stopIndexOverscan:k,stopIndexVisible:T}}function Ea(t){return m.useMemo(()=>t,Object.values(t))}function Ia(t,s){const{ariaAttributes:n,style:r,...o}=t,{ariaAttributes:i,style:a,...l}=s;return qe(n,i)&&qe(r,a)&&qe(o,l)}function Aa(t){return t!=null&&typeof t=="object"&&"getAverageRowHeight"in t&&typeof t.getAverageRowHeight=="function"}const Pa="data-react-window-index";function Ta({children:t,className:s,defaultHeight:n=0,listRef:r,onResize:o,onRowsRendered:i,overscanCount:a=3,rowComponent:l,rowCount:d,rowHeight:f,rowProps:u,tagName:g="div",style:S,...b}){const c=Ea(u),p=m.useMemo(()=>m.memo(l,Ia),[l]),[y,h]=m.useState(null),v=Aa(f),_=m.useMemo(()=>v?H=>f.getRowHeight(H)??f.getAverageRowHeight():f,[v,f]),{getCellBounds:P,getEstimatedSize:T,scrollToIndex:k,startIndexOverscan:w,startIndexVisible:I,stopIndexOverscan:z,stopIndexVisible:B}=Ra({containerElement:y,containerStyle:S,defaultContainerSize:n,direction:"vertical",itemCount:d,itemProps:c,itemSize:_,onResize:o,overscanCount:a});m.useImperativeHandle(r,()=>({get element(){return y},scrollToRow({align:H="auto",behavior:q="auto",index:Y}){const F=k({align:H,containerScrollOffset:(y==null?void 0:y.scrollTop)??0,index:Y});typeof(y==null?void 0:y.scrollTo)=="function"&&y.scrollTo({behavior:q,top:F})}}),[y,k]),We(()=>{if(!y)return;const H=Array.from(y.children).filter((q,Y)=>{if(q.hasAttribute("aria-hidden"))return!1;const F=`${w+Y}`;return q.setAttribute(Pa,F),!0});if(v)return f.observeRowElements(H)},[y,v,f,w,z]),m.useEffect(()=>{w>=0&&z>=0&&i&&i({startIndex:I,stopIndex:B},{startIndex:w,stopIndex:z})},[i,w,I,z,B]);const J=m.useMemo(()=>{const H=[];if(d>0)for(let q=w;q<=z;q++){const Y=P(q);H.push(m.createElement(p,{...c,ariaAttributes:{"aria-posinset":q+1,"aria-setsize":d,role:"listitem"},key:q,index:q,style:{position:"absolute",left:0,transform:`translateY(${Y.scrollOffset}px)`,height:v?void 0:Y.size,width:"100%"}}))}return H},[p,P,v,d,c,w,z]),X=e.jsx("div",{"aria-hidden":!0,style:{height:T(),width:"100%",zIndex:-1}});return m.createElement(g,{role:"list",...b,className:s,ref:h,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...S}},J,t,X)}const{Text:$t}=ht,$a=48,Rs=40,Oa=({nodes:t,loading:s=!1,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:i,searchQuery:a="",height:l=400})=>{const[d,f]=m.useState({}),u=m.useMemo(()=>{let h=t.map(v=>({...v,key:v.name,statusColor:v.is_connected?"#52c41a":"#ff4d4f",displayName:v.name}));return d.columnKey&&(h=h.sort((v,_)=>{const P=v[d.columnKey],T=_[d.columnKey];if(typeof P=="string"&&typeof T=="string"){const k=P.localeCompare(T);return d.order==="descend"?-k:k}if(typeof P=="number"&&typeof T=="number"){const k=P-T;return d.order==="descend"?-k:k}if(typeof P=="boolean"&&typeof T=="boolean"){const k=Number(P)-Number(T);return d.order==="descend"?-k:k}return 0})),h},[t,d]),g=(h,v)=>{if(!v)return h;const _=new RegExp(`(${v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return h.split(_).map((T,k)=>_.test(T)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:T},k):T)},S=m.useCallback((h,v)=>{r(v?[...n,h]:n.filter(_=>_!==h))},[n,r]),b=m.useCallback(h=>{r(h?u.map(v=>v.key):[])},[u,r]),c=m.useCallback(h=>{const v=d.columnKey===h&&d.order==="ascend"?"descend":"ascend";f({columnKey:h,order:v})},[d]),p=m.useCallback(({index:h,style:v})=>{const _=u[h],P=n.includes(_.key);return e.jsxs("div",{style:{...v,display:"flex",alignItems:"center",borderBottom:"1px solid #f0f0f0",backgroundColor:P?"#e6f7ff":"white",cursor:"pointer"},onClick:()=>o(_.name),children:[e.jsx("div",{style:{width:50,textAlign:"center",paddingLeft:16},children:e.jsx(Qt,{checked:P,onChange:T=>{T.stopPropagation(),S(_.key,T.target.checked)}})}),e.jsx("div",{style:{width:80,textAlign:"center"},children:e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:_.statusColor,margin:"0 auto"}})}),e.jsx("div",{style:{width:200,paddingLeft:8},children:e.jsx(A,{type:"link",onClick:T=>{T.stopPropagation(),o(_.name)},style:{padding:0,height:"auto",fontWeight:500},children:g(_.name,a)})}),e.jsx("div",{style:{width:120,paddingLeft:8},children:e.jsx(M,{color:"blue",children:g(_.environment||"default",a)})}),e.jsx("div",{style:{width:180,paddingLeft:8},children:e.jsx($t,{code:!0,style:{fontSize:12},children:g(`${_.host}:${_.port}`,a)})}),e.jsx("div",{style:{width:100,paddingLeft:8},children:_.username?e.jsx($t,{type:"secondary",style:{fontSize:12},children:g(_.username,a)}):e.jsx($t,{type:"secondary",style:{fontSize:12},children:"-"})}),e.jsx("div",{style:{width:100,textAlign:"center"},children:e.jsx(M,{color:_.process_count>0?"blue":"default",children:_.process_count||0})}),e.jsx("div",{style:{width:100,paddingLeft:8},children:e.jsx(M,{icon:_.is_connected?e.jsx(ie,{}):e.jsx(ue,{}),color:_.is_connected?"success":"error",children:_.is_connected?"Online":"Offline"})}),e.jsx("div",{style:{width:120,textAlign:"center"},children:e.jsxs(N,{size:"small",children:[e.jsx(ve,{title:"View Details",children:e.jsx(A,{type:"text",size:"small",icon:e.jsx(mt,{}),onClick:T=>{T.stopPropagation(),o(_.name)}})}),i&&e.jsx(ve,{title:"Refresh Node",children:e.jsx(A,{type:"text",size:"small",icon:e.jsx(ee,{}),onClick:T=>{T.stopPropagation(),i(_.name)}})})]})})]})},[u,n,a,o,i,S]),y=()=>{const h=u.length>0&&n.length===u.length,v=n.length>0&&n.length<u.length;return e.jsxs("div",{style:{height:Rs,display:"flex",alignItems:"center",borderBottom:"2px solid #f0f0f0",backgroundColor:"#fafafa",fontWeight:"bold"},children:[e.jsx("div",{style:{width:50,textAlign:"center",paddingLeft:16},children:e.jsx(Qt,{checked:h,indeterminate:v,onChange:_=>b(_.target.checked)})}),e.jsxs("div",{style:{width:80,textAlign:"center",cursor:"pointer"},onClick:()=>c("is_connected"),children:["Status ",d.columnKey==="is_connected"&&(d.order==="ascend"?"↑":"↓")]}),e.jsxs("div",{style:{width:200,paddingLeft:8,cursor:"pointer"},onClick:()=>c("name"),children:["Name ",d.columnKey==="name"&&(d.order==="ascend"?"↑":"↓")]}),e.jsxs("div",{style:{width:120,paddingLeft:8,cursor:"pointer"},onClick:()=>c("environment"),children:["Environment ",d.columnKey==="environment"&&(d.order==="ascend"?"↑":"↓")]}),e.jsx("div",{style:{width:180,paddingLeft:8},children:"Host:Port"}),e.jsx("div",{style:{width:100,paddingLeft:8},children:"User"}),e.jsxs("div",{style:{width:100,textAlign:"center",cursor:"pointer"},onClick:()=>c("process_count"),children:["Processes ",d.columnKey==="process_count"&&(d.order==="ascend"?"↑":"↓")]}),e.jsx("div",{style:{width:100,paddingLeft:8},children:"Status"}),e.jsx("div",{style:{width:120,textAlign:"center"},children:"Actions"})]})};return s?e.jsx("div",{style:{textAlign:"center",padding:50},children:"Loading..."}):e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:6},children:[e.jsx(y,{}),e.jsx(Ta,{height:l-Rs,itemCount:u.length,itemSize:$a,width:"100%",children:p}),e.jsxs("div",{style:{padding:"8px 16px",borderTop:"1px solid #f0f0f0",backgroundColor:"#fafafa",fontSize:14,color:"#666"},children:["Total: ",u.length," nodes",n.length>0&&` | Selected: ${n.length}`]})]})},{Text:Ot}=ht,Es=100,La=({nodes:t,loading:s=!1,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:i,searchQuery:a=""})=>{const[l,d]=m.useState({}),[f,u]=m.useState(!0);if(t.length>=Es&&f)try{return e.jsxs("div",{children:[t.length>=Es&&e.jsx(Pe,{message:`Large dataset detected (${t.length} nodes). Using virtualized table for better performance.`,type:"info",showIcon:!0,style:{marginBottom:16},action:e.jsx(A,{size:"small",type:"text",onClick:()=>u(!1),children:"Use Standard Table"})}),e.jsx(Oa,{nodes:t,loading:s,selectedNodes:n,onSelectionChange:r,onNodeClick:o,onRefreshNode:i,searchQuery:a,height:600})]})}catch(h){console.warn("Virtual scrolling failed, falling back to standard table:",h),u(!1)}const S=m.useMemo(()=>t.map(h=>({...h,key:h.name,statusColor:h.is_connected?"#52c41a":"#ff4d4f",displayName:h.name})),[t]),b=(h,v)=>{if(!v)return h;const _=new RegExp(`(${v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return h.split(_).map((T,k)=>_.test(T)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:T},k):T)},c=[{title:"Status",dataIndex:"is_connected",key:"status",width:80,align:"center",sorter:(h,v)=>Number(h.is_connected)-Number(v.is_connected),sortOrder:l.columnKey==="status"?l.order:null,render:h=>e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:h?"#52c41a":"#ff4d4f",margin:"0 auto"}})},{title:"Name",dataIndex:"name",key:"name",width:200,sorter:(h,v)=>h.name.localeCompare(v.name),sortOrder:l.columnKey==="name"?l.order:null,render:h=>e.jsx(A,{type:"link",onClick:()=>o(h),style:{padding:0,height:"auto",fontWeight:500},children:b(h,a)})},{title:"Environment",dataIndex:"environment",key:"environment",width:120,responsive:["md"],sorter:(h,v)=>h.environment.localeCompare(v.environment),sortOrder:l.columnKey==="environment"?l.order:null,render:h=>e.jsx(M,{color:"blue",children:b(h||"default",a)})},{title:"Host:Port",key:"hostPort",width:180,responsive:["lg"],render:(h,v)=>e.jsx(Ot,{code:!0,style:{fontSize:12},children:b(`${v.host}:${v.port}`,a)})},{title:"User",dataIndex:"username",key:"username",width:100,responsive:["xl"],render:h=>h?e.jsx(Ot,{type:"secondary",style:{fontSize:12},children:b(h,a)}):e.jsx(Ot,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"Processes",dataIndex:"process_count",key:"process_count",width:100,align:"center",responsive:["md"],sorter:(h,v)=>(h.process_count||0)-(v.process_count||0),sortOrder:l.columnKey==="process_count"?l.order:null,render:h=>e.jsx(M,{color:h>0?"blue":"default",children:h||0})},{title:"Status",key:"connectionStatus",width:100,responsive:["sm"],render:(h,v)=>e.jsx(M,{icon:v.is_connected?e.jsx(ie,{}):e.jsx(ue,{}),color:v.is_connected?"success":"error",children:v.is_connected?"Online":"Offline"})},{title:"Actions",key:"actions",width:120,align:"center",render:(h,v)=>e.jsxs(N,{size:"small",children:[e.jsx(ve,{title:"View Details",children:e.jsx(A,{type:"text",size:"small",icon:e.jsx(mt,{}),onClick:_=>{_.stopPropagation(),o(v.name)}})}),i&&e.jsx(ve,{title:"Refresh Node",children:e.jsx(A,{type:"text",size:"small",icon:e.jsx(ee,{}),onClick:_=>{_.stopPropagation(),i(v.name)}})})]})}],p={selectedRowKeys:n,onChange:h=>{r(h)},getCheckboxProps:h=>({name:h.name})},y=(h,v,_)=>{d(_)};return e.jsx(pe,{columns:c,dataSource:S,rowSelection:p,loading:s,onChange:y,pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(h,v)=>`${v[0]}-${v[1]} of ${h} nodes`,pageSizeOptions:["10","20","50","100"],defaultPageSize:20},scroll:{x:800},size:"middle",rowClassName:h=>n.includes(h.key)?"ant-table-row-selected":"",onRow:h=>({onClick:()=>o(h.name),style:{cursor:"pointer"}}),locale:{emptyText:a?`No nodes found matching "${a}"`:"No nodes available"}})},{Text:Is}=ht,za=({viewMode:t,onViewModeChange:s,searchQuery:n,onSearchChange:r,filters:o,onFiltersChange:i,environments:a,totalNodes:l,filteredNodes:d,selectedNodes:f,onBulkAction:u,onRefreshAll:g,loading:S=!1,isMobile:b=!1})=>{const c=f.length>0,p=d!==l,y=h=>{u({type:h,nodeIds:f})};return e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16,marginBottom:16},children:[e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:24},children:"Nodes"}),e.jsx(Is,{type:"secondary",style:{fontSize:14},children:p?e.jsxs(e.Fragment,{children:["Showing ",d," of ",l," nodes"]}):e.jsxs(e.Fragment,{children:[l," nodes total"]})})]}),!b&&e.jsxs(e.Fragment,{children:[e.jsx(ze,{type:"vertical",style:{height:32}}),e.jsx(ya,{value:t,onChange:s,disabled:S})]})]})}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:g,loading:S,children:b?"":"Refresh All"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",gap:16,alignItems:b?"stretch":"flex-start",marginBottom:c?16:0},children:[e.jsx("div",{style:{flex:b?"none":"0 0 300px"},children:e.jsx(ja,{value:n,onChange:r,placeholder:"Search by name, host, environment...",size:b?"large":"middle"})}),e.jsx("div",{style:{flex:1,minWidth:0},children:e.jsx(ba,{filters:o,onFiltersChange:i,environments:a,totalNodes:l,filteredNodes:d,size:b?"large":"middle"})})]}),c&&e.jsx(Pe,{type:"info",showIcon:!0,style:{marginBottom:16},message:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12},children:[e.jsxs(Is,{strong:!0,children:[f.length," node",f.length>1?"s":""," selected"]}),e.jsxs(N,{size:"small",wrap:!0,children:[e.jsx(A,{size:"small",icon:e.jsx(_e,{}),onClick:()=>y("start_all"),children:"Start All Processes"}),e.jsx(A,{size:"small",icon:e.jsx(Te,{}),onClick:()=>y("stop_all"),children:"Stop All Processes"}),e.jsx(A,{size:"small",icon:e.jsx(Ln,{}),onClick:()=>y("restart_all"),children:"Restart All Processes"}),e.jsx(A,{size:"small",icon:e.jsx(ee,{}),onClick:()=>y("refresh_all"),children:"Refresh Status"}),e.jsx(ze,{type:"vertical"}),e.jsx(A,{size:"small",danger:!0,icon:e.jsx(Je,{}),onClick:()=>y("delete_selected"),children:"Remove Selected"})]})]})})]})},Fa=50,Na=20,Da=({nodes:t,onNodeClick:s,searchQuery:n="",pageSize:r=Fa})=>{const[o,i]=m.useState(1),[a,l]=m.useState(r),d=t.length>Na,f=m.useMemo(()=>{if(!d)return t;const g=(o-1)*a;return t.slice(g,g+a)},[t,o,a,d]);Kt.useEffect(()=>{i(1)},[t.length]);const u=(g,S)=>{i(g),S&&S!==a&&l(S)};return e.jsxs("div",{children:[d&&e.jsx(Pe,{message:`Large dataset (${t.length} nodes). Showing ${a} nodes per page for better performance.`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(Ke,{gutter:[16,16],children:f.map(g=>e.jsx(he,{xs:24,sm:12,lg:8,children:e.jsx(Ua,{node:g,onView:()=>s(g.name),searchQuery:n})},g.name))}),d&&e.jsx("div",{style:{marginTop:24,textAlign:"center",padding:"16px 0",borderTop:"1px solid #f0f0f0"},children:e.jsx(zn,{current:o,total:t.length,pageSize:a,showSizeChanger:!0,showQuickJumper:!0,showTotal:(g,S)=>`${S[0]}-${S[1]} of ${g} nodes`,pageSizeOptions:["20","50","100","200"],onChange:u,onShowSizeChange:u})})]})};function Ua({node:t,onView:s,searchQuery:n=""}){const r=t.is_connected,o=i=>{if(!n)return i;const a=new RegExp(`(${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return i.split(a).map((d,f)=>a.test(d)?e.jsx("mark",{style:{backgroundColor:"#fff566",padding:0},children:d},f):d)};return e.jsx(V,{hoverable:!0,style:{height:"100%",cursor:"pointer"},onClick:s,children:e.jsxs(N,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:8,background:"#1890ff20",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ie,{style:{fontSize:24,color:"#1890ff"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:o(t.name)}),e.jsx(M,{color:"blue",style:{marginTop:4},children:o(t.environment||"default")})]})]}),e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:r?"#52c41a":"#ff4d4f"}})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#666",fontSize:14,marginBottom:4},children:o(`${t.host}:${t.port}`)}),t.username&&e.jsxs("div",{style:{color:"#666",fontSize:14},children:["User: ",o(t.username)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:16,borderTop:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{textAlign:"center",flex:1},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#1890ff"},children:t.process_count||0}),e.jsx("div",{style:{fontSize:12,color:"#999"},children:"Processes"})]}),e.jsx("div",{style:{textAlign:"center",flex:1,borderLeft:"1px solid #f0f0f0"},children:e.jsx(M,{icon:r?e.jsx(ie,{}):e.jsx(ue,{}),color:r?"success":"error",children:r?"Online":"Offline"})})]}),e.jsx(A,{type:"primary",block:!0,icon:e.jsx(mt,{}),onClick:i=>{i.stopPropagation(),s()},children:"View Details"})]})})}class Lt extends m.Component{constructor(n){super(n);Rt(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r),this.props.onError&&this.props.onError(n,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx(zs,{status:"error",title:"Something went wrong",subTitle:"An unexpected error occurred while rendering this component.",extra:[e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:this.handleRetry,children:"Try Again"},"retry"),e.jsx(A,{onClick:()=>window.location.reload(),children:"Reload Page"},"reload")],children:!1}):this.props.children}}const{Search:Ba}=G,{Option:Ve}=se,wn=({visible:t,onClose:s,nodeName:n,processName:r})=>{const{userPreferences:o}=fe(),[i,a]=m.useState([]),[l,d]=m.useState(!1),[f,u]=m.useState(!1),[g,S]=m.useState(""),[b,c]=m.useState(""),[p,y]=m.useState(!0),h=m.useRef(null),v=m.useRef(!1),_=m.useCallback(F=>{const j=(o==null?void 0:o.timezone)||"Asia/Shanghai";try{const R=new Date(F);if(isNaN(R.getTime()))return F||"----/--/-- --:--:--";const W=new Intl.DateTimeFormat("en-CA",{timeZone:j,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(R),C=O=>{var K;return((K=W.find(re=>re.type===O))==null?void 0:K.value)||"00"};return`${C("year")}-${C("month")}-${C("day")} ${C("hour")}:${C("minute")}:${C("second")}`}catch{return F||"----/--/-- --:--:--"}},[o==null?void 0:o.timezone]),{send:P,isConnected:T}=ke({onMessage:F=>{if(F.type==="log_stream"&&F.data){const j=F.data;j.node_name===n&&j.process_name===r&&k(j.entries)}}}),k=m.useCallback(F=>{F.length>0&&(a(j=>{const R=new Set(j.map(C=>`${C.timestamp}|${C.message}`)),$=F.filter(C=>!R.has(`${C.timestamp}|${C.message}`));return $.length===0?j:[...j,...$].slice(-1e3)}),p&&h.current&&setTimeout(()=>{var j;(j=h.current)==null||j.scrollTo({top:h.current.scrollHeight,behavior:"smooth"})},100))},[p]),w=async()=>{var F;d(!0);try{const j=await ae.getProcessLogStream(n,r,void 0,100);a(((F=j.data)==null?void 0:F.entries)||[])}catch(j){console.error("Failed to load logs:",j),E.error("Failed to load logs")}finally{d(!1)}},I=()=>{T&&!v.current&&(P({type:"subscribe_logs",data:{node_name:n,process_name:r}}),v.current=!0)},z=()=>{T&&v.current&&(P({type:"unsubscribe_logs",data:{node_name:n,process_name:r}}),v.current=!1)},B=F=>{u(F),F?I():z()},J=()=>{a([])},X=()=>{const j=q().map(C=>`[${C.timestamp}] [${C.level}] ${C.message}`).join(`
`),R=new Blob([j],{type:"text/plain"}),$=URL.createObjectURL(R),W=document.createElement("a");W.href=$,W.download=`${n}-${r}-logs.txt`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL($)},H=F=>{switch(F.toUpperCase()){case"ERROR":return"red";case"WARN":case"WARNING":return"orange";case"INFO":return"blue";case"DEBUG":return"green";case"TRACE":return"purple";default:return"default"}},q=()=>i.filter(F=>{const j=!g||F.message.toLowerCase().includes(g.toLowerCase()),R=!b||F.level.toLowerCase()===b.toLowerCase();return j&&R});m.useEffect(()=>{t?w():(z(),u(!1),a([]))},[t]),m.useEffect(()=>()=>{z()},[]);const Y=q();return e.jsxs(Ne,{title:e.jsxs(N,{children:[e.jsxs("span",{children:["Logs: ",r," on ",n]}),e.jsx(M,{color:f?"green":"default",children:f?"Live":"Static"})]}),open:t,onCancel:s,width:1e3,footer:[e.jsx(A,{onClick:s,children:"Close"},"close")],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(N,{wrap:!0,children:[e.jsxs(N,{children:[e.jsx("span",{children:"Real-time:"}),e.jsx(oe,{checked:f,onChange:B,disabled:!T,checkedChildren:e.jsx(_e,{}),unCheckedChildren:e.jsx(Fn,{})})]}),e.jsxs(N,{children:[e.jsx("span",{children:"Auto-scroll:"}),e.jsx(oe,{checked:p,onChange:y,size:"small"})]}),e.jsx(Ba,{placeholder:"Search logs...",value:g,onChange:F=>S(F.target.value),style:{width:200},prefix:e.jsx(Ae,{}),allowClear:!0}),e.jsxs(se,{placeholder:"Filter by level",value:b,onChange:c,style:{width:120},allowClear:!0,children:[e.jsx(Ve,{value:"error",children:"Error"}),e.jsx(Ve,{value:"warn",children:"Warning"}),e.jsx(Ve,{value:"info",children:"Info"}),e.jsx(Ve,{value:"debug",children:"Debug"}),e.jsx(Ve,{value:"trace",children:"Trace"})]}),e.jsx(A,{icon:e.jsx(Ls,{}),onClick:J,size:"small",children:"Clear"}),e.jsx(A,{icon:e.jsx(Fs,{}),onClick:X,size:"small",children:"Export"})]})}),e.jsx("div",{ref:h,style:{height:500,overflow:"auto",border:"1px solid #d9d9d9",borderRadius:4,padding:8,backgroundColor:"#fafafa"},children:l?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ce,{size:"large"})}):Y.length===0?e.jsx("div",{style:{textAlign:"center",padding:50,color:"#999"},children:"No log entries found"}):e.jsx("div",{style:{fontFamily:"monospace",fontSize:12},children:Y.map((F,j)=>e.jsxs("div",{style:{display:"flex",gap:8,padding:"4px 0",alignItems:"flex-start"},children:[e.jsx("span",{style:{color:"rgba(0,0,0,0.45)",width:152,minWidth:152,flexShrink:0},children:_(F.timestamp)}),e.jsx(M,{color:H(F.level),style:{width:60,minWidth:60,textAlign:"center",flexShrink:0,margin:0},children:F.level.toUpperCase()}),e.jsx("span",{style:{flex:1,wordBreak:"break-word"},children:F.message})]},j))})}),e.jsxs("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:["Showing ",Y.length," of ",i.length," entries",f&&T&&e.jsx("span",{style:{marginLeft:16,color:"#52c41a"},children:"● Connected - receiving real-time updates"})]})]})};function Ma(t,s=1e3){const[n,r]=m.useState(!1),[o,i]=m.useState([]);return m.useEffect(()=>{const a=t>=s;r(a);const l=[];t>=100&&l.push("Consider using virtualization for better performance"),t>=500&&l.push("Enable pagination to reduce initial load time"),t>=1e3&&l.push("Implement server-side filtering and pagination"),i(l)},[t,s]),{shouldOptimize:n,recommendations:o,itemCount:t}}function Va(){const t=je(),{nodes:s,setNodes:n}=fe(),[r,o]=m.useState(!1),i=xa(),{shouldOptimize:a,recommendations:l}=Ma(s.length),[d,f]=ha("nodes-view-mode","card"),[u,g]=m.useState(""),[S,b]=m.useState({}),[c,p]=m.useState([]),y=i?"list":d,{filteredNodes:h,availableEnvironments:v,stats:_}=pa(s,u,S);m.useEffect(()=>{P()},[]);const P=async()=>{o(!0);try{const k=await ae.getNodes();n(k.nodes||[])}catch(k){console.error("Failed to load nodes:",k),E.error("Failed to load nodes")}finally{o(!1)}};ke({onMessage:k=>{k.type==="nodes_update"&&n(k.data)}});const T=async k=>{const w=k.nodeIds;if(w.length!==0)try{switch(k.type){case"refresh_all":E.loading({content:`Refreshing ${w.length} nodes...`,key:"bulk"}),await P(),E.success({content:`Refreshed ${w.length} nodes`,key:"bulk"});break;case"restart_all":E.loading({content:`Restarting all processes on ${w.length} nodes...`,key:"bulk"}),await Promise.all(w.map(I=>ae.restartAllProcesses(I))),E.success({content:`Restarted all processes on ${w.length} nodes`,key:"bulk"});break;case"start_all":E.loading({content:`Starting all processes on ${w.length} nodes...`,key:"bulk"}),await Promise.all(w.map(I=>ae.startAllProcesses(I))),E.success({content:`Started all processes on ${w.length} nodes`,key:"bulk"});break;case"stop_all":E.loading({content:`Stopping all processes on ${w.length} nodes...`,key:"bulk"}),await Promise.all(w.map(I=>ae.stopAllProcesses(I))),E.success({content:`Stopped all processes on ${w.length} nodes`,key:"bulk"});break;case"delete_selected":E.warning("Node deletion is not supported - nodes are defined in config.toml");break}p([])}catch(I){console.error("Bulk action failed:",I),E.error({content:"Bulk action failed",key:"bulk"})}};return r&&s.length===0?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ce,{size:"large"})}):e.jsx(Lt,{children:e.jsxs("div",{children:[e.jsx(za,{viewMode:y,onViewModeChange:f,searchQuery:u,onSearchChange:g,filters:S,onFiltersChange:b,environments:v,totalNodes:_.total,filteredNodes:_.filtered,selectedNodes:c,onBulkAction:T,onRefreshAll:P,loading:r,isMobile:i}),a&&l.length>0&&!1,h.length===0?e.jsx(V,{children:e.jsx($e,{description:_.total===0?"No nodes configured":"No nodes match your search criteria",image:$e.PRESENTED_IMAGE_SIMPLE,children:_.total===0?e.jsx("p",{style:{color:"#999"},children:"Add nodes in your config.toml file"}):e.jsx(A,{onClick:()=>{g(""),b({})},children:"Clear filters"})})}):y==="list"?e.jsx(Lt,{fallback:e.jsx("div",{style:{padding:20,textAlign:"center"},children:e.jsx("p",{children:"Failed to load list view. Please try refreshing the page."})}),children:e.jsx(La,{nodes:h,loading:r,selectedNodes:c,onSelectionChange:p,onNodeClick:k=>t(`/nodes/${k}`),onRefreshNode:async k=>{E.loading({content:`Refreshing node: ${k}`,key:"refresh"}),await P(),E.success({content:`Node ${k} refreshed`,key:"refresh"})},searchQuery:u})}):e.jsx(Lt,{fallback:e.jsx("div",{style:{padding:20,textAlign:"center"},children:e.jsx("p",{children:"Failed to load card view. Please try refreshing the page."})}),children:e.jsx(Da,{nodes:h,onNodeClick:k=>t(`/nodes/${k}`),searchQuery:u})})]})})}const Ha=()=>{const{nodeName:t}=Bs(),s=je(),[n,r]=m.useState(null),[o,i]=m.useState([]),[a,l]=m.useState(!0),[d,f]=m.useState({}),[u,g]=m.useState(!1),[S,b]=m.useState(null);m.useEffect(()=>{t&&c()},[t]);const c=async()=>{var k;if(t){l(!0);try{const I=(k=(await ae.getNodes()).nodes)==null?void 0:k.find(z=>z.name===t);if(I){if(r(I),I.is_connected){const z=await ae.getNodeProcesses(t);i(z.processes||[])}}else E.error("Node not found"),s("/nodes")}catch(w){console.error("Failed to load node detail:",w),E.error("Failed to load node detail")}finally{l(!1)}}},p=async(k,w)=>{if(!t)return;const I=`${k}-${w}`;f(z=>({...z,[I]:!0}));try{switch(w){case"start":await ae.startProcess(t,k),E.success(`Started ${k}`);break;case"stop":await ae.stopProcess(t,k),E.success(`Stopped ${k}`);break;case"restart":await ae.restartProcess(t,k),E.success(`Restarted ${k}`);break}await c()}catch(z){console.error(`Failed to ${w} process:`,z),E.error(`Failed to ${w} process`)}finally{f(z=>({...z,[I]:!1}))}},y=k=>{b(k),g(!0)},h=k=>{switch(k){case 20:return"success";case 0:return"default";case 10:return"processing";case 30:return"warning";case 100:return"error";default:return"default"}},v=[{title:"Name",dataIndex:"name",key:"name",render:k=>e.jsx("strong",{children:k})},{title:"Group",dataIndex:"group",key:"group"},{title:"State",dataIndex:"state_string",key:"state_string",render:(k,w)=>e.jsx(M,{color:h(w.state),children:k})},{title:"PID",dataIndex:"pid",key:"pid",render:k=>k||"-"},{title:"Uptime",dataIndex:"uptime_human",key:"uptime_human",render:k=>k||"-"},{title:"Actions",key:"actions",render:(k,w)=>e.jsxs(N,{children:[w.state!==20&&e.jsx(A,{type:"primary",size:"small",icon:e.jsx(_e,{}),onClick:()=>p(w.name,"start"),loading:d[`${w.name}-start`],children:"Start"}),w.state===20&&e.jsx(De,{title:"Stop this process?",onConfirm:()=>p(w.name,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(A,{size:"small",icon:e.jsx(Te,{}),loading:d[`${w.name}-stop`],danger:!0,children:"Stop"})}),e.jsx(A,{size:"small",icon:e.jsx(ee,{}),onClick:()=>p(w.name,"restart"),loading:d[`${w.name}-restart`],children:"Restart"}),e.jsx(A,{size:"small",icon:e.jsx(qt,{}),onClick:()=>y(w),children:"Logs"})]})}];if(a)return e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(Ce,{size:"large"})});if(!n)return e.jsx("div",{children:"Node not found"});const _=o.filter(k=>k.state===20).length,P=o.filter(k=>k.state===0).length,T=o.length;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(N,{children:[e.jsx(A,{icon:e.jsx(Ns,{}),onClick:()=>s("/nodes"),children:"Back"}),e.jsxs("h1",{style:{margin:0},children:["Node: ",n.name]}),n.is_connected?e.jsx(M,{icon:e.jsx(ie,{}),color:"success",children:"Connected"}):e.jsx(M,{icon:e.jsx(ue,{}),color:"error",children:"Disconnected"})]}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:c,loading:a,children:"Refresh"})]}),e.jsxs(Ke,{gutter:16,style:{marginBottom:24},children:[e.jsx(he,{xs:24,sm:8,children:e.jsx(V,{children:e.jsx(ye,{title:"Total Processes",value:T,prefix:e.jsx(dt,{})})})}),e.jsx(he,{xs:24,sm:8,children:e.jsx(V,{children:e.jsx(ye,{title:"Running",value:_,prefix:e.jsx(_e,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(he,{xs:24,sm:8,children:e.jsx(V,{children:e.jsx(ye,{title:"Stopped",value:P,prefix:e.jsx(Te,{}),valueStyle:{color:"#ff4d4f"}})})})]}),e.jsx(Wt,{defaultActiveKey:"processes",items:[{key:"processes",label:"Processes",children:e.jsx(V,{children:e.jsx(pe,{columns:v,dataSource:o,rowKey:"name",pagination:{pageSize:10},scroll:{x:800}})})},{key:"info",label:"Node Information",children:e.jsx(V,{children:e.jsxs(be,{bordered:!0,column:2,children:[e.jsx(be.Item,{label:"Name",children:n.name}),e.jsx(be.Item,{label:"Host",children:n.host}),e.jsx(be.Item,{label:"Port",children:n.port}),e.jsx(be.Item,{label:"Environment",children:e.jsx(M,{color:n.environment==="production"?"red":"blue",children:n.environment||"development"})}),e.jsx(be.Item,{label:"Username",children:n.username}),e.jsx(be.Item,{label:"Status",children:e.jsx(M,{color:n.is_connected?"success":"error",children:n.is_connected?"Connected":"Disconnected"})}),e.jsx(be.Item,{label:"Last Ping",span:2,children:n.last_ping?new Date(n.last_ping).toLocaleString():"-"})]})})}]}),S&&e.jsx(wn,{visible:u,onClose:()=>{g(!1),b(null)},nodeName:t||"",processName:S.name})]})},nt={getAggregated:()=>D.get("/processes/aggregated"),batchStart:t=>D.post(`/processes/${t}/start`),batchStop:t=>D.post(`/processes/${t}/stop`),batchRestart:t=>D.post(`/processes/${t}/restart`)},qa=({instances:t,processName:s,onRefresh:n})=>{const[r,o]=m.useState({}),[i,a]=m.useState(!1),[l,d]=m.useState(null),f=b=>{switch(b){case 20:return"success";case 0:return"default";case 10:return"processing";case 30:return"warning";case 100:return"error";default:return"default"}},u=async(b,c)=>{const p=`${b.node_name}-${s}-${c}`;o(y=>({...y,[p]:!0}));try{switch(c){case"start":await ae.startProcess(b.node_name,s),E.success(`Started ${s} on ${b.node_name}`);break;case"stop":await ae.stopProcess(b.node_name,s),E.success(`Stopped ${s} on ${b.node_name}`);break;case"restart":await ae.restartProcess(b.node_name,s),E.success(`Restarted ${s} on ${b.node_name}`);break}n()}catch(y){console.error(`Failed to ${c} process:`,y),E.error(`Failed to ${c} process on ${b.node_name}`)}finally{o(y=>({...y,[p]:!1}))}},g=b=>{d(b),a(!0)},S=[{title:"Node",dataIndex:"node_name",key:"node_name",render:(b,c)=>e.jsxs("div",{children:[e.jsx("strong",{children:b}),e.jsx("br",{}),e.jsxs("small",{style:{color:"#888"},children:[c.node_host,":",c.node_port]})]})},{title:"State",dataIndex:"state_string",key:"state_string",render:(b,c)=>e.jsx(M,{color:f(c.state),children:b})},{title:"PID",dataIndex:"pid",key:"pid",render:b=>b||"-"},{title:"Uptime",dataIndex:"uptime_human",key:"uptime_human",render:b=>b||"-"},{title:"Group",dataIndex:"group",key:"group"},{title:"Actions",key:"actions",render:(b,c)=>e.jsxs(N,{children:[c.state!==20&&e.jsx(A,{type:"primary",size:"small",icon:e.jsx(_e,{}),onClick:()=>u(c,"start"),loading:r[`${c.node_name}-${s}-start`],children:"Start"}),c.state===20&&e.jsx(De,{title:"Stop this process?",onConfirm:()=>u(c,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(A,{size:"small",icon:e.jsx(Te,{}),loading:r[`${c.node_name}-${s}-stop`],danger:!0,children:"Stop"})}),e.jsx(A,{size:"small",icon:e.jsx(ee,{}),onClick:()=>u(c,"restart"),loading:r[`${c.node_name}-${s}-restart`],children:"Restart"}),e.jsx(A,{size:"small",icon:e.jsx(qt,{}),onClick:()=>g(c),children:"Logs"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(pe,{columns:S,dataSource:t,rowKey:b=>`${b.node_name}-${s}`,pagination:!1,size:"small"}),l&&e.jsx(wn,{visible:i,onClose:()=>{a(!1),d(null)},nodeName:l.node_name,processName:s})]})},{Search:Wa}=G,Ka=()=>{const[t,s]=m.useState([]),[n,r]=m.useState([]),[o,i]=m.useState(!0),[a,l]=m.useState(""),[d,f]=m.useState({});m.useEffect(()=>{u()},[]),m.useEffect(()=>{g()},[a,t]),ke({onMessage:c=>{(c.type==="process_status_change"||c.type==="node_status_change"||c.type==="nodes_update")&&u()}});const u=async()=>{i(!0);try{const c=await nt.getAggregated();s(c.processes||[])}catch(c){console.error("Failed to load processes:",c),E.error("Failed to load processes")}finally{i(!1)}},g=()=>{if(!a.trim()){r(t);return}const c=t.filter(p=>p.name.toLowerCase().includes(a.toLowerCase()));r(c)},S=c=>{l(c)},b=async(c,p)=>{const y=`${c}-${p}`;f(h=>({...h,[y]:!0}));try{let h;switch(p){case"start":h=await nt.batchStart(c);break;case"stop":h=await nt.batchStop(c);break;case"restart":h=await nt.batchRestart(c);break}const v=h.result;v.failure_count===0?E.success(`Successfully ${p}ed ${v.success_count} instance(s) of ${c}`):Ne.warning({title:`Batch ${p} completed with errors`,content:e.jsxs("div",{children:[e.jsxs("p",{children:["Success: ",v.success_count," / ",v.total_instances]}),e.jsxs("p",{children:["Failed: ",v.failure_count]}),v.results.filter(_=>!_.success).map((_,P)=>e.jsxs("div",{children:[e.jsxs("strong",{children:[_.node_name,":"]})," ",_.error]},P))]})}),await u()}catch(h){console.error(`Failed to ${p} process:`,h),E.error(`Failed to ${p} process`)}finally{f(h=>({...h,[y]:!1}))}};return o?e.jsx("div",{style:{textAlign:"center",padding:"50px"},children:e.jsx(Ce,{size:"large"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Processes"}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:u,loading:o,children:"Refresh"})]}),e.jsx(V,{style:{marginBottom:16},children:e.jsx(Wa,{placeholder:"Search processes by name...",allowClear:!0,enterButton:e.jsx(Ae,{}),size:"large",onSearch:S,onChange:c=>S(c.target.value),value:a})}),n.length===0?e.jsx(V,{children:e.jsx($e,{description:a?`No processes found matching "${a}"`:"No processes available"})}):e.jsx(N,{direction:"vertical",size:"middle",style:{width:"100%"},children:n.map(c=>e.jsxs(V,{title:e.jsxs(N,{children:[e.jsx("strong",{children:c.name}),e.jsxs(M,{color:"blue",children:[c.total_instances," instances"]})]}),extra:e.jsxs(N,{children:[e.jsx(A,{type:"primary",size:"small",icon:e.jsx(_e,{}),onClick:()=>b(c.name,"start"),loading:d[`${c.name}-start`],disabled:c.running_instances===c.total_instances,children:"Start All"}),e.jsx(De,{title:"Stop all instances?",description:`This will stop all ${c.total_instances} instance(s) of ${c.name}`,onConfirm:()=>b(c.name,"stop"),okText:"Yes",cancelText:"No",children:e.jsx(A,{size:"small",icon:e.jsx(Te,{}),loading:d[`${c.name}-stop`],disabled:c.running_instances===0,danger:!0,children:"Stop All"})}),e.jsx(A,{size:"small",icon:e.jsx(ee,{}),onClick:()=>b(c.name,"restart"),loading:d[`${c.name}-restart`],children:"Restart All"})]}),children:[e.jsxs(Ke,{gutter:16,style:{marginBottom:16},children:[e.jsx(he,{xs:24,sm:8,children:e.jsx(ye,{title:"Total Instances",value:c.total_instances,prefix:e.jsx(dt,{})})}),e.jsx(he,{xs:24,sm:8,children:e.jsx(ye,{title:"Running",value:c.running_instances,prefix:e.jsx(_e,{}),valueStyle:{color:"#52c41a"}})}),e.jsx(he,{xs:24,sm:8,children:e.jsx(ye,{title:"Stopped",value:c.stopped_instances,prefix:e.jsx(Te,{}),valueStyle:{color:"#ff4d4f"}})})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("strong",{children:"Nodes:"})," ",c.instances.map((p,y)=>e.jsx(M,{color:"default",children:p.node_name},y))]}),e.jsx(Nn,{items:[{key:"1",label:"Instance Details",children:e.jsx(qa,{instances:c.instances,processName:c.name,onRefresh:u})}]})]},c.name))})]})},vn={getEnvironments:()=>D.get("/environments"),getEnvironmentDetail:t=>D.get(`/environments/${t}`)};function Ja({environment:t,onClick:s}){const n=t.members.length,r=t.members.filter(i=>i.is_connected).length,o=n-r;return e.jsx(V,{hoverable:!0,style:{height:"100%",cursor:"pointer"},onClick:s,children:e.jsxs(N,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:48,height:48,borderRadius:8,background:"#52c41a20",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ct,{style:{fontSize:24,color:"#52c41a"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:18},children:t.name}),e.jsxs("p",{style:{margin:0,color:"#999",fontSize:14},children:[n," ",n===1?"node":"nodes"]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",paddingTop:16,borderTop:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#52c41a"},children:r}),e.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:[e.jsx(ie,{style:{marginRight:4}}),"Online"]})]}),e.jsx("div",{style:{width:1,background:"#f0f0f0"}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:"bold",color:"#ff4d4f"},children:o}),e.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:[e.jsx(ue,{style:{marginRight:4}}),"Offline"]})]})]}),e.jsx("div",{style:{textAlign:"center"},children:r===n?e.jsx(M,{color:"success",style:{margin:0},children:"All nodes online"}):r===0?e.jsx(M,{color:"error",style:{margin:0},children:"All nodes offline"}):e.jsx(M,{color:"warning",style:{margin:0},children:"Partial connectivity"})})]})})}function Ya(){const t=je(),[s,n]=m.useState([]),[r,o]=m.useState(!1);m.useEffect(()=>{i()},[]);const i=async()=>{o(!0);try{const a=await vn.getEnvironments();n(a.environments||[])}catch(a){console.error("Failed to load environments:",a),E.error("Failed to load environments. Please try again.")}finally{o(!1)}};return ke({onMessage:a=>{(a.type==="nodes_update"||a.type==="node_status_change")&&i()}}),r&&s.length===0?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ce,{size:"large"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:24},children:"Environments"}),e.jsx("p",{style:{color:"#666",marginTop:8},children:"Manage nodes by environment"})]}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:i,loading:r,children:"Refresh"})]}),s.length===0?e.jsx(V,{children:e.jsx($e,{description:"No environments configured",image:$e.PRESENTED_IMAGE_SIMPLE,children:e.jsx("p",{style:{color:"#999"},children:"Add nodes with environment labels in your config.toml file"})})}):e.jsx(Ke,{gutter:[16,16],children:s.map(a=>e.jsx(he,{xs:24,sm:12,lg:8,children:e.jsx(Ja,{environment:a,onClick:()=>t(`/environments/${a.name}`)})},a.name))})]})}function Ga(){const{environmentName:t}=Bs(),s=je(),[n,r]=m.useState(null),[o,i]=m.useState(!1),[a,l]=m.useState(null),[d,f]=m.useState("all");m.useEffect(()=>{t&&u()},[t]);const u=async()=>{var c;if(t){i(!0),l(null);try{const p=await vn.getEnvironmentDetail(t);p.environment?r(p.environment):l("Environment not found")}catch(p){console.error("Failed to load environment detail:",p),((c=p.response)==null?void 0:c.status)===404?l("Environment not found"):E.error("Failed to load environment details. Please try again.")}finally{i(!1)}}};ke({onMessage:c=>{(c.type==="nodes_update"||c.type==="node_status_change")&&u()}});const g=m.useMemo(()=>{if(!n)return[];switch(d){case"online":return n.members.filter(c=>c.is_connected);case"offline":return n.members.filter(c=>!c.is_connected);default:return n.members}},[n,d]),S=c=>{f(c.target.value)},b=[{title:"Node Name",dataIndex:"name",key:"name",render:c=>e.jsx("a",{onClick:p=>{p.preventDefault(),s(`/nodes/${c}`)},style:{fontWeight:500},children:c})},{title:"Host",dataIndex:"host",key:"host"},{title:"Port",dataIndex:"port",key:"port"},{title:"Status",dataIndex:"is_connected",key:"status",render:c=>e.jsx(M,{icon:c?e.jsx(ie,{}):e.jsx(ue,{}),color:c?"success":"error",children:c?"Online":"Offline"})},{title:"Processes",dataIndex:"processes",key:"processes",render:c=>c||0},{title:"Last Ping",dataIndex:"last_ping",key:"last_ping",render:c=>c?new Date(c).toLocaleString():"-"}];return o&&!n?e.jsx("div",{style:{textAlign:"center",padding:50},children:e.jsx(Ce,{size:"large"})}):a?e.jsx(zs,{status:"404",title:"Environment Not Found",subTitle:`The environment "${t}" does not exist.`,extra:e.jsx(A,{type:"primary",onClick:()=>s("/environments"),children:"Back to Environments"})}):n?e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs(N,{children:[e.jsx(A,{icon:e.jsx(Ns,{}),onClick:()=>s("/environments"),children:"Back"}),e.jsxs("h2",{style:{margin:0,fontSize:24},children:["Environment: ",n.name]})]}),e.jsxs("p",{style:{color:"#666",marginTop:8,marginLeft:40},children:[n.members.length," ",n.members.length===1?"node":"nodes"," in this environment"]})]}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:u,loading:o,children:"Refresh"})]}),e.jsx(V,{children:n.members.length===0?e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("p",{style:{color:"#999",fontSize:16},children:"No nodes found in this environment"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs(tt.Group,{value:d,onChange:S,children:[e.jsxs(tt.Button,{value:"all",children:["All (",n.members.length,")"]}),e.jsxs(tt.Button,{value:"online",children:[e.jsx(ie,{style:{color:"#52c41a"}})," Online (",n.members.filter(c=>c.is_connected).length,")"]}),e.jsxs(tt.Button,{value:"offline",children:[e.jsx(ue,{style:{color:"#ff4d4f"}})," Offline (",n.members.filter(c=>!c.is_connected).length,")"]})]})}),e.jsx(pe,{columns:b,dataSource:g,rowKey:"name",pagination:!1,loading:o})]})})]}):null}const we={getUsers:async(t=1,s=20)=>D.get(`/users?page=${t}&page_size=${s}`),getUser:async t=>D.get(`/users/${t}`),createUser:async t=>D.post("/users",t),updateUser:async(t,s)=>D.put(`/users/${t}`,s),deleteUser:async t=>D.delete(`/users/${t}`),toggleUserStatus:async(t,s)=>D.patch(`/users/${t}/toggle`,{is_active:s}),resetPassword:async(t,s)=>D.put(`/users/${t}/password`,{new_password:s}),getUserPreferences:async t=>D.get(`/system-settings/users/${t}/preferences`),updateUserPreferences:async(t,s)=>D.put(`/system-settings/users/${t}/preferences`,s)},Xa=()=>{const{user:t}=fe(),s=(t==null?void 0:t.is_admin)??!1,[n,r]=m.useState([]),[o,i]=m.useState(!0),[a,l]=m.useState(!1),[d,f]=m.useState(!1),[u,g]=m.useState(null),[S,b]=m.useState(0),[c,p]=m.useState(1),[y,h]=m.useState(20),[v,_]=m.useState(!1),[P]=L.useForm(),[T]=L.useForm(),[k]=L.useForm(),[w]=L.useForm();m.useEffect(()=>{I()},[c,y]);const I=async()=>{i(!0);try{if(s){const j=await we.getUsers(c,y);j!=null&&j.data&&(r(j.data.users||[]),b(j.data.total||0))}else t&&(r([{id:t.id,username:t.username,email:t.email||"",full_name:t.full_name,is_admin:t.is_admin,is_active:!0,created_at:"",updated_at:""}]),b(1))}catch(j){console.error("Failed to load users:",j),E.error("Failed to load users")}finally{i(!1)}},z=()=>{P.resetFields(),l(!0)},B=async j=>{g(j),f(!0),T.setFieldsValue({username:j.username,email:j.email,full_name:j.full_name||"",is_admin:j.is_admin,is_active:j.is_active,timezone:"UTC"}),k.resetFields();try{const R=await we.getUserPreferences(j.id);T.setFieldsValue({timezone:R.timezone||"UTC"}),w.setFieldsValue({email_notifications:R.email_notifications??!0,process_alerts:R.process_alerts??!0,system_alerts:R.system_alerts??!0,node_status_changes:R.node_status_changes??!1,weekly_report:R.weekly_report??!1})}catch(R){console.error("Failed to load user preferences:",R),w.setFieldsValue({email_notifications:!0,process_alerts:!0,system_alerts:!0,node_status_changes:!1,weekly_report:!1})}},J=async j=>{var R,$;try{await we.deleteUser(j),E.success("User deleted successfully"),I()}catch(W){E.error((($=(R=W.response)==null?void 0:R.data)==null?void 0:$.message)||"Failed to delete user")}},X=async()=>{var j,R;try{const $=await P.validateFields(),W={username:$.username,email:$.email,password:$.password,full_name:$.full_name,is_admin:$.is_admin||!1};await we.createUser(W),E.success("User created successfully"),l(!1),I()}catch($){E.error(((R=(j=$.response)==null?void 0:j.data)==null?void 0:R.message)||"Failed to create user")}},H=async()=>{var j,R;if(u)try{const $=await T.validateFields();_(!0),await we.updateUser(u.id,{email:$.email,full_name:$.full_name,is_admin:$.is_admin,is_active:$.is_active}),await we.updateUserPreferences(u.id,{timezone:$.timezone}),E.success("User updated successfully"),I(),g({...u,...$})}catch($){E.error(((R=(j=$.response)==null?void 0:j.data)==null?void 0:R.message)||"Failed to update user")}finally{_(!1)}},q=async()=>{var j,R;if(u)try{const $=await k.validateFields();_(!0),await we.resetPassword(u.id,$.new_password),E.success("Password changed successfully"),k.resetFields()}catch($){E.error(((R=(j=$.response)==null?void 0:j.data)==null?void 0:R.message)||"Failed to change password")}finally{_(!1)}},Y=async()=>{var j,R;if(u)try{const $=await w.validateFields();_(!0),await we.updateUserPreferences(u.id,{email_notifications:$.email_notifications,process_alerts:$.process_alerts,system_alerts:$.system_alerts,node_status_changes:$.node_status_changes,weekly_report:$.weekly_report}),E.success("Notification settings updated")}catch($){E.error(((R=(j=$.response)==null?void 0:j.data)==null?void 0:R.message)||"Failed to update notifications")}finally{_(!1)}},F=[{title:"User",key:"user",render:(j,R)=>e.jsxs(N,{children:[e.jsx($s,{icon:e.jsx(Re,{})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:R.username}),e.jsx("div",{style:{fontSize:"12px",color:"#999"},children:R.email})]})]})},{title:"Full Name",dataIndex:"full_name",key:"full_name",render:j=>j||"-"},{title:"Role",dataIndex:"is_admin",key:"role",render:j=>e.jsx(M,{color:j?"red":"blue",children:j?"Admin":"User"})},{title:"Status",dataIndex:"is_active",key:"status",render:j=>e.jsx(M,{color:j?"green":"default",children:j?"Active":"Inactive"})},{title:"Last Login",dataIndex:"last_login",key:"last_login",render:j=>j?new Date(j).toLocaleString():"Never"},{title:"Actions",key:"actions",render:(j,R)=>e.jsxs(N,{children:[e.jsx(A,{type:"link",icon:e.jsx(Ts,{}),onClick:()=>B(R),children:"Settings"}),s&&e.jsx(De,{title:"Delete user",description:"Are you sure you want to delete this user?",onConfirm:()=>J(R.id),okText:"Yes",cancelText:"No",disabled:R.is_admin,children:e.jsx(A,{type:"link",danger:!0,icon:e.jsx(Je,{}),disabled:R.is_admin,children:"Delete"})})]})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(V,{title:"User Management",extra:e.jsxs(N,{children:[e.jsx(A,{icon:e.jsx(ee,{}),onClick:I,loading:o,children:"Refresh"}),s&&e.jsx(A,{type:"primary",icon:e.jsx(Dn,{}),onClick:z,children:"Add User"})]}),children:e.jsx(pe,{columns:F,dataSource:n,rowKey:"id",loading:o,pagination:{current:c,pageSize:y,total:S,showSizeChanger:!0,showTotal:j=>`Total ${j} users`,onChange:(j,R)=>{p(j),h(R)}}})}),e.jsx(Ne,{title:"Create User",open:a,onOk:X,onCancel:()=>l(!1),width:500,children:e.jsxs(L,{form:P,layout:"vertical",initialValues:{is_admin:!1},children:[e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter username"},{min:3,max:50,message:"Username must be 3-50 characters"}],children:e.jsx(G,{prefix:e.jsx(Re,{}),placeholder:"Username"})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter valid email"}],children:e.jsx(G,{prefix:e.jsx(es,{}),placeholder:"Email"})}),e.jsx(L.Item,{name:"full_name",label:"Full Name",children:e.jsx(G,{placeholder:"Full Name (optional)"})}),e.jsx(L.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{prefix:e.jsx(He,{}),placeholder:"Password"})}),e.jsx(L.Item,{name:"is_admin",label:"Admin Role",valuePropName:"checked",children:e.jsx(oe,{checkedChildren:"Admin",unCheckedChildren:"User"})})]})}),e.jsx(Un,{title:`User Settings: ${(u==null?void 0:u.username)||""}`,placement:"right",width:520,onClose:()=>f(!1),open:d,children:e.jsx(Wt,{items:[{key:"profile",label:e.jsxs("span",{children:[e.jsx(Re,{})," Profile"]}),children:e.jsxs(L,{form:T,layout:"vertical",children:[e.jsx(L.Item,{name:"username",label:"Username",children:e.jsx(G,{prefix:e.jsx(Re,{}),disabled:!0})}),e.jsx(L.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Please enter valid email"}],children:e.jsx(G,{prefix:e.jsx(es,{})})}),e.jsx(L.Item,{name:"full_name",label:"Full Name",children:e.jsx(G,{placeholder:"Enter full name"})}),e.jsx(L.Item,{name:"timezone",label:"Timezone",children:e.jsx(se,{options:[{label:"UTC",value:"UTC"},{label:"America/New_York",value:"America/New_York"},{label:"America/Los_Angeles",value:"America/Los_Angeles"},{label:"Europe/London",value:"Europe/London"},{label:"Asia/Shanghai",value:"Asia/Shanghai"},{label:"Asia/Tokyo",value:"Asia/Tokyo"}]})}),s&&e.jsxs(e.Fragment,{children:[e.jsx(ze,{}),e.jsx(L.Item,{name:"is_admin",label:"Admin Role",valuePropName:"checked",children:e.jsx(oe,{checkedChildren:"Admin",unCheckedChildren:"User"})}),e.jsx(L.Item,{name:"is_active",label:"Account Status",valuePropName:"checked",children:e.jsx(oe,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]}),e.jsx(L.Item,{children:e.jsx(A,{type:"primary",icon:e.jsx(rt,{}),onClick:H,loading:v,children:"Save Profile"})})]})},{key:"security",label:e.jsxs("span",{children:[e.jsx(He,{})," Security"]}),children:e.jsxs(L,{form:k,layout:"vertical",children:[e.jsx(L.Item,{name:"new_password",label:"New Password",rules:[{required:!0,message:"Please enter new password"},{min:6,message:"Password must be at least 6 characters"}],children:e.jsx(G.Password,{prefix:e.jsx(He,{}),placeholder:"Enter new password"})}),e.jsx(L.Item,{name:"confirm_password",label:"Confirm Password",dependencies:["new_password"],rules:[{required:!0,message:"Please confirm password"},({getFieldValue:j})=>({validator(R,$){return!$||j("new_password")===$?Promise.resolve():Promise.reject(new Error("Passwords do not match"))}})],children:e.jsx(G.Password,{prefix:e.jsx(He,{}),placeholder:"Confirm new password"})}),e.jsx(L.Item,{children:e.jsx(A,{type:"primary",icon:e.jsx(rt,{}),onClick:q,loading:v,children:"Reset Password"})})]})},{key:"notifications",label:e.jsxs("span",{children:[e.jsx(Ht,{})," Notifications"]}),children:e.jsxs(L,{form:w,layout:"vertical",children:[e.jsx(L.Item,{name:"email_notifications",label:"Email Notifications",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(ze,{}),e.jsx(L.Item,{name:"process_alerts",label:"Process Alerts",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(L.Item,{name:"system_alerts",label:"System Alerts",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(L.Item,{name:"node_status_changes",label:"Node Status Changes",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(ze,{}),e.jsx(L.Item,{name:"weekly_report",label:"Weekly Summary Report",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(L.Item,{children:e.jsx(A,{type:"primary",icon:e.jsx(rt,{}),onClick:Y,loading:v,children:"Save Preferences"})})]})}]})})]})},{Search:Za}=G,Qa=()=>{const t=je(),[s,n]=m.useState([]),[r,o]=m.useState(!0),[i,a]=m.useState(""),[l,d]=m.useState("all"),[f,u]=m.useState("active");ke(w=>{(w.type==="alert_created"||w.type==="alert_updated"||w.type==="alert_resolved")&&g()}),m.useEffect(()=>{g()},[l,f,i]);const g=async()=>{o(!0);try{const w=new URLSearchParams;l!=="all"&&w.append("severity",l),f!=="all"&&w.append("status",f),i&&w.append("search",i);const I=await fetch(`/api/alerts?${w.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!I.ok)throw new Error("Failed to fetch alerts");const z=await I.json();n(z.data||[])}catch(w){console.error("Failed to load alerts:",w),E.error("Failed to load alerts")}finally{o(!1)}},S=w=>{switch(w){case"critical":return"red";case"error":return"orange";case"warning":return"gold";case"info":return"blue";default:return"default"}},b=w=>{switch(w){case"critical":return e.jsx(ue,{});case"error":return e.jsx(ue,{});case"warning":return e.jsx(ts,{});case"info":return e.jsx(dt,{});default:return e.jsx(dt,{})}},c=w=>{switch(w){case"active":return"error";case"acknowledged":return"warning";case"resolved":return"success";default:return"default"}},p=async w=>{try{if(!(await fetch(`/api/alerts/${w}/acknowledge`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to acknowledge alert");E.success("Alert acknowledged successfully"),g()}catch(I){console.error("Failed to acknowledge alert:",I),E.error("Failed to acknowledge alert")}},y=async w=>{try{if(!(await fetch(`/api/alerts/${w}/resolve`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to resolve alert");E.success("Alert resolved successfully"),g()}catch(I){console.error("Failed to resolve alert:",I),E.error("Failed to resolve alert")}},h=s.filter(w=>{const I=w.node_name.toLowerCase().includes(i.toLowerCase())||w.process_name&&w.process_name.toLowerCase().includes(i.toLowerCase())||w.message.toLowerCase().includes(i.toLowerCase()),z=l==="all"||w.severity===l,B=f==="all"||w.status===f;return I&&z&&B}),v=f==="resolved"||f==="all"?(()=>{const w=new Map;return h.forEach(I=>{const z=`${I.node_name}-${I.alert_type||"unknown"}`,B=w.get(z);(!B||new Date(I.created_at)>new Date(B.created_at))&&w.set(z,I)}),Array.from(w.values()).sort((I,z)=>new Date(z.created_at).getTime()-new Date(I.created_at).getTime())})():h,_=[{title:"Severity",dataIndex:"severity",key:"severity",width:120,render:w=>e.jsx(M,{icon:b(w),color:S(w),children:w.toUpperCase()})},{title:"Message",dataIndex:"message",key:"message",ellipsis:!0},{title:"Status",dataIndex:"status",key:"status",width:120,render:w=>e.jsx(M,{color:c(w),children:w.toUpperCase()})},{title:"Created",dataIndex:"start_time",key:"start_time",width:180,render:w=>new Date(w).toLocaleString()},{title:"Actions",key:"actions",width:200,render:(w,I)=>e.jsxs(N,{children:[I.status==="active"&&e.jsx(A,{size:"small",onClick:()=>p(I.id),children:"Acknowledge"}),I.status!=="resolved"&&e.jsx(A,{size:"small",type:"primary",onClick:()=>y(I.id),children:"Resolve"})]})}],P=s.filter(w=>w.status==="active").length,T=s.filter(w=>w.status==="acknowledged").length,k=s.filter(w=>w.status==="resolved").length;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(N,{children:[e.jsx("h1",{style:{margin:0},children:"Alerts"}),e.jsx(Ds,{count:P,style:{backgroundColor:"#ff4d4f"}})]}),e.jsxs(N,{children:[e.jsx(A,{onClick:()=>t("/alerts/rules"),children:"Alert Rules"}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:g,loading:r,children:"Refresh"})]})]}),e.jsxs(N,{style:{marginBottom:16,width:"100%"},size:"large",children:[e.jsx(V,{size:"small",children:e.jsxs(N,{children:[e.jsx(ue,{style:{fontSize:24,color:"#ff4d4f"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Active"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:P})]})]})}),e.jsx(V,{size:"small",children:e.jsxs(N,{children:[e.jsx(ts,{style:{fontSize:24,color:"#faad14"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Acknowledged"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:T})]})]})}),e.jsx(V,{size:"small",children:e.jsxs(N,{children:[e.jsx(ie,{style:{fontSize:24,color:"#52c41a"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Resolved"}),e.jsx("div",{style:{fontSize:20,fontWeight:"bold"},children:k})]})]})})]}),e.jsx(V,{style:{marginBottom:16},children:e.jsxs(N,{wrap:!0,children:[e.jsx(Za,{placeholder:"Search alerts...",allowClear:!0,style:{width:300},onChange:w=>a(w.target.value),prefix:e.jsx(Ae,{})}),e.jsx(se,{style:{width:150},value:l,onChange:d,options:[{label:"All Severities",value:"all"},{label:"Critical",value:"critical"},{label:"Error",value:"error"},{label:"Warning",value:"warning"},{label:"Info",value:"info"}]}),e.jsx(se,{style:{width:180},value:f,onChange:u,options:[{label:"Active Only",value:"active"},{label:"Acknowledged",value:"acknowledged"},{label:"Resolved",value:"resolved"},{label:"All Status",value:"all"}]})]})}),e.jsx(V,{children:e.jsx(pe,{columns:_,dataSource:v,rowKey:"id",loading:r,pagination:{pageSize:20,showSizeChanger:!0,showQuickJumper:!0,showTotal:(w,I)=>`${I[0]}-${I[1]} of ${w} alerts`},scroll:{x:1200}})})]})},ei=()=>{const t=je(),[s,n]=m.useState([]),[r,o]=m.useState(!0),[i,a]=m.useState(!1),[l,d]=m.useState(null),[f]=L.useForm();m.useEffect(()=>{u()},[]);const u=async()=>{o(!0);try{const h=await fetch("/api/alerts/rules",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!h.ok)throw new Error("Failed to fetch alert rules");const v=await h.json();n(v.data||[])}catch(h){console.error("Failed to load rules:",h),E.error("Failed to load alert rules")}finally{o(!1)}},g=h=>{d(h),f.setFieldsValue(h),a(!0)},S=async h=>{try{if(!(await fetch(`/api/alerts/rules/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Failed to delete alert rule");E.success("Alert rule deleted"),u()}catch(v){console.error("Failed to delete alert rule:",v),E.error("Failed to delete alert rule")}},b=async(h,v)=>{try{if(!(await fetch(`/api/alerts/rules/${h}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:v})})).ok)throw new Error("Failed to update alert rule");E.success(`Alert rule ${v?"enabled":"disabled"}`),u()}catch(_){console.error("Failed to update alert rule:",_),E.error("Failed to update alert rule")}},c=async()=>{try{const h=await f.validateFields(),v=l?`/api/alerts/rules/${l.id}`:"/api/alerts/rules";if(!(await fetch(v,{method:l?"PUT":"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error(`Failed to ${l?"update":"create"} alert rule`);E.success(`Alert rule ${l?"updated":"created"}`),a(!1),u()}catch(h){console.error("Failed to submit:",h),E.error(`Failed to ${l?"update":"create"} alert rule`)}},p=h=>{switch(h){case"critical":return"red";case"high":return"orange";case"medium":return"gold";case"low":return"blue";default:return"default"}},y=[{title:"Name",dataIndex:"name",key:"name",render:h=>e.jsx("strong",{children:h})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0},{title:"Metric",dataIndex:"metric",key:"metric",render:h=>h.replace(/_/g," ").toUpperCase()},{title:"Condition",key:"condition",render:(h,v)=>`${v.condition} ${v.threshold}`},{title:"Duration",dataIndex:"duration",key:"duration",render:h=>`${h}s`},{title:"Severity",dataIndex:"severity",key:"severity",render:h=>e.jsx(M,{color:p(h),children:h.toUpperCase()})},{title:"Status",dataIndex:"enabled",key:"enabled",render:(h,v)=>{const _=v.id<=2;return e.jsx(oe,{checked:h,onChange:P=>b(v.id,P),disabled:_,title:_?"System rules are always enabled":"Toggle rule status"})}},{title:"Actions",key:"actions",render:(h,v)=>{const _=v.id<=2;return e.jsxs(N,{children:[e.jsx(A,{size:"small",icon:e.jsx(Bn,{}),onClick:()=>g(v),disabled:_,title:_?"System rules cannot be edited":"Edit rule",children:"Edit"}),e.jsx(De,{title:"Delete this rule?",onConfirm:()=>S(v.id),okText:"Yes",cancelText:"No",disabled:_,children:e.jsx(A,{size:"small",icon:e.jsx(Je,{}),danger:!0,disabled:_,title:_?"System rules cannot be deleted":"Delete rule",children:"Delete"})})]})}}];return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Alert Rules"}),e.jsxs(N,{children:[e.jsx(A,{onClick:()=>t("/alerts"),children:"Back to Alerts"}),e.jsx(A,{icon:e.jsx(ee,{}),onClick:u,loading:r,children:"Refresh"})]})]}),e.jsx(V,{style:{marginBottom:16,backgroundColor:"#f0f5ff",borderColor:"#adc6ff"},children:e.jsxs(N,{direction:"vertical",size:"small",children:[e.jsx("div",{style:{fontWeight:"bold",color:"#1890ff"},children:"ℹ️ System Alert Rules"}),e.jsx("div",{style:{fontSize:"14px",color:"#595959"},children:"This system uses automatic alert rules for monitoring:"}),e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px",fontSize:"14px",color:"#595959"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Node Offline Alert"}),": Automatically triggered when a node becomes unreachable"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Process Stopped Alert"}),": Automatically triggered when a process stops unexpectedly"]})]}),e.jsx("div",{style:{fontSize:"13px",color:"#8c8c8c",fontStyle:"italic"},children:"System rules (ID 1-2) cannot be edited or deleted. Custom rules are not supported in this version."})]})}),e.jsx(V,{children:e.jsx(pe,{columns:y,dataSource:s,rowKey:"id",loading:r,pagination:{pageSize:10,showSizeChanger:!0,showTotal:h=>`Total ${h} rules`}})}),e.jsx(Ne,{title:l?"Edit Alert Rule":"Create Alert Rule",open:i,onOk:c,onCancel:()=>a(!1),width:600,children:e.jsxs(L,{form:f,layout:"vertical",initialValues:{enabled:!0,severity:"high",condition:"==",threshold:0,duration:1},children:[e.jsx(L.Item,{name:"name",label:"Rule Name",rules:[{required:!0,message:"Please enter rule name"}],children:e.jsx(G,{placeholder:"e.g., Node Offline Alert"})}),e.jsx(L.Item,{name:"description",label:"Description",children:e.jsx(G.TextArea,{rows:2,placeholder:"Describe when this alert should trigger"})}),e.jsx(L.Item,{name:"metric",label:"Metric",rules:[{required:!0,message:"Please select metric"}],children:e.jsx(se,{options:[{label:"Node Status",value:"node_status"},{label:"Process Status",value:"process_status"},{label:"CPU Usage",value:"cpu"},{label:"Memory Usage",value:"memory"},{label:"Disk Usage",value:"disk"}]})}),e.jsx(L.Item,{name:"condition",label:"Condition",rules:[{required:!0,message:"Please select condition"}],children:e.jsx(se,{options:[{label:"Equal (==)",value:"=="},{label:"Not Equal (!=)",value:"!="},{label:"Greater Than (>)",value:">"},{label:"Greater or Equal (>=)",value:">="},{label:"Less Than (<)",value:"<"},{label:"Less or Equal (<=)",value:"<="}]})}),e.jsx(L.Item,{name:"threshold",label:"Threshold",rules:[{required:!0,message:"Please enter threshold"}],children:e.jsx(me,{min:0,style:{width:"100%"}})}),e.jsx(L.Item,{name:"duration",label:"Duration (seconds)",rules:[{required:!0,message:"Please enter duration"}],children:e.jsx(me,{min:1,style:{width:"100%"}})}),e.jsx(L.Item,{name:"severity",label:"Severity",rules:[{required:!0,message:"Please select severity"}],children:e.jsx(se,{options:[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"},{label:"Critical",value:"critical"}]})}),e.jsx(L.Item,{name:"enabled",label:"Enabled",valuePropName:"checked",children:e.jsx(oe,{})})]})})]})};class ti{async getActivityLogs(s={}){const n=new URLSearchParams;s.level&&n.append("level",s.level),s.action&&n.append("action",s.action),s.resource&&n.append("resource",s.resource),s.username&&n.append("username",s.username),s.start_time&&n.append("start_time",s.start_time),s.end_time&&n.append("end_time",s.end_time),s.page&&n.append("page",s.page.toString()),s.page_size&&n.append("page_size",s.page_size.toString());const r=n.toString(),o=`/activity-logs${r?`?${r}`:""}`;return D.get(o)}async getRecentLogs(s=20){return(await D.get(`/activity-logs/recent?limit=${s}`)).logs}async getLogStatistics(s=7){return(await D.get(`/activity-logs/statistics?days=${s}`)).data}async exportLogs(s={}){const n=new URLSearchParams;s.level&&n.append("level",s.level),s.action&&n.append("action",s.action),s.resource&&n.append("resource",s.resource),s.username&&n.append("username",s.username),s.start_time&&n.append("start_time",s.start_time),s.end_time&&n.append("end_time",s.end_time);const r=n.toString(),o=`/activity-logs/export${r?`?${r}`:""}`,i=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!i.ok)throw new Error("Failed to export logs");return i.blob()}async deleteLogs(s={}){const n=new URLSearchParams;s.level&&n.append("level",s.level),s.action&&n.append("action",s.action),s.resource&&n.append("resource",s.resource),s.username&&n.append("username",s.username),s.start_time&&n.append("start_time",s.start_time),s.end_time&&n.append("end_time",s.end_time);const r=n.toString(),o=`/api/activity-logs${r?`?${r}`:""}`,i=await fetch(o,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!i.ok)throw new Error("Failed to delete logs");return i.json()}}const zt=new ti,si=(t,s,n=[])=>{const[r,o]=m.useState(30),[i,a]=m.useState(!0),l=m.useRef(null),d=m.useRef(t);return m.useEffect(()=>{d.current=t},[t]),m.useEffect(()=>{(async()=>{var u,g,S;try{const b=await D.get("/system-settings/user-preferences");if(b.data){const c=b.data;a(c.auto_refresh!==!1),c.refresh_interval&&o(c.refresh_interval)}if(!((u=b.data)!=null&&u.refresh_interval)){const c=await D.get("/system-settings");(S=(g=c.data)==null?void 0:g.settings)!=null&&S.refresh_interval&&o(parseInt(c.data.settings.refresh_interval,10))}}catch(b){console.error("Failed to load refresh settings:",b)}})()},[]),m.useEffect(()=>(l.current&&(clearInterval(l.current),l.current=null),(s!==void 0?s:i)&&r>0&&(d.current(),l.current=setInterval(()=>{d.current()},r*1e3)),()=>{l.current&&(clearInterval(l.current),l.current=null)}),[r,i,s,...n]),{refreshInterval:r,autoRefreshEnabled:i,setRefreshInterval:o,setAutoRefreshEnabled:a}},{RangePicker:ni}=Mn,ri=()=>{const[t,s]=m.useState([]),[n,r]=m.useState(!1),[o,i]=m.useState(null),[a,l]=m.useState(""),[d,f]=m.useState(""),[u,g]=m.useState(""),[S,b]=m.useState(""),[c,p]=m.useState(""),[y,h]=m.useState(null),[v,_]=m.useState(!0),[P,T]=m.useState({page:1,page_size:20,total:0,total_pages:0,has_next:!1,has_prev:!1});m.useEffect(()=>{w()},[]),si(()=>{P.page===1&&w()},v,[P.page]);const k=()=>{const j={page:P.page,page_size:P.page_size};return d&&(j.level=d),u&&(j.action=u),S&&(j.resource=S),c&&(j.username=c),y&&y[0]&&y[1]&&(j.start_time=y[0].toISOString(),j.end_time=y[1].toISOString()),j},w=async j=>{r(!0),i(null);try{const R=j?{...k(),...j}:k(),$=await zt.getActivityLogs(R);s($.data.logs),T($.data.pagination)}catch(R){console.error("Failed to load logs:",R);const $=R instanceof Error?R.message:"Failed to load activity logs";i($),E.error($)}finally{r(!1)}},I=()=>{T(j=>({...j,page:1})),w({page:1})},z=async()=>{try{E.loading({content:"Exporting logs...",key:"export"});const j=k(),R=await zt.exportLogs(j),$=URL.createObjectURL(R),W=document.createElement("a");W.href=$,W.download=`activity-logs-${ss().format("YYYY-MM-DD-HHmmss")}.csv`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL($),E.success({content:"Logs exported successfully",key:"export"})}catch(j){console.error("Failed to export logs:",j),E.error({content:"Failed to export logs",key:"export"})}},B=()=>!!(d||u||S||c||y&&y[0]&&y[1]),J=()=>{const j=B();Ne.confirm({title:j?"Clear Filtered Logs":"Clear All Logs",content:j?"Are you sure you want to delete all logs matching the current filters? This action cannot be undone.":"Are you sure you want to delete ALL activity logs? This action cannot be undone.",okText:"Delete",okType:"danger",cancelText:"Cancel",onOk:async()=>{try{E.loading({content:"Deleting logs...",key:"delete"});const R=k();delete R.page,delete R.page_size;const $=await zt.deleteLogs(R);E.success({content:`Deleted ${$.deleted} logs`,key:"delete"}),w({page:1})}catch(R){console.error("Failed to delete logs:",R),E.error({content:"Failed to delete logs",key:"delete"})}}})},X=j=>{switch(j.toUpperCase()){case"ERROR":return"red";case"WARNING":return"orange";case"INFO":return"blue";case"DEBUG":return"default";default:return"default"}},H=j=>j.includes("create")?"green":j.includes("delete")?"red":j.includes("update")||j.includes("edit")?"orange":j.includes("start")?"blue":j.includes("stop")?"volcano":"default",q=j=>{const R=j.current||1,$=j.pageSize||20;T(W=>({...W,page:R,page_size:$})),w({page:R,page_size:$})},Y=[{title:"Timestamp",dataIndex:"created_at",key:"created_at",width:180,render:j=>ss(j).format("YYYY-MM-DD HH:mm:ss")},{title:"Level",dataIndex:"level",key:"level",width:100,render:j=>e.jsx(M,{color:X(j),children:j.toUpperCase()})},{title:"User",dataIndex:"username",key:"username",width:120,render:j=>j||"system"},{title:"Action",dataIndex:"action",key:"action",width:150,render:j=>e.jsx(M,{color:H(j),children:j.replace(/_/g," ").toUpperCase()})},{title:"Resource",dataIndex:"resource",key:"resource",width:120},{title:"Target",dataIndex:"target",key:"target",width:150,ellipsis:!0},{title:"Message",dataIndex:"message",key:"message",ellipsis:!0},{title:"IP Address",dataIndex:"ip_address",key:"ip_address",width:140}],F=a?t.filter(j=>{var R,$;return j.message.toLowerCase().includes(a.toLowerCase())||((R=j.username)==null?void 0:R.toLowerCase().includes(a.toLowerCase()))||j.action.toLowerCase().includes(a.toLowerCase())||(($=j.target)==null?void 0:$.toLowerCase().includes(a.toLowerCase()))}):t;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{style:{margin:0},children:"Activity Logs"}),e.jsxs(N,{children:[e.jsxs(A,{type:v?"default":"dashed",onClick:()=>_(!v),children:["Auto Refresh: ",v?"ON":"OFF"]}),e.jsx(A,{icon:e.jsx(Fs,{}),onClick:z,disabled:n,children:"Export"}),e.jsx(A,{danger:!0,icon:e.jsx(Je,{}),onClick:J,disabled:n,children:B()?"Clear Filtered":"Clear All"}),e.jsx(A,{type:"primary",icon:e.jsx(ee,{}),onClick:()=>w(),loading:n,children:"Refresh"})]})]}),o&&e.jsx(Pe,{message:"Error",description:o,type:"error",closable:!0,onClose:()=>i(null),style:{marginBottom:16}}),e.jsx(V,{style:{marginBottom:16},children:e.jsxs(N,{wrap:!0,style:{width:"100%"},children:[e.jsx(G,{placeholder:"Search logs...",prefix:e.jsx(Ae,{}),style:{width:300},value:a,onChange:j=>l(j.target.value),allowClear:!0}),e.jsx(se,{style:{width:150},placeholder:"Level",value:d||void 0,onChange:f,allowClear:!0,options:[{label:"INFO",value:"INFO"},{label:"WARNING",value:"WARNING"},{label:"ERROR",value:"ERROR"},{label:"DEBUG",value:"DEBUG"}]}),e.jsx(se,{style:{width:150},placeholder:"Action",value:u||void 0,onChange:g,allowClear:!0,options:[{label:"Start Process",value:"start_process"},{label:"Stop Process",value:"stop_process"},{label:"Restart Process",value:"restart_process"},{label:"Login",value:"login"},{label:"Logout",value:"logout"}]}),e.jsx(se,{style:{width:150},placeholder:"Resource",value:S||void 0,onChange:b,allowClear:!0,options:[{label:"Process",value:"process"},{label:"Node",value:"node"},{label:"User",value:"user"},{label:"Auth",value:"auth"},{label:"System",value:"system"}]}),e.jsx(G,{placeholder:"Username",style:{width:150},value:c,onChange:j=>p(j.target.value),allowClear:!0}),e.jsx(ni,{showTime:!0,format:"YYYY-MM-DD HH:mm",placeholder:["Start Time","End Time"],value:y,onChange:h}),e.jsx(A,{type:"primary",icon:e.jsx(Ae,{}),onClick:I,loading:n,children:"Search"})]})}),e.jsx(V,{children:e.jsx(pe,{columns:Y,dataSource:F,rowKey:"id",loading:n,pagination:{current:P.page,pageSize:P.page_size,total:P.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(j,R)=>`${R[0]}-${R[1]} of ${j} logs`,pageSizeOptions:["10","20","50","100"]},onChange:q,scroll:{x:1200},size:"small"})})]})},oi=()=>{const{user:t}=fe(),[s,n]=m.useState(!1),[r]=L.useForm();m.useEffect(()=>{const i=async()=>{if(t!=null&&t.is_admin)try{const l=(await Vt.getSystemSettings()).settings||{},d=l.enable_websocket!=="false";r.setFieldsValue({refresh_interval:parseInt(l.refresh_interval)||30,process_refresh_interval:parseInt(l.process_refresh_interval)||5,log_retention_days:parseInt(l.log_retention_days)||30,max_concurrent_connections:parseInt(l.max_concurrent_connections)||100,enable_websocket:d,enable_activity_logging:l.enable_activity_logging!=="false"});const{setWebsocketEnabled:f}=fe.getState();f(d)}catch(a){console.error("Failed to load system settings:",a),r.setFieldsValue({refresh_interval:30,process_refresh_interval:5,log_retention_days:30,max_concurrent_connections:100,enable_websocket:!0,enable_activity_logging:!0})}};t!=null&&t.is_admin&&i()},[t,r]);const o=async()=>{var i,a;try{const l=await r.validateFields();n(!0);const d={refresh_interval:l.refresh_interval,process_refresh_interval:l.process_refresh_interval,log_retention_days:l.log_retention_days,max_concurrent_connections:l.max_concurrent_connections,enable_websocket:l.enable_websocket,enable_activity_logging:l.enable_activity_logging};await Vt.updateSystemSettings(d);const{setWebsocketEnabled:f}=fe.getState();f(l.enable_websocket),E.success("System settings updated")}catch(l){console.error("Failed to update system settings:",l),E.error(((a=(i=l.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to update system settings")}finally{n(!1)}};return t!=null&&t.is_admin?e.jsxs("div",{style:{padding:24},children:[e.jsx("h1",{style:{marginBottom:16},children:"System Settings"}),e.jsxs(V,{children:[e.jsx(Pe,{message:"System Configuration",description:"Configure global system settings. Changes will affect all users.",type:"warning",showIcon:!0,style:{marginBottom:24}}),e.jsxs(L,{form:r,layout:"vertical",style:{maxWidth:600},initialValues:{refresh_interval:30,process_refresh_interval:5,log_retention_days:30,max_concurrent_connections:100,enable_websocket:!0,enable_activity_logging:!0},children:[e.jsx(L.Item,{name:"refresh_interval",label:"Node Refresh Interval (seconds)",help:"How often to refresh node and process status",rules:[{required:!0}],children:e.jsx(me,{min:5,max:300,style:{width:"100%"}})}),e.jsx(L.Item,{name:"process_refresh_interval",label:"Process Page Refresh Interval (seconds)",help:"How often to push process updates via WebSocket",rules:[{required:!0}],children:e.jsx(me,{min:1,max:300,style:{width:"100%"}})}),e.jsx(L.Item,{name:"log_retention_days",label:"Log Retention (days)",rules:[{required:!0}],children:e.jsx(me,{min:1,max:365,style:{width:"100%"}})}),e.jsx(L.Item,{name:"max_concurrent_connections",label:"Max Concurrent Connections",rules:[{required:!0}],children:e.jsx(me,{min:10,max:1e3,style:{width:"100%"}})}),e.jsx(ze,{}),e.jsx(L.Item,{name:"enable_websocket",label:"Enable WebSocket",valuePropName:"checked",help:"When disabled, real-time updates will not be available",children:e.jsx(oe,{})}),e.jsx(L.Item,{name:"enable_activity_logging",label:"Enable Activity Logging",valuePropName:"checked",children:e.jsx(oe,{})}),e.jsx(L.Item,{children:e.jsxs(N,{children:[e.jsx(A,{type:"primary",icon:e.jsx(rt,{}),onClick:o,loading:s,children:"Save Settings"}),e.jsx(A,{icon:e.jsx(Vn,{}),onClick:()=>E.info("Database backup started"),children:"Backup Database"})]})})]})]})]}):e.jsx("div",{style:{padding:24},children:e.jsx(Pe,{message:"Access Denied",description:"Only administrators can access system settings",type:"error",showIcon:!0})})},Le={startDiscovery:t=>D.post("/discovery/tasks",t),getTasks:t=>D.get("/discovery/tasks",{params:t}),getTask:t=>D.get(`/discovery/tasks/${t}`),cancelTask:t=>D.post(`/discovery/tasks/${t}/cancel`),deleteTask:t=>D.delete(`/discovery/tasks/${t}`),getTaskProgress:t=>D.get(`/discovery/tasks/${t}/progress`),validateCIDR:t=>D.post("/discovery/validate-cidr",{cidr:t})},{Text:Q,Title:ai}=ht,ii=/^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/,As={pending:"default",running:"processing",completed:"success",cancelled:"warning",failed:"error"},li={success:"success",timeout:"warning",connection_refused:"default",auth_failed:"error",error:"error"},Ps=(t,s)=>{var r,o;if(!t)return s;const n=(r=t.response)==null?void 0:r.data;return n?typeof n=="string"?n:typeof n.error=="string"?n.error:typeof n.message=="string"?n.message:(o=n.error)!=null&&o.message?n.error.message:s:s};function ci(){const[t]=L.useForm(),[s,n]=m.useState(!1),[r,o]=m.useState([]),[i,a]=m.useState(!1),[l,d]=m.useState({page:1,limit:10,total:0}),[f,u]=m.useState(null),[g,S]=m.useState([]),[b,c]=m.useState(!1),[p,y]=m.useState(!1),[h,v]=m.useState(null),[_,P]=m.useState(!1),[T,k]=m.useState([]),[w,I]=m.useState("new");m.useEffect(()=>{z()},[l.page,l.limit]),ke({onMessage:m.useCallback(C=>{if(C.type==="discovery_progress"){const O=C.data;o(K=>K.map(re=>re.id===O.task_id?{...re,scanned_ips:O.scanned_ips,found_nodes:O.found_nodes,failed_ips:O.failed_ips}:re)),(f==null?void 0:f.id)===O.task_id&&u(K=>K?{...K,scanned_ips:O.scanned_ips,found_nodes:O.found_nodes,failed_ips:O.failed_ips}:null)}else if(C.type==="node_discovered"){const O=C.data;k(K=>[O,...K.slice(0,9)]),E.success(`Discovered node: ${O.node_name}`)}else if(C.type==="discovery_completed"){const O=C.data;o(K=>K.map(re=>re.id===O.task_id?{...re,status:O.status}:re)),(f==null?void 0:f.id)===O.task_id&&B(O.task_id),E.info(`Discovery task ${O.task_id} completed`)}},[f])});const z=async()=>{a(!0);try{const C=await Le.getTasks({page:l.page,limit:l.limit});o(C.tasks||[]),d(O=>({...O,total:C.total}))}catch(C){console.error("Failed to load tasks:",C),E.error("Failed to load discovery tasks")}finally{a(!1)}},B=async C=>{y(!0);try{const O=await Le.getTask(C);u(O.task),S(O.results||[])}catch(O){console.error("Failed to load task detail:",O),E.error("Failed to load task details")}finally{y(!1)}},J=async C=>{if(!C){v(null);return}if(!ii.test(C)){v({valid:!1,count:0,error:"Invalid CIDR format (e.g., 192.168.1.0/24)"});return}P(!0);try{const O=await Le.validateCIDR(C);v({valid:O.valid,count:O.count})}catch(O){const K=Ps(O,"Failed to validate CIDR");v({valid:!1,count:0,error:K})}finally{P(!1)}},X=async C=>{if(!(h!=null&&h.valid)){E.error("Please enter a valid CIDR range");return}n(!0);try{await Le.startDiscovery(C),E.success(`Discovery started for ${C.cidr}`),t.resetFields(),v(null),k([]),I("history"),z()}catch(O){const K=Ps(O,"Failed to start discovery");E.error(K)}finally{n(!1)}},H=async C=>{try{await Le.cancelTask(C),E.success("Task cancelled"),z()}catch{E.error("Failed to cancel task")}},q=async C=>{try{await Le.deleteTask(C),E.success("Task deleted"),z()}catch{E.error("Failed to delete task")}},Y=C=>{u(C),c(!0),B(C.id)},F=[{title:"ID",dataIndex:"id",key:"id",width:60},{title:"CIDR",dataIndex:"cidr",key:"cidr",render:C=>e.jsx(Q,{code:!0,children:C})},{title:"Port",dataIndex:"port",key:"port",width:80},{title:"Status",dataIndex:"status",key:"status",width:120,render:C=>e.jsx(M,{color:As[C]||"default",children:C.toUpperCase()})},{title:"Progress",key:"progress",width:200,render:(C,O)=>{const K=O.total_ips>0?Math.round(O.scanned_ips/O.total_ips*100):0;return e.jsxs(N,{direction:"vertical",size:0,style:{width:"100%"},children:[e.jsx(ns,{percent:K,size:"small",status:O.status==="running"?"active":void 0}),e.jsxs(Q,{type:"secondary",style:{fontSize:12},children:[O.scanned_ips,"/",O.total_ips," IPs • ",O.found_nodes," found"]})]})}},{title:"Created",dataIndex:"created_at",key:"created_at",width:160,render:C=>new Date(C).toLocaleString()},{title:"Actions",key:"actions",width:150,render:(C,O)=>e.jsxs(N,{children:[e.jsx(ve,{title:"View Details",children:e.jsx(A,{type:"text",icon:e.jsx(mt,{}),onClick:()=>Y(O)})}),O.status==="running"&&e.jsx(ve,{title:"Cancel",children:e.jsx(A,{type:"text",danger:!0,icon:e.jsx(Te,{}),onClick:()=>H(O.id)})}),["completed","cancelled","failed"].includes(O.status)&&e.jsx(De,{title:"Delete this task?",onConfirm:()=>q(O.id),children:e.jsx(ve,{title:"Delete",children:e.jsx(A,{type:"text",danger:!0,icon:e.jsx(Je,{})})})})]})}],j=[{title:"IP",dataIndex:"ip",key:"ip",render:C=>e.jsx(Q,{code:!0,children:C})},{title:"Port",dataIndex:"port",key:"port",width:80},{title:"Status",dataIndex:"status",key:"status",width:160,render:(C,O)=>{const K=e.jsxs(M,{color:li[C]||"default",children:[C==="success"&&e.jsx(ie,{}),C==="timeout"&&e.jsx(Hn,{}),C==="connection_refused"&&e.jsx(ue,{}),C==="auth_failed"&&e.jsx(rs,{}),C==="error"&&e.jsx(rs,{})," ",C.replace("_"," ").toUpperCase()]});return O.error_msg&&C!=="success"?e.jsx(ve,{title:O.error_msg,children:K}):K}},{title:"Node Name",dataIndex:"node_name",key:"node_name",render:C=>C||"-"},{title:"Version",dataIndex:"version",key:"version",render:C=>C||"-"},{title:"Duration",dataIndex:"duration_ms",key:"duration_ms",width:100,render:C=>`${C}ms`}],R=e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Start Network Discovery",style:{marginBottom:24},children:e.jsxs(L,{form:t,layout:"vertical",onFinish:X,initialValues:{port:9001,timeout_seconds:3,max_workers:50},children:[e.jsx(L.Item,{name:"cidr",label:"CIDR Range",rules:[{required:!0,message:"Please enter a CIDR range"}],help:h?h.valid?e.jsxs(Q,{type:"success",children:["Valid CIDR: ",h.count," IP addresses"]}):e.jsx(Q,{type:"danger",children:h.error||"Invalid CIDR"}):void 0,validateStatus:h?h.valid?"success":"error":void 0,children:e.jsx(G,{placeholder:"e.g., 192.168.1.0/24",onChange:C=>J(C.target.value),suffix:_?e.jsx(Ce,{size:"small"}):e.jsx("span",{})})}),e.jsxs(N,{size:"large",style:{width:"100%"},children:[e.jsx(L.Item,{name:"port",label:"Supervisor Port",rules:[{required:!0,message:"Please enter port"}],style:{width:150},children:e.jsx(me,{min:1,max:65535,style:{width:"100%"}})}),e.jsx(L.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please enter username"}],style:{width:200},children:e.jsx(G,{placeholder:"admin"})}),e.jsx(L.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter password"}],style:{width:200},children:e.jsx(G.Password,{placeholder:"Password"})})]}),e.jsxs(N,{size:"large",children:[e.jsx(L.Item,{name:"timeout_seconds",label:"Timeout (seconds)",style:{width:150},children:e.jsx(me,{min:1,max:30,style:{width:"100%"}})}),e.jsx(L.Item,{name:"max_workers",label:"Max Workers",style:{width:150},children:e.jsx(me,{min:1,max:200,style:{width:"100%"}})})]}),e.jsx(L.Item,{children:e.jsx(A,{type:"primary",htmlType:"submit",loading:s,icon:e.jsx(Ae,{}),disabled:!(h!=null&&h.valid),children:"Start Discovery"})})]})}),T.length>0&&e.jsx(V,{title:"Recently Discovered Nodes",size:"small",children:e.jsx(N,{direction:"vertical",style:{width:"100%"},children:T.map((C,O)=>e.jsx(Pe,{type:"success",message:e.jsxs(N,{children:[e.jsx(ie,{}),e.jsx(Q,{strong:!0,children:C.node_name}),e.jsxs(Q,{type:"secondary",children:["(",C.ip,":",C.port,")"]}),e.jsxs(M,{color:"blue",children:["v",C.version]})]}),showIcon:!1},`${C.ip}-${O}`))})})]}),$=e.jsx(V,{title:"Discovery Tasks",extra:e.jsx(A,{icon:e.jsx(ee,{}),onClick:z,loading:i,children:"Refresh"}),children:e.jsx(pe,{columns:F,dataSource:r,rowKey:"id",loading:i,pagination:{current:l.page,pageSize:l.limit,total:l.total,showSizeChanger:!0,showTotal:C=>`Total ${C} tasks`,onChange:(C,O)=>d({page:C,limit:O,total:l.total})},locale:{emptyText:e.jsx($e,{description:"No discovery tasks yet"})}})}),W=[{key:"new",label:"New Discovery",children:R},{key:"history",label:e.jsx(Ds,{count:r.filter(C=>C.status==="running").length,offset:[10,0],children:"Discovery History"}),children:$}];return e.jsxs("div",{children:[e.jsxs(ai,{level:4,style:{marginBottom:24},children:[e.jsx(Os,{})," Node Discovery"]}),e.jsx(Wt,{activeKey:w,onChange:I,items:W}),e.jsx(Ne,{title:`Discovery Task #${f==null?void 0:f.id}`,open:b,onCancel:()=>c(!1),footer:null,width:900,children:p?e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx(Ce,{size:"large"})}):f?e.jsxs("div",{children:[e.jsx(V,{size:"small",style:{marginBottom:16},children:e.jsxs(N,{size:"large",wrap:!0,children:[e.jsxs("div",{children:[e.jsx(Q,{type:"secondary",children:"CIDR:"})," ",e.jsx(Q,{code:!0,children:f.cidr})]}),e.jsxs("div",{children:[e.jsx(Q,{type:"secondary",children:"Port:"})," ",e.jsx(Q,{children:f.port})]}),e.jsxs("div",{children:[e.jsx(Q,{type:"secondary",children:"Status:"})," ",e.jsx(M,{color:As[f.status],children:f.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(Q,{type:"secondary",children:"Created by:"})," ",e.jsx(Q,{children:f.created_by})]})]})}),e.jsxs(V,{size:"small",style:{marginBottom:16},children:[e.jsx(ns,{percent:f.total_ips>0?Math.round(f.scanned_ips/f.total_ips*100):0,status:f.status==="running"?"active":void 0}),e.jsxs(N,{size:"large",style:{marginTop:8},children:[e.jsxs(Q,{children:[e.jsx(Q,{type:"secondary",children:"Scanned:"})," ",f.scanned_ips,"/",f.total_ips]}),e.jsxs(Q,{type:"success",children:[e.jsx(ie,{})," Found: ",f.found_nodes]}),e.jsxs(Q,{type:"danger",children:[e.jsx(ue,{})," Failed: ",f.failed_ips]})]})]}),e.jsx(pe,{columns:j,dataSource:g,rowKey:"id",size:"small",pagination:{pageSize:10},locale:{emptyText:e.jsx($e,{description:"No results yet"})}})]}):null})]})}function di({children:t}){const{isAuthenticated:s}=fe();return s?e.jsx(e.Fragment,{children:t}):e.jsx(ot,{to:"/login",replace:!0})}function ui(){const{isAuthenticated:t,setUser:s,logout:n,setWebsocketEnabled:r}=fe();m.useEffect(()=>{const i=()=>{n()};return window.addEventListener("auth:logout",i),()=>window.removeEventListener("auth:logout",i)},[n]),m.useEffect(()=>{t&&(async()=>{try{const d=((await Vt.getSystemSettings()).settings||{}).enable_websocket!=="false";r(d)}catch(a){console.error("Failed to load system settings:",a)}})()},[t,r]),m.useEffect(()=>{const i=localStorage.getItem("token"),a=localStorage.getItem("user");i&&a?o():(i||a)&&n()},[]);const o=async()=>{var i;try{const a=await yn.getCurrentUser();a.status==="success"&&((i=a.data)!=null&&i.user)?s(a.data.user):n()}catch(a){console.error("Failed to load user info:",a),n()}};return e.jsxs(Yn,{children:[e.jsx(te,{path:"/login",element:e.jsx(ua,{})}),e.jsxs(te,{path:"/",element:e.jsx(di,{children:e.jsx(da,{})}),children:[e.jsx(te,{index:!0,element:e.jsx(ot,{to:"/dashboard",replace:!0})}),e.jsx(te,{path:"dashboard",element:e.jsx(fa,{})}),e.jsx(te,{path:"nodes",element:e.jsx(Va,{})}),e.jsx(te,{path:"nodes/:nodeName",element:e.jsx(Ha,{})}),e.jsx(te,{path:"processes",element:e.jsx(Ka,{})}),e.jsx(te,{path:"environments",element:e.jsx(Ya,{})}),e.jsx(te,{path:"environments/:environmentName",element:e.jsx(Ga,{})}),e.jsx(te,{path:"users",element:e.jsx(Xa,{})}),e.jsx(te,{path:"alerts",element:e.jsx(Qa,{})}),e.jsx(te,{path:"alerts/rules",element:e.jsx(ei,{})}),e.jsx(te,{path:"logs",element:e.jsx(ri,{})}),e.jsx(te,{path:"discovery",element:e.jsx(ci,{})}),e.jsx(te,{path:"settings",element:e.jsx(oi,{})})]}),e.jsx(te,{path:"*",element:t?e.jsx(ot,{to:"/dashboard",replace:!0}):e.jsx(ot,{to:"/login",replace:!0})})]})}Nt.createRoot(document.getElementById("root")).render(e.jsx(Kt.StrictMode,{children:e.jsx(Gn,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(qn,{locale:fr,children:e.jsx(ui,{})})})}));
